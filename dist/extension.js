/*! For license information please see extension.js.LICENSE.txt */
(()=>{var e={2743:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugSession=t.ErrorDestination=t.MemoryEvent=t.InvalidatedEvent=t.ProgressEndEvent=t.ProgressUpdateEvent=t.ProgressStartEvent=t.CapabilitiesEvent=t.LoadedSourceEvent=t.ModuleEvent=t.BreakpointEvent=t.ThreadEvent=t.OutputEvent=t.ExitedEvent=t.TerminatedEvent=t.InitializedEvent=t.ContinuedEvent=t.StoppedEvent=t.CompletionItem=t.Module=t.Breakpoint=t.Variable=t.Thread=t.StackFrame=t.Scope=t.Source=void 0;const i=n(5538),r=n(3586),o=n(5359),s=n(7016);t.Source=class{constructor(e,t,n=0,i,r){this.name=e,this.path=t,this.sourceReference=n,i&&(this.origin=i),r&&(this.adapterData=r)}},t.Scope=class{constructor(e,t,n=!1){this.name=e,this.variablesReference=t,this.expensive=n}},t.StackFrame=class{constructor(e,t,n,i=0,r=0){this.id=e,this.source=n,this.line=i,this.column=r,this.name=t}},t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}},t.Variable=class{constructor(e,t,n=0,i,r){this.name=e,this.value=t,this.variablesReference=n,"number"==typeof r&&(this.namedVariables=r),"number"==typeof i&&(this.indexedVariables=i)}},t.Breakpoint=class{constructor(e,t,n,i){this.verified=e;const r=this;"number"==typeof t&&(r.line=t),"number"==typeof n&&(r.column=n),i&&(r.source=i)}setId(e){this.id=e}},t.Module=class{constructor(e,t){this.id=e,this.name=t}},t.CompletionItem=class{constructor(e,t,n=0){this.label=e,this.start=t,this.length=n}};class a extends r.Event{constructor(e,t,n){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof n&&(this.body.text=n)}}t.StoppedEvent=a;class c extends r.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}}t.ContinuedEvent=c;class u extends r.Event{constructor(){super("initialized")}}t.InitializedEvent=u;class p extends r.Event{constructor(e){super("terminated"),("boolean"==typeof e||e)&&(this.body={restart:e})}}t.TerminatedEvent=p;class l extends r.Event{constructor(e){super("exited"),this.body={exitCode:e}}}t.ExitedEvent=l;class h extends r.Event{constructor(e,t="console",n){super("output"),this.body={category:t,output:e},void 0!==n&&(this.body.data=n)}}t.OutputEvent=h;class d extends r.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}}t.ThreadEvent=d;class f extends r.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}}t.BreakpointEvent=f;class m extends r.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}}t.ModuleEvent=m;class g extends r.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}}t.LoadedSourceEvent=g;class b extends r.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}}t.CapabilitiesEvent=b;class v extends r.Event{constructor(e,t,n){super("progressStart"),this.body={progressId:e,title:t},"string"==typeof n&&(this.body.message=n)}}t.ProgressStartEvent=v;class y extends r.Event{constructor(e,t){super("progressUpdate"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}t.ProgressUpdateEvent=y;class E extends r.Event{constructor(e,t){super("progressEnd"),this.body={progressId:e},"string"==typeof t&&(this.body.message=t)}}t.ProgressEndEvent=E;class T extends r.Event{constructor(e,t,n){super("invalidated"),this.body={},e&&(this.body.areas=e),t&&(this.body.threadId=t),n&&(this.body.stackFrameId=n)}}t.InvalidatedEvent=T;class R extends r.Event{constructor(e,t,n){super("memory"),this.body={memoryReference:e,offset:t,count:n}}}var _;t.MemoryEvent=R,function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(_=t.ErrorDestination||(t.ErrorDestination={}));class x extends i.ProtocolServer{constructor(e,t){super();const n="boolean"==typeof e&&e;this._debuggerLinesStartAt1=n,this._debuggerColumnsStartAt1=n,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",(()=>{this.shutdown()})),this.on("error",(e=>{this.shutdown()}))}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){(0,o.runDebugAdapter)(e)}shutdown(){this._isServer||this._isRunningInline()||setTimeout((()=>{process.exit(0)}),100)}sendErrorResponse(e,t,n,i,r=_.User){let o;"number"==typeof t?(o={id:t,format:n},i&&(o.variables=i),r&_.User&&(o.showUser=!0),r&_.Telemetry&&(o.sendTelemetry=!0)):o=t,e.success=!1,e.message=x.formatPII(o.format,!0,o.variables),e.body||(e.body={}),e.body.error=o,this.sendResponse(e)}runInTerminalRequest(e,t,n){this.sendRequest("runInTerminal",e,t,n)}dispatchRequest(e){const t=new r.Response(e);try{if("initialize"===e.command){var n=e.arguments;if("boolean"==typeof n.linesStartAt1&&(this._clientLinesStartAt1=n.linesStartAt1),"boolean"==typeof n.columnsStartAt1&&(this._clientColumnsStartAt1=n.columnsStartAt1),"path"!==n.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,_.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,n)}}else"launch"===e.command?this.launchRequest(t,e.arguments,e):"attach"===e.command?this.attachRequest(t,e.arguments,e):"disconnect"===e.command?this.disconnectRequest(t,e.arguments,e):"terminate"===e.command?this.terminateRequest(t,e.arguments,e):"restart"===e.command?this.restartRequest(t,e.arguments,e):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments,e):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments,e):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments,e):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments,e):"continue"===e.command?this.continueRequest(t,e.arguments,e):"next"===e.command?this.nextRequest(t,e.arguments,e):"stepIn"===e.command?this.stepInRequest(t,e.arguments,e):"stepOut"===e.command?this.stepOutRequest(t,e.arguments,e):"stepBack"===e.command?this.stepBackRequest(t,e.arguments,e):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments,e):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments,e):"goto"===e.command?this.gotoRequest(t,e.arguments,e):"pause"===e.command?this.pauseRequest(t,e.arguments,e):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments,e):"scopes"===e.command?this.scopesRequest(t,e.arguments,e):"variables"===e.command?this.variablesRequest(t,e.arguments,e):"setVariable"===e.command?this.setVariableRequest(t,e.arguments,e):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments,e):"source"===e.command?this.sourceRequest(t,e.arguments,e):"threads"===e.command?this.threadsRequest(t,e):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments,e):"evaluate"===e.command?this.evaluateRequest(t,e.arguments,e):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments,e):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments,e):"completions"===e.command?this.completionsRequest(t,e.arguments,e):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments,e):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments,e):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments,e):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments,e):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments,e):"writeMemory"===e.command?this.writeMemoryRequest(t,e.arguments,e):"disassemble"===e.command?this.disassembleRequest(t,e.arguments,e):"cancel"===e.command?this.cancelRequest(t,e.arguments,e):"breakpointLocations"===e.command?this.breakpointLocationsRequest(t,e.arguments,e):"setInstructionBreakpoints"===e.command?this.setInstructionBreakpointsRequest(t,e.arguments,e):this.customRequest(e.command,t,e.arguments,e)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},_.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,e.body.supportsCancelRequest=!1,e.body.supportsBreakpointLocationsRequest=!1,e.body.supportsClipboardContext=!1,e.body.supportsSteppingGranularity=!1,e.body.supportsInstructionBreakpoints=!1,e.body.supportsExceptionFilterOptions=!1,this.sendResponse(e)}disconnectRequest(e,t,n){this.sendResponse(e),this.shutdown()}launchRequest(e,t,n){this.sendResponse(e)}attachRequest(e,t,n){this.sendResponse(e)}terminateRequest(e,t,n){this.sendResponse(e)}restartRequest(e,t,n){this.sendResponse(e)}setBreakPointsRequest(e,t,n){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t,n){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t,n){this.sendResponse(e)}configurationDoneRequest(e,t,n){this.sendResponse(e)}continueRequest(e,t,n){this.sendResponse(e)}nextRequest(e,t,n){this.sendResponse(e)}stepInRequest(e,t,n){this.sendResponse(e)}stepOutRequest(e,t,n){this.sendResponse(e)}stepBackRequest(e,t,n){this.sendResponse(e)}reverseContinueRequest(e,t,n){this.sendResponse(e)}restartFrameRequest(e,t,n){this.sendResponse(e)}gotoRequest(e,t,n){this.sendResponse(e)}pauseRequest(e,t,n){this.sendResponse(e)}sourceRequest(e,t,n){this.sendResponse(e)}threadsRequest(e,t){this.sendResponse(e)}terminateThreadsRequest(e,t,n){this.sendResponse(e)}stackTraceRequest(e,t,n){this.sendResponse(e)}scopesRequest(e,t,n){this.sendResponse(e)}variablesRequest(e,t,n){this.sendResponse(e)}setVariableRequest(e,t,n){this.sendResponse(e)}setExpressionRequest(e,t,n){this.sendResponse(e)}evaluateRequest(e,t,n){this.sendResponse(e)}stepInTargetsRequest(e,t,n){this.sendResponse(e)}gotoTargetsRequest(e,t,n){this.sendResponse(e)}completionsRequest(e,t,n){this.sendResponse(e)}exceptionInfoRequest(e,t,n){this.sendResponse(e)}loadedSourcesRequest(e,t,n){this.sendResponse(e)}dataBreakpointInfoRequest(e,t,n){this.sendResponse(e)}setDataBreakpointsRequest(e,t,n){this.sendResponse(e)}readMemoryRequest(e,t,n){this.sendResponse(e)}writeMemoryRequest(e,t,n){this.sendResponse(e)}disassembleRequest(e,t,n){this.sendResponse(e)}cancelRequest(e,t,n){this.sendResponse(e)}breakpointLocationsRequest(e,t,n){this.sendResponse(e)}setInstructionBreakpointsRequest(e,t,n){this.sendResponse(e)}customRequest(e,t,n,i){this.sendErrorResponse(t,1014,"unrecognized request",null,_.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?x.uri2path(e):x.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?x.uri2path(e):x.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new s.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new s.URL(e),n=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(n)&&(n=n[1].toLowerCase()+n.substr(2)),n=n.replace(/\//g,"\\")),n}static formatPII(e,t,n){return e.replace(x._formatPIIRegexp,(function(e,i){return t&&i.length>0&&"_"!==i[0]?e:n[i]&&n.hasOwnProperty(i)?n[i]:e}))}}t.DebugSession=x,x._formatPIIRegexp=/{([^}]+)}/g},2715:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Handles=void 0,t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},8711:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalLogger=void 0;const i=n(9896),r=n(6928),o=n(8194);function s(){let e=new Date;return a(2,String(e.getUTCHours()))+":"+a(2,String(e.getUTCMinutes()))+":"+a(2,String(e.getUTCSeconds()))+"."+a(3,String(e.getUTCMilliseconds()))+" UTC"}function a(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.InternalLogger=class{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=o.LogLevel.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}async setup(e){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(r.isAbsolute(e.logFilePath)){const t=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,o.LogLevel.Error);try{await i.promises.mkdir(r.dirname(e.logFilePath),{recursive:!0}),this.log("Verbose logs are written to:\n",o.LogLevel.Warn),this.log(e.logFilePath+"\n",o.LogLevel.Warn),this._logFileStream=i.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",(e=>{t(e)}))}catch(e){t(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,o.LogLevel.Error)}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}-`+e.getUTCDate()+", "+s();this.log(t+"\n",o.LogLevel.Verbose,!1)}setupShutdownListeners(){process.on("beforeExit",this.beforeExitCallback),process.on("SIGTERM",this.disposeCallback),process.on("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise((e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()}))}log(e,t,n=!0){if(this._minLogLevel!==o.LogLevel.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const n=t===o.LogLevel.Error?console.error:t===o.LogLevel.Warn?console.warn:null;n&&n((0,o.trimLastNewline)(e))}t===o.LogLevel.Error&&(e=`[${o.LogLevel[t]}] ${e}`),this._prependTimestamp&&n&&(e="["+s()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const n=new o.LogOutputEvent(e,t);this._logCallback(n)}}}},8194:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trimLastNewline=t.LogOutputEvent=t.logger=t.Logger=t.LogLevel=void 0;const i=n(8711),r=n(2743);var o;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(o=t.LogLevel||(t.LogLevel={}));class s{constructor(){this._pendingLogQ=[]}log(e,t=o.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,o.Verbose)}warn(e){this.log(e,o.Warn)}error(e){this.log(e,o.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=o.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,n=!0){const i="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:i,prependTimestamp:n};this._currentLogger.setup(t).then((()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach((e=>this._write(e.msg,e.level)))}}))}}init(e,t,n){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new i.InternalLogger(e,n),this._logFilePathFromInit=t}}t.Logger=s,t.logger=new s;class a extends r.OutputEvent{constructor(e,t){super(e,t===o.Error?"stderr":t===o.Warn?"console":"stdout")}}t.LogOutputEvent=a,t.trimLastNewline=function(e){return e.replace(/(\n|\r\n)$/,"")}},7308:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingDebugSession=void 0;const i=n(8194),r=i.logger,o=n(2743);class s extends o.DebugSession{constructor(e,t,n){super(t,n),this.obsolete_logFilePath=e,this.on("error",(e=>{r.error(e.body)}))}start(e,t){super.start(e,t),r.init((e=>this.sendEvent(e)),this.obsolete_logFilePath,this._isServer)}sendEvent(e){if(!(e instanceof i.LogOutputEvent)){let t=e;e instanceof o.OutputEvent&&e.body&&e.body.data&&e.body.data.doNotLogOutput&&(delete e.body.data.doNotLogOutput,t={...e},t.body={...e.body,output:"<output not logged>"}),r.verbose(`To client: ${JSON.stringify(t)}`)}super.sendEvent(e)}sendRequest(e,t,n,i){r.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${n}`),super.sendRequest(e,t,n,i)}sendResponse(e){r.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){r.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}t.LoggingDebugSession=s},8675:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Handles=t.Response=t.Event=t.ErrorDestination=t.CompletionItem=t.Module=t.Source=t.Breakpoint=t.Variable=t.Scope=t.StackFrame=t.Thread=t.MemoryEvent=t.InvalidatedEvent=t.ProgressEndEvent=t.ProgressUpdateEvent=t.ProgressStartEvent=t.CapabilitiesEvent=t.LoadedSourceEvent=t.ModuleEvent=t.BreakpointEvent=t.ThreadEvent=t.OutputEvent=t.ContinuedEvent=t.StoppedEvent=t.ExitedEvent=t.TerminatedEvent=t.InitializedEvent=t.logger=t.Logger=t.LoggingDebugSession=t.DebugSession=void 0;const i=n(2743);Object.defineProperty(t,"DebugSession",{enumerable:!0,get:function(){return i.DebugSession}}),Object.defineProperty(t,"InitializedEvent",{enumerable:!0,get:function(){return i.InitializedEvent}}),Object.defineProperty(t,"TerminatedEvent",{enumerable:!0,get:function(){return i.TerminatedEvent}}),Object.defineProperty(t,"ExitedEvent",{enumerable:!0,get:function(){return i.ExitedEvent}}),Object.defineProperty(t,"StoppedEvent",{enumerable:!0,get:function(){return i.StoppedEvent}}),Object.defineProperty(t,"ContinuedEvent",{enumerable:!0,get:function(){return i.ContinuedEvent}}),Object.defineProperty(t,"OutputEvent",{enumerable:!0,get:function(){return i.OutputEvent}}),Object.defineProperty(t,"ThreadEvent",{enumerable:!0,get:function(){return i.ThreadEvent}}),Object.defineProperty(t,"BreakpointEvent",{enumerable:!0,get:function(){return i.BreakpointEvent}}),Object.defineProperty(t,"ModuleEvent",{enumerable:!0,get:function(){return i.ModuleEvent}}),Object.defineProperty(t,"LoadedSourceEvent",{enumerable:!0,get:function(){return i.LoadedSourceEvent}}),Object.defineProperty(t,"CapabilitiesEvent",{enumerable:!0,get:function(){return i.CapabilitiesEvent}}),Object.defineProperty(t,"ProgressStartEvent",{enumerable:!0,get:function(){return i.ProgressStartEvent}}),Object.defineProperty(t,"ProgressUpdateEvent",{enumerable:!0,get:function(){return i.ProgressUpdateEvent}}),Object.defineProperty(t,"ProgressEndEvent",{enumerable:!0,get:function(){return i.ProgressEndEvent}}),Object.defineProperty(t,"InvalidatedEvent",{enumerable:!0,get:function(){return i.InvalidatedEvent}}),Object.defineProperty(t,"MemoryEvent",{enumerable:!0,get:function(){return i.MemoryEvent}}),Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return i.Thread}}),Object.defineProperty(t,"StackFrame",{enumerable:!0,get:function(){return i.StackFrame}}),Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(t,"Variable",{enumerable:!0,get:function(){return i.Variable}}),Object.defineProperty(t,"Breakpoint",{enumerable:!0,get:function(){return i.Breakpoint}}),Object.defineProperty(t,"Source",{enumerable:!0,get:function(){return i.Source}}),Object.defineProperty(t,"Module",{enumerable:!0,get:function(){return i.Module}}),Object.defineProperty(t,"CompletionItem",{enumerable:!0,get:function(){return i.CompletionItem}}),Object.defineProperty(t,"ErrorDestination",{enumerable:!0,get:function(){return i.ErrorDestination}});const r=n(7308);Object.defineProperty(t,"LoggingDebugSession",{enumerable:!0,get:function(){return r.LoggingDebugSession}});const o=n(8194);t.Logger=o;const s=n(3586);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Response",{enumerable:!0,get:function(){return s.Response}});const a=n(2715);Object.defineProperty(t,"Handles",{enumerable:!0,get:function(){return a.Handles}});const c=o.logger;t.logger=c},3586:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=t.Response=t.Message=void 0;class n{constructor(e){this.seq=0,this.type=e}}t.Message=n,t.Response=class extends n{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}},t.Event=class extends n{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},5538:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolServer=void 0;const i=n(4434),r=n(3586);class o{get event(){return this._event||(this._event=(e,t)=>{let n;return this._listener=e,this._this=t,n={dispose:()=>{this._listener=void 0,this._this=void 0}},n}),this._event}fire(e){if(this._listener)try{this._listener.call(this._this,e)}catch(e){}}hasListener(){return!!this._listener}dispose(){this._listener=void 0,this._this=void 0}}class s extends i.EventEmitter{constructor(){super(),this._sendMessage=new o,this._pendingRequests=new Map,this.onDidSendMessage=this._sendMessage.event}dispose(){}handleMessage(e){if("request"===e.type)this.dispatchRequest(e);else if("response"===e.type){const t=e,n=this._pendingRequests.get(t.request_seq);n&&(this._pendingRequests.delete(t.request_seq),n(t))}}_isRunningInline(){return this._sendMessage&&this._sendMessage.hasListener()}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=Buffer.alloc(0),e.on("data",(e=>this._handleData(e))),e.on("close",(()=>{this._emitEvent(new r.Event("close"))})),e.on("error",(e=>{this._emitEvent(new r.Event("error","inStream error: "+(e&&e.message)))})),t.on("error",(e=>{this._emitEvent(new r.Event("error","outStream error: "+(e&&e.message)))})),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,n,i){const o={command:e};if(t&&Object.keys(t).length>0&&(o.arguments=t),this._send("request",o),i){this._pendingRequests.set(o.seq,i);const e=setTimeout((()=>{clearTimeout(e);const t=this._pendingRequests.get(o.seq);t&&(this._pendingRequests.delete(o.seq),t(new r.Response(o,"timeout")))}),n)}}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}this._sendMessage.fire(t)}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);this.handleMessage(t)}catch(e){this._emitEvent(new r.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(s.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const n=t[e].split(/: +/);"Content-Length"==n[0]&&(this._contentLength=+n[1])}this._rawData=this._rawData.slice(e+s.TWO_CRLF.length);continue}}break}}}t.ProtocolServer=s,s.TWO_CRLF="\r\n\r\n"},5359:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runDebugAdapter=void 0;const i=n(9278);t.runDebugAdapter=function(e){let t=0;if(process.argv.slice(2).forEach((function(e,n,i){const r=/^--server=(\d{4,5})$/.exec(e);r&&(t=parseInt(r[1],10))})),t>0)console.error(`waiting for debug protocol on port ${t}`),i.createServer((t=>{console.error(">> accepted connection from client"),t.on("end",(()=>{console.error(">> client connection closed\n")}));const n=new e(!1,!0);n.setRunAsServer(!0),n.start(t,t)})).listen(t);else{const t=new e(!1);process.on("SIGTERM",(()=>{t.shutdown()})),t.start(process.stdin,process.stdout)}}},7500:function(e,t,n){var i;e=n.nmd(e),i=function(t){"use strict";function n(e,t){t|=0;for(var n=Math.max(e.length-t,0),i=Array(n),r=0;r<n;r++)i[r]=e[t+r];return i}var i=function(e){var t=n(arguments,1);return function(){var i=n(arguments);return e.apply(null,t.concat(i))}},r=function(e){return function(){var t=n(arguments),i=t.pop();e.call(this,t,i)}};function o(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var s="function"==typeof setImmediate&&setImmediate,a="object"==typeof process&&"function"==typeof process.nextTick;function c(e){setTimeout(e,0)}function u(e){return function(t){var i=n(arguments,1);e((function(){t.apply(null,i)}))}}var p=u(s?setImmediate:a?process.nextTick:c);function l(e){return r((function(t,n){var i;try{i=e.apply(this,t)}catch(e){return n(e)}o(i)&&"function"==typeof i.then?i.then((function(e){h(n,null,e)}),(function(e){h(n,e.message?e:new Error(e))})):n(null,i)}))}function h(e,t,n){try{e(t,n)}catch(e){p(d,e)}}function d(e){throw e}var f="function"==typeof Symbol;function m(e){return f&&"AsyncFunction"===e[Symbol.toStringTag]}function g(e){return m(e)?l(e):e}function b(e){return function(t){var i=n(arguments,1),o=r((function(n,i){var r=this;return e(t,(function(e,t){g(e).apply(r,n.concat(t))}),i)}));return i.length?o.apply(this,i):o}}var v="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,E=v||y||Function("return this")(),T=E.Symbol,R=Object.prototype,_=R.hasOwnProperty,x=R.toString,S=T?T.toStringTag:void 0,A=Object.prototype.toString,w="[object Null]",k="[object Undefined]",C=T?T.toStringTag:void 0;function I(e){return null==e?void 0===e?k:w:C&&C in Object(e)?function(e){var t=_.call(e,S),n=e[S];try{e[S]=void 0;var i=!0}catch(e){}var r=x.call(e);return i&&(t?e[S]=n:delete e[S]),r}(e):function(e){return A.call(e)}(e)}var L="[object AsyncFunction]",O="[object Function]",Z="[object GeneratorFunction]",P="[object Proxy]",N=9007199254740991;function D(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=N}function F(e){return null!=e&&D(e.length)&&!function(e){if(!o(e))return!1;var t=I(e);return t==O||t==Z||t==L||t==P}(e)}var M={};function B(){}function U(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var $="function"==typeof Symbol&&Symbol.iterator,V=function(e){return $&&e[$]&&e[$]()};function j(e){return null!=e&&"object"==typeof e}function q(e){return j(e)&&"[object Arguments]"==I(e)}var H=Object.prototype,G=H.hasOwnProperty,W=H.propertyIsEnumerable,K=q(function(){return arguments}())?q:function(e){return j(e)&&G.call(e,"callee")&&!W.call(e,"callee")},z=Array.isArray,Y="object"==typeof t&&t&&!t.nodeType&&t,Q=Y&&e&&!e.nodeType&&e,J=Q&&Q.exports===Y?E.Buffer:void 0,X=(J?J.isBuffer:void 0)||function(){return!1},ee=9007199254740991,te=/^(?:0|[1-9]\d*)$/;function ne(e,t){var n=typeof e;return!!(t=null==t?ee:t)&&("number"==n||"symbol"!=n&&te.test(e))&&e>-1&&e%1==0&&e<t}var ie={};ie["[object Float32Array]"]=ie["[object Float64Array]"]=ie["[object Int8Array]"]=ie["[object Int16Array]"]=ie["[object Int32Array]"]=ie["[object Uint8Array]"]=ie["[object Uint8ClampedArray]"]=ie["[object Uint16Array]"]=ie["[object Uint32Array]"]=!0,ie["[object Arguments]"]=ie["[object Array]"]=ie["[object ArrayBuffer]"]=ie["[object Boolean]"]=ie["[object DataView]"]=ie["[object Date]"]=ie["[object Error]"]=ie["[object Function]"]=ie["[object Map]"]=ie["[object Number]"]=ie["[object Object]"]=ie["[object RegExp]"]=ie["[object Set]"]=ie["[object String]"]=ie["[object WeakMap]"]=!1;var re,oe="object"==typeof t&&t&&!t.nodeType&&t,se=oe&&e&&!e.nodeType&&e,ae=se&&se.exports===oe&&v.process,ce=function(){try{return se&&se.require&&se.require("util").types||ae&&ae.binding&&ae.binding("util")}catch(e){}}(),ue=ce&&ce.isTypedArray,pe=ue?(re=ue,function(e){return re(e)}):function(e){return j(e)&&D(e.length)&&!!ie[I(e)]},le=Object.prototype.hasOwnProperty;var he=Object.prototype,de=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),fe=Object.prototype.hasOwnProperty;function me(e){return F(e)?function(e,t){var n=z(e),i=!n&&K(e),r=!n&&!i&&X(e),o=!n&&!i&&!r&&pe(e),s=n||i||r||o,a=s?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],c=a.length;for(var u in e)!t&&!le.call(e,u)||s&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ne(u,c))||a.push(u);return a}(e):function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||he))return de(e);var t,n,i=[];for(var r in Object(e))fe.call(e,r)&&"constructor"!=r&&i.push(r);return i}(e)}function ge(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function be(e){return function(t,n,i){if(i=U(i||B),e<=0||!t)return i(null);var r=function(e){if(F(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,n,i,r,o=V(e);return o?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(o):(n=me(t=e),i=-1,r=n.length,function e(){var o=n[++i];return"__proto__"===o?e():i<r?{value:t[o],key:o}:null})}(t),o=!1,s=0,a=!1;function c(e,t){if(s-=1,e)o=!0,i(e);else{if(t===M||o&&s<=0)return o=!0,i(null);a||u()}}function u(){for(a=!0;s<e&&!o;){var t=r();if(null===t)return o=!0,void(s<=0&&i(null));s+=1,n(t.value,t.key,ge(c))}a=!1}u()}}function ve(e,t,n,i){be(t)(e,g(n),i)}function ye(e,t){return function(n,i,r){return e(n,t,i,r)}}function Ee(e,t,n){n=U(n||B);var i=0,r=0,o=e.length;function s(e,t){e?n(e):++r!==o&&t!==M||n(null)}for(0===o&&n(null);i<o;i++)t(e[i],i,ge(s))}var Te=ye(ve,1/0),Re=function(e,t,n){(F(e)?Ee:Te)(e,g(t),n)};function _e(e){return function(t,n,i){return e(Re,t,g(n),i)}}function xe(e,t,n,i){i=i||B,t=t||[];var r=[],o=0,s=g(n);e(t,(function(e,t,n){var i=o++;s(e,(function(e,t){r[i]=t,n(e)}))}),(function(e){i(e,r)}))}var Se=_e(xe),Ae=b(Se);function we(e){return function(t,n,i,r){return e(be(n),t,g(i),r)}}var ke=we(xe),Ce=ye(ke,1),Ie=b(Ce);function Le(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}var Oe=function(e,t,n){for(var i=-1,r=Object(e),o=n(e),s=o.length;s--;){var a=o[++i];if(!1===t(r[a],a,r))break}return e};function Ze(e,t){return e&&Oe(e,t,me)}function Pe(e){return e!=e}function Ne(e,t,n){return t==t?function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):function(e,t,n,i){for(var r=e.length,o=n+-1;++o<r;)if(t(e[o],o,e))return o;return-1}(e,Pe,n)}var De=function(e,t,i){"function"==typeof t&&(i=t,t=null),i=U(i||B);var r=me(e).length;if(!r)return i(null);t||(t=r);var o={},s=0,a=!1,c=Object.create(null),u=[],p=[],l={};function h(e,t){u.push((function(){!function(e,t){if(!a){var r=ge((function(t,r){if(s--,arguments.length>2&&(r=n(arguments,1)),t){var u={};Ze(o,(function(e,t){u[t]=e})),u[e]=r,a=!0,c=Object.create(null),i(t,u)}else o[e]=r,Le(c[e]||[],(function(e){e()})),d()}));s++;var u=g(t[t.length-1]);t.length>1?u(o,r):u(r)}}(e,t)}))}function d(){if(0===u.length&&0===s)return i(null,o);for(;u.length&&s<t;)u.shift()()}function f(t){var n=[];return Ze(e,(function(e,i){z(e)&&Ne(e,t,0)>=0&&n.push(i)})),n}Ze(e,(function(t,n){if(!z(t))return h(n,[t]),void p.push(n);var i=t.slice(0,t.length-1),r=i.length;if(0===r)return h(n,t),void p.push(n);l[n]=r,Le(i,(function(o){if(!e[o])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+o+"` in "+i.join(", "));var s,a,u;a=function(){0==--r&&h(n,t)},(u=c[s=o])||(u=c[s]=[]),u.push(a)}))})),function(){for(var e=0;p.length;)e++,Le(f(p.pop()),(function(e){0==--l[e]&&p.push(e)}));if(e!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),d()};function Fe(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}var Me="[object Symbol]",Be=1/0,Ue=T?T.prototype:void 0,$e=Ue?Ue.toString:void 0;function Ve(e){if("string"==typeof e)return e;if(z(e))return Fe(e,Ve)+"";if(function(e){return"symbol"==typeof e||j(e)&&I(e)==Me}(e))return $e?$e.call(e):"";var t=e+"";return"0"==t&&1/e==-Be?"-0":t}var je=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),qe="\\ud800-\\udfff",He="["+qe+"]",Ge="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",We="\\ud83c[\\udffb-\\udfff]",Ke="[^"+qe+"]",ze="(?:\\ud83c[\\udde6-\\uddff]){2}",Ye="[\\ud800-\\udbff][\\udc00-\\udfff]",Qe="(?:"+Ge+"|"+We+")?",Je="[\\ufe0e\\ufe0f]?",Xe=Je+Qe+"(?:\\u200d(?:"+[Ke,ze,Ye].join("|")+")"+Je+Qe+")*",et="(?:"+[Ke+Ge+"?",Ge,ze,Ye,He].join("|")+")",tt=RegExp(We+"(?="+We+")|"+et+Xe,"g");function nt(e){return function(e){return je.test(e)}(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.split("")}(e)}var it=/^\s+|\s+$/g;function rt(e,t,n){var i;if((e=null==(i=e)?"":Ve(i))&&(n||void 0===t))return e.replace(it,"");if(!e||!(t=Ve(t)))return e;var r=nt(e),o=nt(t),s=function(e,t){for(var n=-1,i=e.length;++n<i&&Ne(t,e[n],0)>-1;);return n}(r,o),a=function(e,t){for(var n=e.length;n--&&Ne(t,e[n],0)>-1;);return n}(r,o)+1;return function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(r);++i<r;)o[i]=e[i+t];return o}(e,t,n)}(r,s,a).join("")}var ot=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,st=/,/,at=/(=.+)?(\s*)$/,ct=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function ut(e,t){var n={};Ze(e,(function(e,t){var i,r=m(e),o=!r&&1===e.length||r&&0===e.length;if(z(e))i=e.slice(0,-1),e=e[e.length-1],n[t]=i.concat(i.length>0?s:e);else if(o)n[t]=e;else{if(i=function(e){return(e=(e=(e=e.toString().replace(ct,"")).match(ot)[2].replace(" ",""))?e.split(st):[]).map((function(e){return rt(e.replace(at,""))}))}(e),0===e.length&&!r&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");r||i.pop(),n[t]=i.concat(s)}function s(t,n){var r=Fe(i,(function(e){return t[e]}));r.push(n),g(e).apply(null,r)}})),De(n,t)}function pt(){this.head=this.tail=null,this.length=0}function lt(e,t){e.length=1,e.head=e.tail=t}function ht(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var i=g(e),r=0,o=[],s=!1;function a(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,z(e)||(e=[e]),0===e.length&&l.idle())return p((function(){l.drain()}));for(var i=0,r=e.length;i<r;i++){var o={data:e[i],callback:n||B};t?l._tasks.unshift(o):l._tasks.push(o)}s||(s=!0,p((function(){s=!1,l.process()})))}function c(e){return function(t){r-=1;for(var n=0,i=e.length;n<i;n++){var s=e[n],a=Ne(o,s,0);0===a?o.shift():a>0&&o.splice(a,1),s.callback.apply(s,arguments),null!=t&&l.error(t,s.data)}r<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}var u=!1,l={_tasks:new pt,concurrency:t,payload:n,saturated:B,unsaturated:B,buffer:t/4,empty:B,drain:B,error:B,started:!1,paused:!1,push:function(e,t){a(e,!1,t)},kill:function(){l.drain=B,l._tasks.empty()},unshift:function(e,t){a(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&r<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var s=0;s<n;s++){var a=l._tasks.shift();e.push(a),o.push(a),t.push(a.data)}r+=1,0===l._tasks.length&&l.empty(),r===l.concurrency&&l.saturated();var p=ge(c(e));i(t,p)}u=!1}},length:function(){return l._tasks.length},running:function(){return r},workersList:function(){return o},idle:function(){return l._tasks.length+r===0},pause:function(){l.paused=!0},resume:function(){!1!==l.paused&&(l.paused=!1,p(l.process))}};return l}function dt(e,t){return ht(e,1,t)}pt.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},pt.prototype.empty=function(){for(;this.head;)this.shift();return this},pt.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},pt.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},pt.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):lt(this,e)},pt.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):lt(this,e)},pt.prototype.shift=function(){return this.head&&this.removeLink(this.head)},pt.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},pt.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},pt.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var ft=ye(ve,1);function mt(e,t,n,i){i=U(i||B);var r=g(n);ft(e,(function(e,n,i){r(t,e,(function(e,n){t=n,i(e)}))}),(function(e){i(e,t)}))}function gt(){var e=Fe(arguments,g);return function(){var t=n(arguments),i=this,r=t[t.length-1];"function"==typeof r?t.pop():r=B,mt(e,t,(function(e,t,r){t.apply(i,e.concat((function(e){var t=n(arguments,1);r(e,t)})))}),(function(e,t){r.apply(i,[e].concat(t))}))}}var bt=function(){return gt.apply(null,n(arguments).reverse())},vt=Array.prototype.concat,yt=function(e,t,i,r){r=r||B;var o=g(i);ke(e,t,(function(e,t){o(e,(function(e){return e?t(e):t(null,n(arguments,1))}))}),(function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=vt.apply(n,t[i]));return r(e,n)}))},Et=ye(yt,1/0),Tt=ye(yt,1),Rt=function(){var e=n(arguments),t=[null].concat(e);return function(){return arguments[arguments.length-1].apply(this,t)}};function _t(e){return e}function xt(e,t){return function(n,i,r,o){o=o||B;var s,a=!1;n(i,(function(n,i,o){r(n,(function(i,r){i?o(i):e(r)&&!s?(a=!0,s=t(!0,n),o(null,M)):o()}))}),(function(e){e?o(e):o(null,a?s:t(!1))}))}}function St(e,t){return t}var At=_e(xt(_t,St)),wt=we(xt(_t,St)),kt=ye(wt,1);function Ct(e){return function(t){var i=n(arguments,1);i.push((function(t){var i=n(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&Le(i,(function(t){console[e](t)})))})),g(t).apply(null,i)}}var It=Ct("dir");function Lt(e,t,i){i=ge(i||B);var r=g(e),o=g(t);function s(e){if(e)return i(e);var t=n(arguments,1);t.push(a),o.apply(this,t)}function a(e,t){return e?i(e):t?void r(s):i(null)}a(null,!0)}function Ot(e,t,i){i=ge(i||B);var r=g(e),o=function(e){if(e)return i(e);var s=n(arguments,1);if(t.apply(this,s))return r(o);i.apply(null,[null].concat(s))};r(o)}function Zt(e,t,n){Ot(e,(function(){return!t.apply(this,arguments)}),n)}function Pt(e,t,n){n=ge(n||B);var i=g(t),r=g(e);function o(e){if(e)return n(e);r(s)}function s(e,t){return e?n(e):t?void i(o):n(null)}r(s)}function Nt(e){return function(t,n,i){return e(t,i)}}function Dt(e,t,n){Re(e,Nt(g(t)),n)}function Ft(e,t,n,i){be(t)(e,Nt(g(n)),i)}var Mt=ye(Ft,1);function Bt(e){return m(e)?e:r((function(t,n){var i=!0;t.push((function(){var e=arguments;i?p((function(){n.apply(null,e)})):n.apply(null,e)})),e.apply(this,t),i=!1}))}function Ut(e){return!e}var $t=_e(xt(Ut,Ut)),Vt=we(xt(Ut,Ut)),jt=ye(Vt,1);function qt(e){return function(t){return null==t?void 0:t[e]}}function Ht(e,t,n,i){var r=new Array(t.length);e(t,(function(e,t,i){n(e,(function(e,n){r[t]=!!n,i(e)}))}),(function(e){if(e)return i(e);for(var n=[],o=0;o<t.length;o++)r[o]&&n.push(t[o]);i(null,n)}))}function Gt(e,t,n,i){var r=[];e(t,(function(e,t,i){n(e,(function(n,o){n?i(n):(o&&r.push({index:t,value:e}),i())}))}),(function(e){e?i(e):i(null,Fe(r.sort((function(e,t){return e.index-t.index})),qt("value")))}))}function Wt(e,t,n,i){(F(t)?Ht:Gt)(e,t,g(n),i||B)}var Kt=_e(Wt),zt=we(Wt),Yt=ye(zt,1);function Qt(e,t){var n=ge(t||B),i=g(Bt(e));!function e(t){if(t)return n(t);i(e)}()}var Jt=function(e,t,n,i){i=i||B;var r=g(n);ke(e,t,(function(e,t){r(e,(function(n,i){return n?t(n):t(null,{key:i,val:e})}))}),(function(e,t){for(var n={},r=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var s=t[o].key,a=t[o].val;r.call(n,s)?n[s].push(a):n[s]=[a]}return i(e,n)}))},Xt=ye(Jt,1/0),en=ye(Jt,1),tn=Ct("log");function nn(e,t,n,i){i=U(i||B);var r={},o=g(n);ve(e,t,(function(e,t,n){o(e,t,(function(e,i){if(e)return n(e);r[t]=i,n()}))}),(function(e){i(e,r)}))}var rn=ye(nn,1/0),on=ye(nn,1);function sn(e,t){return t in e}function an(e,t){var i=Object.create(null),o=Object.create(null);t=t||_t;var s=g(e),a=r((function(e,r){var a=t.apply(null,e);sn(i,a)?p((function(){r.apply(null,i[a])})):sn(o,a)?o[a].push(r):(o[a]=[r],s.apply(null,e.concat((function(){var e=n(arguments);i[a]=e;var t=o[a];delete o[a];for(var r=0,s=t.length;r<s;r++)t[r].apply(null,e)}))))}));return a.memo=i,a.unmemoized=e,a}var cn=u(a?process.nextTick:s?setImmediate:c);function un(e,t,i){i=i||B;var r=F(t)?[]:{};e(t,(function(e,t,i){g(e)((function(e,o){arguments.length>2&&(o=n(arguments,1)),r[t]=o,i(e)}))}),(function(e){i(e,r)}))}function pn(e,t){un(Re,e,t)}function ln(e,t,n){un(be(t),e,n)}var hn=function(e,t){var n=g(e);return ht((function(e,t){n(e[0],t)}),t,1)},dn=function(e,t){var n=hn(e,t);return n.push=function(e,t,i){if(null==i&&(i=B),"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,z(e)||(e=[e]),0===e.length)return p((function(){n.drain()}));t=t||0;for(var r=n._tasks.head;r&&t>=r.priority;)r=r.next;for(var o=0,s=e.length;o<s;o++){var a={data:e[o],priority:t,callback:i};r?n._tasks.insertBefore(r,a):n._tasks.push(a)}p(n.process)},delete n.unshift,n};function fn(e,t){if(t=U(t||B),!z(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,i=e.length;n<i;n++)g(e[n])(t)}function mn(e,t,i,r){mt(n(e).reverse(),t,i,r)}function gn(e){var t=g(e);return r((function(e,i){return e.push((function(e,t){var r;e?i(null,{error:e}):(r=arguments.length<=2?t:n(arguments,1),i(null,{value:r}))})),t.apply(this,e)}))}function bn(e){var t;return z(e)?t=Fe(e,gn):(t={},Ze(e,(function(e,n){t[n]=gn.call(this,e)}))),t}function vn(e,t,n,i){Wt(e,t,(function(e,t){n(e,(function(e,n){t(e,!n)}))}),i)}var yn=_e(vn),En=we(vn),Tn=ye(En,1);function Rn(e){return function(){return e}}function _n(e,t,n){var i={times:5,intervalFunc:Rn(0)};if(arguments.length<3&&"function"==typeof e?(n=t||B,t=e):(function(e,t){if("object"==typeof t)e.times=+t.times||5,e.intervalFunc="function"==typeof t.interval?t.interval:Rn(+t.interval||0),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||5}}(i,e),n=n||B),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var r=g(t),o=1;!function e(){r((function(t){t&&o++<i.times&&("function"!=typeof i.errorFilter||i.errorFilter(t))?setTimeout(e,i.intervalFunc(o)):n.apply(null,arguments)}))}()}var xn=function(e,t){t||(t=e,e=null);var n=g(t);return r((function(t,i){function r(e){n.apply(null,t.concat(e))}e?_n(e,r,i):_n(r,i)}))};function Sn(e,t){un(ft,e,t)}var An=_e(xt(Boolean,_t)),wn=we(xt(Boolean,_t)),kn=ye(wn,1);function Cn(e,t,n){var i=g(t);function r(e,t){var n=e.criteria,i=t.criteria;return n<i?-1:n>i?1:0}Se(e,(function(e,t){i(e,(function(n,i){if(n)return t(n);t(null,{value:e,criteria:i})}))}),(function(e,t){if(e)return n(e);n(null,Fe(t.sort(r),qt("value")))}))}function In(e,t,n){var i=g(e);return r((function(r,o){var s,a=!1;r.push((function(){a||(o.apply(null,arguments),clearTimeout(s))})),s=setTimeout((function(){var t=e.name||"anonymous",i=new Error('Callback function "'+t+'" timed out.');i.code="ETIMEDOUT",n&&(i.info=n),a=!0,o(i)}),t),i.apply(null,r)}))}var Ln=Math.ceil,On=Math.max;function Zn(e,t,n,i){var r=g(n);ke(function(e,t,n,i){for(var r=-1,o=On(Ln((t-e)/1),0),s=Array(o);o--;)s[++r]=e,e+=1;return s}(0,e),t,r,i)}var Pn=ye(Zn,1/0),Nn=ye(Zn,1);function Dn(e,t,n,i){arguments.length<=3&&(i=n,n=t,t=z(e)?[]:{}),i=U(i||B);var r=g(n);Re(e,(function(e,n,i){r(t,e,n,i)}),(function(e){i(e,t)}))}function Fn(e,t){var i,r=null;t=t||B,Mt(e,(function(e,t){g(e)((function(e,o){i=arguments.length>2?n(arguments,1):o,r=e,t(!e)}))}),(function(){t(r,i)}))}function Mn(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function Bn(e,t,i){i=ge(i||B);var r=g(t);if(!e())return i(null);var o=function(t){if(t)return i(t);if(e())return r(o);var s=n(arguments,1);i.apply(null,[null].concat(s))};r(o)}function Un(e,t,n){Bn((function(){return!e.apply(this,arguments)}),t,n)}var $n=function(e,t){if(t=U(t||B),!z(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var i=0;function r(t){var n=g(e[i++]);t.push(ge(o)),n.apply(null,t)}function o(o){if(o||i===e.length)return t.apply(null,arguments);r(n(arguments,1))}r([])},Vn={apply:i,applyEach:Ae,applyEachSeries:Ie,asyncify:l,auto:De,autoInject:ut,cargo:dt,compose:bt,concat:Et,concatLimit:yt,concatSeries:Tt,constant:Rt,detect:At,detectLimit:wt,detectSeries:kt,dir:It,doDuring:Lt,doUntil:Zt,doWhilst:Ot,during:Pt,each:Dt,eachLimit:Ft,eachOf:Re,eachOfLimit:ve,eachOfSeries:ft,eachSeries:Mt,ensureAsync:Bt,every:$t,everyLimit:Vt,everySeries:jt,filter:Kt,filterLimit:zt,filterSeries:Yt,forever:Qt,groupBy:Xt,groupByLimit:Jt,groupBySeries:en,log:tn,map:Se,mapLimit:ke,mapSeries:Ce,mapValues:rn,mapValuesLimit:nn,mapValuesSeries:on,memoize:an,nextTick:cn,parallel:pn,parallelLimit:ln,priorityQueue:dn,queue:hn,race:fn,reduce:mt,reduceRight:mn,reflect:gn,reflectAll:bn,reject:yn,rejectLimit:En,rejectSeries:Tn,retry:_n,retryable:xn,seq:gt,series:Sn,setImmediate:p,some:An,someLimit:wn,someSeries:kn,sortBy:Cn,timeout:In,times:Pn,timesLimit:Zn,timesSeries:Nn,transform:Dn,tryEach:Fn,unmemoize:Mn,until:Un,waterfall:$n,whilst:Bn,all:$t,allLimit:Vt,allSeries:jt,any:An,anyLimit:wn,anySeries:kn,find:At,findLimit:wt,findSeries:kt,forEach:Dt,forEachSeries:Mt,forEachLimit:Ft,forEachOf:Re,forEachOfSeries:ft,forEachOfLimit:ve,inject:mt,foldl:mt,foldr:mn,select:Kt,selectLimit:zt,selectSeries:Yt,wrapSync:l};t.default=Vn,t.apply=i,t.applyEach=Ae,t.applyEachSeries=Ie,t.asyncify=l,t.auto=De,t.autoInject=ut,t.cargo=dt,t.compose=bt,t.concat=Et,t.concatLimit=yt,t.concatSeries=Tt,t.constant=Rt,t.detect=At,t.detectLimit=wt,t.detectSeries=kt,t.dir=It,t.doDuring=Lt,t.doUntil=Zt,t.doWhilst=Ot,t.during=Pt,t.each=Dt,t.eachLimit=Ft,t.eachOf=Re,t.eachOfLimit=ve,t.eachOfSeries=ft,t.eachSeries=Mt,t.ensureAsync=Bt,t.every=$t,t.everyLimit=Vt,t.everySeries=jt,t.filter=Kt,t.filterLimit=zt,t.filterSeries=Yt,t.forever=Qt,t.groupBy=Xt,t.groupByLimit=Jt,t.groupBySeries=en,t.log=tn,t.map=Se,t.mapLimit=ke,t.mapSeries=Ce,t.mapValues=rn,t.mapValuesLimit=nn,t.mapValuesSeries=on,t.memoize=an,t.nextTick=cn,t.parallel=pn,t.parallelLimit=ln,t.priorityQueue=dn,t.queue=hn,t.race=fn,t.reduce=mt,t.reduceRight=mn,t.reflect=gn,t.reflectAll=bn,t.reject=yn,t.rejectLimit=En,t.rejectSeries=Tn,t.retry=_n,t.retryable=xn,t.seq=gt,t.series=Sn,t.setImmediate=p,t.some=An,t.someLimit=wn,t.someSeries=kn,t.sortBy=Cn,t.timeout=In,t.times=Pn,t.timesLimit=Zn,t.timesSeries=Nn,t.transform=Dn,t.tryEach=Fn,t.unmemoize=Mn,t.until=Un,t.waterfall=$n,t.whilst=Bn,t.all=$t,t.allLimit=Vt,t.allSeries=jt,t.any=An,t.anyLimit=wn,t.anySeries=kn,t.find=At,t.findLimit=wt,t.findSeries=kt,t.forEach=Dt,t.forEachSeries=Mt,t.forEachLimit=Ft,t.forEachOf=Re,t.forEachOfSeries=ft,t.forEachOfLimit=ve,t.inject=mt,t.foldl=mt,t.foldr=mn,t.select=Kt,t.selectLimit=zt,t.selectSeries=Yt,t.wrapSync=l,Object.defineProperty(t,"__esModule",{value:!0})},i(t)},1377:(e,t)=>{function n(){this.waiters=[]}n.prototype.wait=function(e){var t=this,n={};this.waiters.push(n);var i=new Promise((function(e){var i=!1;n.resolve=function(r){if(!i){if(i=!0,n.timeout&&(clearTimeout(n.timeout),n.timeout=null),!r){var o=t.waiters.indexOf(n);o>-1&&t.waiters.splice(o,1)}e()}}}));return e>0&&isFinite(e)&&(n.timeout=setTimeout((function(){n.timeout=null,n.resolve()}),e)),i},n.prototype.notify=function(){this.waiters.length>0&&this.waiters.pop().resolve(!0)},n.prototype.notifyAll=function(){for(var e=this.waiters.length-1;e>=0;e--)this.waiters[e].resolve(!0);this.waiters=[]},t.Subject=n},1696:(e,t,n)=>{"use strict";var i=n(7055),r=n(6314);function o(e){var t={};return t=i.extractLabel(e,t),t=i.extractComment(t.lineExpression,t),t=i.extractIndentation(t.lineExpression,t),delete(t=i.extractRoutines(t.lineExpression,t)).lineExpression,t}function s(e){var t="";return t=r.appendLabel(e,t),t=r.appendIndentation(e,t),t=r.appendRoutines(e,t),r.appendComment(e,t)}e.exports.parse=function(e){for(var t=(e=e.replace("\r","")).split("\n"),n=[],i=0;i<t.length;i++){var r=o(t[i]);r.lineNumber=i+1,n.push(r)}return n},e.exports.render=function(e){var t="",n=[];Array.isArray(e)?n=e:n.push(e);for(var i=0;i<n.length;i++){var r=s(n[i]);i===n.length-1?t+=r:t=t+r+"\n"}return t}},7055:e=>{"use strict";function t(e){for(var t=[],n=0,i=0;i<=e.length;i++)" "===e[i]||"\t"===e[i]?e.substring(0,i).split('"').length%2!=0&&e.substring(i).split('"').length%2!=0&&(e.substring(n,i).length>0?t.push(e.substring(n,i)):0!==e.substring(n,i).length||" "!==e.substring(n-1,n)&&"\t"!==e.substring(n-1,n)||t.push(e.substring(n,i)),n=i+1):i===e.length&&(e.substring(n,i).length>0?t.push(e.substring(n,i)):i!==n||" "!==e.substring(i-1,i)&&"/t"!==e.substring(i-1,i)||t.push(""));return t}function n(e){for(var t=e,n=0;n<t.length;n++)if(t[n].mRoutine){var i=t[n].mRoutine.indexOf(":");i>-1&&(t[n].mPostConditional=t[n].mRoutine.substring(i+1),t[n].mRoutine=t[n].mRoutine.substring(0,i))}return t}e.exports.extractLabel=function(e,t){for(var n=0;n<=e.length;n++){if(" "!==e[n]&&"\t"!==e[n]){if(0===n){t.lineLabel=e.split(/[ \t]/,1)[0];for(var i=t.lineLabel.length;i<=e.length;i++){if(" "!==e[i]&&"\t"!==e[i]){t.lineLeadSpace=e.substring(t.lineLabel.length,i),t.lineExpression=e.substring(i);break}if(i===e.length-1){t.lineLeadSpace=e.substring(t.lineLabel.length),t.lineExpression="";break}}break}t.lineLeadSpace=e.substring(0,n),t.lineExpression=e.substring(n);break}if(n===e.length-1){t.lineLeadSpace=e,t.lineExpression="";break}}return t},e.exports.extractComment=function(e,t){if(e.search(";")>=0){for(var n=0;n<e.length;n++)if(";"===e[n]){if(e.substring(0,n).split('"').length%2!=0&&e.substring(n).split('"').length%2!=0){t.lineExpression=e.substring(0,n),t.lineComment=e.substring(n).substring(1);break}if(e.substring(0,n).replace("").split('"').length%2!=0&&e.substring(n).split('"').length%2==0){t.lineExpression=e.substring(0,n),t.lineComment=e.substring(n).substring(1);break}t.lineExpression=e}return t}return t.lineExpression=e,t},e.exports.extractIndentation=function(e,t){for(var n=[],i=0,r=0,o=0,s=0;s<=e.length;s++)if("."===e[s])0!==i&&(o=s,n.push(e.substring(r,o))),r=s+1,i++;else{if("."!==e[s]&&" "!==e[s]&&"\t"!==e[s]){0!==i&&(o=s,n.push(e.substring(r,o)),t.lineExpression=e.substring(s));break}if(s===e.length-1){o=s+1,n.push(e.substring(r,o)),t.lineExpression=e.substring(s+1);break}}return n.length>0?t.lineIndentationArray=n:t.lineExpression=e,t},e.exports.splitRoutinesAndArguments=t,e.exports.extractPostConditional=n,e.exports.extractRoutines=function(e,i){for(var r={},o=[],s=t(e),a=0;a<s.length;){if(a%2==0)r.mRoutine=s[a];else{r.mArguments=s[a];for(var c=a+1;c<s.length&&""===s[c];)s.splice(c,1),r.mArguments=r.mArguments+" ";o.push(r),r={}}s.length%2!=0&&s.length>0&&a===s.length-1&&(r.mRoutine=s[a],o.push(r),r={}),a++}var u=n(o);return u.length>0&&(i.lineRoutines=u),i}},6314:e=>{"use strict";e.exports.appendLabel=function(e,t){return e.lineLabel&&(t+=e.lineLabel),e.lineLeadSpace&&(t+=e.lineLeadSpace),t},e.exports.appendIndentation=function(e,t){var n="";if(e.lineIndentationArray&&e.lineIndentationArray.length>0){for(var i in e.lineIndentationArray)n=n+"."+e.lineIndentationArray[i];t+=n}return t},e.exports.appendRoutines=function(e,t){if(e.lineRoutines)for(var n in e.lineRoutines)(e.lineRoutines[n].mRoutine||""===e.lineRoutines[n].mRoutine)&&("0"===n?t+=e.lineRoutines[n].mRoutine:t=t+" "+e.lineRoutines[n].mRoutine,e.lineRoutines[n].mPostConditional&&(t=t+":"+e.lineRoutines[n].mPostConditional),e.lineRoutines[n].hasOwnProperty("mArguments")&&(t=t+" "+e.lineRoutines[n].mArguments));return t},e.exports.appendComment=function(e,t){return e.hasOwnProperty("lineComment")&&(t=t+";"+e.lineComment),t}},5884:e=>{"use strict";e.exports=(e,t)=>{t=t||process.argv;const n=e.startsWith("-")?"":1===e.length?"-":"--",i=t.indexOf(n+e),r=t.indexOf("--");return-1!==i&&(-1===r||i<r)}},574:(e,t,n)=>{var i=n(5317),r=n(7984),o=n(3231),s=/Internet:[^]+?\n(default.*?\n)/m;e.exports.detectLocalIpV4Address=function(){return o.nfcall(i.execFile,"netstat",["-r","-n","-f","inet"]).spread((function(e,t){var n=e.match(s);if(n){var i=n[1].trim().split(/\s+/);return i[i.length-1]}throw new Error("Could not find default gateway route in routing table.")})).then(r.getIpV4AddressForInterface)}},7984:(e,t,n)=>{var i=n(857);e.exports.getIpV4AddressForInterface=function(e){return i.networkInterfaces()[e].filter((function(e){return"IPv4"===e.family}))[0].address}},9037:(e,t,n)=>{e.exports={win32:n(5600),linux:n(4323),freebsd:n(574),darwin:n(574)}},4323:(e,t,n)=>{var i=n(5317),r=n(7984),o=n(3231),s=/\n0\.0\.0\.0.*?\s*(\w+?)\n/m;e.exports.detectLocalIpV4Address=function(){return o.nfcall(i.execFile,"netstat",["-r","-n","-A","inet"]).spread((function(e,t){var n=e.match(s);if(n)return n[1];throw new Error("Could not find default gateway route in routing table.")})).then(r.getIpV4AddressForInterface)}},5600:(e,t,n)=>{var i=n(5317),r=n(3231),o=/\n(?:\s*0\.0\.0\.0\s*){2}(.*?)\r?\n=========/m;e.exports.detectLocalIpV4Address=function(){return r.nfcall(i.execFile,"route",["print","-4","0.0.0.0"]).spread((function(e,t){var n=e.match(o);if(n)return n[1].split(/\s+/)[1];throw new Error("Could not find default gateway route in routing table.")}))}},3857:(e,t,n)=>{e=n.nmd(e);var i=n(9037),r=n(857),o=n(3231),s=e.exports=function(){return o().then((function(){var e=i[r.platform()];if(e)return e.detectLocalIpV4Address();throw new Error('Sorry, your operating system "'+r.platform()+'" is not supported. You are welcome to submit a pull request if you want.')}))};n.c[n.s]===e&&s().then((function(e){console.log(e)}),(function(e){console.error(e.message),process.exit(1)}))},3480:(e,t,n)=>{var i=n(6928),r=n(9896),o=parseInt("0777",8);function s(e,t,n,a){"function"==typeof t?(n=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,u=t.fs||r;void 0===c&&(c=o),a||(a=null);var p=n||function(){};e=i.resolve(e),u.mkdir(e,c,(function(n){if(!n)return p(null,a=a||e);if("ENOENT"===n.code){if(i.dirname(e)===e)return p(n);s(i.dirname(e),t,(function(n,i){n?p(n,i):s(e,t,p,i)}))}else u.stat(e,(function(e,t){e||!t.isDirectory()?p(n,a):p(null,a)}))}))}e.exports=s.mkdirp=s.mkdirP=s,s.sync=function e(t,n,s){n&&"object"==typeof n||(n={mode:n});var a=n.mode,c=n.fs||r;void 0===a&&(a=o),s||(s=null),t=i.resolve(t);try{c.mkdirSync(t,a),s=s||t}catch(r){if("ENOENT"===r.code)s=e(i.dirname(t),n,s),e(t,n,s);else{var u;try{u=c.statSync(t)}catch(e){throw r}if(!u.isDirectory())throw r}}return s}},6585:e=>{var t=1e3,n=60*t,i=60*n,r=24*i,o=7*r;function s(e,t,n,i){var r=t>=1.5*n;return Math.round(e/n)+" "+i+(r?"s":"")}e.exports=function(e,a){a=a||{};var c,u,p=typeof e;if("string"===p&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*o;case"days":case"day":case"d":return a*r;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===p&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=r?s(c,u,r,"day"):u>=i?s(c,u,i,"hour"):u>=n?s(c,u,n,"minute"):u>=t?s(c,u,t,"second"):c+" ms"):function(e){var o=Math.abs(e);return o>=r?Math.round(e/r)+"d":o>=i?Math.round(e/i)+"h":o>=n?Math.round(e/n)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1323:(e,t,n)=>{"use strict";var i=n(9896),r=n(857),o=n(9278),s=n(6928),a=n(7500),c=n(8092),u=n(3480).mkdirp,p=c("portfinder:testPort"),l=c("portfinder:getPort"),h=c("portfinder:defaultHosts"),d={testPort:function(e,n){function i(){p("done w/ testPort(): OK",e.host,"port",e.port),e.server.removeListener("error",r),e.server.close(),n(null,e.port)}function r(r){if(p("done w/ testPort(): failed",e.host,"w/ port",e.port,"with error",r.code),e.server.removeListener("listening",i),"EADDRINUSE"!=r.code&&"EACCES"!=r.code)return n(r);var o=t.nextPort(e.port);if(o>t.highestPort)return n(new Error("No open ports available"));d.testPort({port:o,host:e.host,server:e.server},n)}n||(n=e,e={}),e.server=e.server||o.createServer((function(){})),p("entered testPort(): trying",e.host,"port",e.port),e.server.once("error",r),e.server.once("listening",i),e.host?e.server.listen(e.port,e.host):e.server.listen(e.port)}};t.basePort=8e3,t.setBasePort=function(e){t.basePort=e},t.highestPort=65535,t.setHighestPort=function(e){t.highestPort=e},t.basePath="/tmp/portfinder",t.getPort=function(e,n){if(n||(n=e,e={}),e.port=Number(e.port)||Number(t.basePort),e.host=e.host||null,e.stopPort=Number(e.stopPort)||Number(t.highestPort),!e.startPort){if(e.startPort=Number(e.port),e.startPort<0)throw Error("Provided options.startPort("+e.startPort+") is less than 0, which are cannot be bound.");if(e.stopPort<e.startPort)throw Error("Provided options.stopPort("+e.stopPort+"is less than options.startPort ("+e.startPort+")")}e.host&&-1!==t._defaultHosts.indexOf(e.host)&&t._defaultHosts.push(e.host);var i,r=[];return a.eachSeries(t._defaultHosts,(function(t,n){return l("in eachSeries() iteration callback: host is",t),d.testPort({host:t,port:e.port},(function(e,o){return e?(l("in eachSeries() iteration callback testPort() callback","with an err:",e.code),i=t,n(e)):(l("in eachSeries() iteration callback testPort() callback","with a success for port",o),r.push(o),n())}))}),(function(o){if(o){if(l("in eachSeries() result callback: err is",o),"EADDRNOTAVAIL"===o.code||"EINVAL"===o.code){if(e.host===i){var s="Provided host "+e.host+" could NOT be bound. Please provide a different host address or hostname";return n(Error(s))}var a=t._defaultHosts.indexOf(i);return t._defaultHosts.splice(a,1),t.getPort(e,n)}return n(o)}return r.sort((function(e,t){return e-t})),l("in eachSeries() result callback: openPorts is",r),r[0]===r[r.length-1]?r[0]<=e.stopPort?n(null,r[0]):(s="No open ports found in between "+e.startPort+" and "+e.stopPort,n(Error(s))):t.getPort({port:r.pop(),host:e.host,startPort:e.startPort,stopPort:e.stopPort},n)}))},t.getPortPromise=function(e){if("function"!=typeof Promise)throw Error("Native promise support is not available in this version of node.Please install a polyfill and assign Promise to global.Promise before calling this method");return e||(e={}),new Promise((function(n,i){t.getPort(e,(function(e,t){if(e)return i(e);n(t)}))}))},t.getPorts=function(e,n,i){i||(i=n,n={});var r=null;a.timesSeries(e,(function(e,i){r&&(n.port=t.nextPort(r)),t.getPort(n,(function(e,t){e?i(e):(r=t,i(null,t))}))}),i)},t.getSocket=function(e,n){function r(){i.stat(e.path,(function(i){i?"ENOENT"==i.code?n(null,e.path):n(i):(e.path=t.nextSocket(e.path),t.getSocket(e,n))}))}return n||(n=e,e={}),e.mod=e.mod||parseInt(755,8),e.path=e.path||t.basePath+".sock",e.exists?r():(o=s.dirname(e.path),void i.stat(o,(function(t,i){if(t||!i.isDirectory())return function(t){u(t,e.mod,(function(t){if(t)return n(t);e.exists=!0,r()}))}(o);e.exists=!0,r()})));var o},t.nextPort=function(e){return e+1},t.nextSocket=function(e){var t=s.dirname(e),n=s.basename(e,".sock").match(/^([a-zA-z]+)(\d*)$/i),i=parseInt(n[2]),r=n[1];return isNaN(i)&&(i=0),i+=1,s.join(t,r+i+".sock")},t._defaultHosts=function(){var e={};try{e=r.networkInterfaces()}catch(e){if("uv_interface_addresses"!==e.syscall)throw e}for(var t=Object.keys(e),n=["0.0.0.0"],i=0;i<t.length;i++)for(var o=e[t[i]],s=0;s<o.length;s++){var a=o[s];n.push(a.address)}return n.push(null),h("exports._defaultHosts is: %o",n),n}()},9544:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var i=0,r=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(r=i))})),t.splice(r,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(3303)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},3303:(e,t,n)=>{"use strict";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return i.colors[Math.abs(t)%i.colors.length]}function i(e){var n;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=s,a=Number(new Date),c=a-(n||a);o.diff=c,o.prev=n,o.curr=a,n=a,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;u++;var r=i.formatters[n];if("function"==typeof r){var s=t[u];e=r.call(o,s),t.splice(u,1),u--}return e})),i.formatArgs.call(o,t),(o.log||i.log).apply(o,t)}}return s.namespace=e,s.enabled=i.enabled(e),s.useColors=i.useColors(),s.color=t(e),s.destroy=r,s.extend=o,"function"==typeof i.init&&i.init(s),i.instances.push(s),s}function r(){var e=i.instances.indexOf(this);return-1!==e&&(i.instances.splice(e,1),!0)}function o(e,t){return i(this.namespace+(void 0===t?":":t)+e)}return i.debug=i,i.default=i,i.coerce=function(e){return e instanceof Error?e.stack||e.message:e},i.disable=function(){i.enable("")},i.enable=function(e){var t;i.save(e),i.names=[],i.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")));for(t=0;t<i.instances.length;t++){var o=i.instances[t];o.enabled=i.enabled(o.namespace)}},i.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=i.skips.length;t<n;t++)if(i.skips[t].test(e))return!1;for(t=0,n=i.names.length;t<n;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=n(6585),Object.keys(e).forEach((function(t){i[t]=e[t]})),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=t,i.enable(i.load()),i}},8092:(e,t,n)=>{"use strict";"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(9544):e.exports=n(2026)},2026:(e,t,n)=>{"use strict";var i=n(2018),r=n(9023);t.init=function(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),i=0;i<n.length;i++)e.inspectOpts[n[i]]=t.inspectOpts[n[i]]},t.log=function(){return process.stderr.write(r.format.apply(r,arguments)+"\n")},t.formatArgs=function(n){var i=this.namespace;if(this.useColors){var r=this.color,o="[3"+(r<8?r:"8;5;"+r),s="  ".concat(o,";1m").concat(i," [0m");n[0]=s+n[0].split("\n").join("\n"+s),n.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+i+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var o=n(7687);o&&(o.stderr||o).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),i=process.env[t];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),e[n]=i,e}),{}),e.exports=n(3303)(t);var s=e.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts)}},3231:e=>{!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(t){e=!!t.stack}var t,n=E(),i=function(){},r=function(){var e={task:void 0,next:null},t=e,n=!1,i=void 0,o=!1,s=[];function a(){for(var t,i;e.next;)t=(e=e.next).task,e.task=void 0,(i=e.domain)&&(e.domain=void 0,i.enter()),c(t,i);for(;s.length;)c(t=s.pop());n=!1}function c(e,t){try{e()}catch(e){if(o)throw t&&t.exit(),setTimeout(a,0),t&&t.enter(),e;setTimeout((function(){throw e}),0)}t&&t.exit()}if(r=function(e){t=t.next={task:e,domain:o&&process.domain,next:null},n||(n=!0,i())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)o=!0,i=function(){process.nextTick(a)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){i=p,u.port1.onmessage=a,a()};var p=function(){u.port2.postMessage(0)};i=function(){setTimeout(a,0),p()}}else i=function(){setTimeout(a,0)};return r.runAfter=function(e){s.push(e),n||(n=!0,i())},r}(),o=Function.call;function s(e){return function(){return o.apply(e,arguments)}}var a,c=s(Array.prototype.slice),u=s(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}for(;n<i;n++)n in this&&(t=e(t,this[n],n));return t}),p=s(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),l=s(Array.prototype.map||function(e,t){var n=this,i=[];return u(n,(function(r,o,s){i.push(e.call(t,o,s,n))}),void 0),i}),h=Object.create||function(e){function t(){}return t.prototype=e,new t},d=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},f=s(Object.prototype.hasOwnProperty),m=Object.keys||function(e){var t=[];for(var n in e)f(e,n)&&t.push(n);return t},g=s(Object.prototype.toString);function b(t,n){if(e&&n.stack&&"object"==typeof t&&null!==t&&t.stack){for(var i=[],r=n;r;r=r.source)r.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>r.stackCounter)&&(d(t,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),i.unshift(r.stack));i.unshift(t.stack);var o=function(e){for(var t=e.split("\n"),n=[],i=0;i<t.length;++i){var r=t[i];y(r)||(-1!==(o=r).indexOf("(module.js:")||-1!==o.indexOf("(node.js:"))||!r||n.push(r)}var o;return n.join("\n")}(i.join("\nFrom previous event:\n"));d(t,"stack",{value:o,configurable:!0})}}function v(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function y(e){var i=v(e);if(!i)return!1;var r=i[0],o=i[1];return r===t&&o>=n&&o<=q}function E(){if(e)try{throw new Error}catch(e){var n=e.stack.split("\n"),i=v(n[0].indexOf("@")>0?n[1]:n[2]);if(!i)return;return t=i[0],i[1]}}function T(e){return e instanceof A?e:I(e)?function(e){var t=_();return T.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}})),t.promise}(e):M(e)}a="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e},T.resolve=T,T.nextTick=r,T.longStackSupport=!1;var R=1;function _(){var t,n=[],i=[],r=h(_.prototype),o=h(A.prototype);if(o.promiseDispatch=function(e,r,o){var s=c(arguments);n?(n.push(s),"when"===r&&o[1]&&i.push(o[1])):T.nextTick((function(){t.promiseDispatch.apply(t,s)}))},o.valueOf=function(){if(n)return o;var e=k(t);return C(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},T.longStackSupport&&e)try{throw new Error}catch(e){o.stack=e.stack.substring(e.stack.indexOf("\n")+1),o.stackCounter=R++}function s(r){t=r,T.longStackSupport&&e&&(o.source=r),u(n,(function(e,t){T.nextTick((function(){r.promiseDispatch.apply(r,t)}))}),void 0),n=void 0,i=void 0}return r.promise=o,r.resolve=function(e){t||s(T(e))},r.fulfill=function(e){t||s(M(e))},r.reject=function(e){t||s(F(e))},r.notify=function(e){t||u(i,(function(t,n){T.nextTick((function(){n(e)}))}),void 0)},r}function x(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=_();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function S(e){return x((function(t,n){for(var i=0,r=e.length;i<r;i++)T(e[i]).then(t,n)}))}function A(e,t,n){void 0===t&&(t=function(e){return F(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=h(A.prototype);if(i.promiseDispatch=function(n,r,o){var s;try{s=e[r]?e[r].apply(i,o):t.call(i,r,o)}catch(e){s=F(e)}n&&n(s)},i.inspect=n,n){var r=n();"rejected"===r.state&&(i.exception=r.reason),i.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?i:e.value}}return i}function w(e,t,n,i){return T(e).then(t,n,i)}function k(e){if(C(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function C(e){return e instanceof A}function I(e){return(t=e)===Object(t)&&"function"==typeof e.then;var t}"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(T.longStackSupport=!0),T.defer=_,_.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(c(arguments,1)):e.resolve(n)}},T.Promise=x,T.promise=x,x.race=S,x.all=$,x.reject=F,x.resolve=T,T.passByCopy=function(e){return e},A.prototype.passByCopy=function(){return this},T.join=function(e,t){return T(e).join(t)},A.prototype.join=function(e){return T([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)}))},T.race=S,A.prototype.race=function(){return this.then(T.race)},T.makePromise=A,A.prototype.toString=function(){return"[object Promise]"},A.prototype.then=function(e,t,n){var i=this,r=_(),o=!1;return T.nextTick((function(){i.promiseDispatch((function(t){o||(o=!0,r.resolve(function(t){try{return"function"==typeof e?e(t):t}catch(e){return F(e)}}(t)))}),"when",[function(e){o||(o=!0,r.resolve(function(e){if("function"==typeof t){b(e,i);try{return t(e)}catch(e){return F(e)}}return F(e)}(e)))}])})),i.promiseDispatch(void 0,"when",[void 0,function(e){var t,i=!1;try{t=function(e){return"function"==typeof n?n(e):e}(e)}catch(e){if(i=!0,!T.onerror)throw e;T.onerror(e)}i||r.notify(t)}]),r.promise},T.tap=function(e,t){return T(e).tap(t)},A.prototype.tap=function(e){return e=T(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},T.when=w,A.prototype.thenResolve=function(e){return this.then((function(){return e}))},T.thenResolve=function(e,t){return T(e).thenResolve(t)},A.prototype.thenReject=function(e){return this.then((function(){throw e}))},T.thenReject=function(e,t){return T(e).thenReject(t)},T.nearer=k,T.isPromise=C,T.isPromiseAlike=I,T.isPending=function(e){return C(e)&&"pending"===e.inspect().state},A.prototype.isPending=function(){return"pending"===this.inspect().state},T.isFulfilled=function(e){return!C(e)||"fulfilled"===e.inspect().state},A.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},T.isRejected=function(e){return C(e)&&"rejected"===e.inspect().state},A.prototype.isRejected=function(){return"rejected"===this.inspect().state};var L,O=[],Z=[],P=[],N=!0;function D(){O.length=0,Z.length=0,N||(N=!0)}function F(e){var t=A({when:function(t){return t&&function(e){if(N){var t=p(Z,e);-1!==t&&("object"==typeof process&&"function"==typeof process.emit&&T.nextTick.runAfter((function(){var n=p(P,e);-1!==n&&(process.emit("rejectionHandled",O[t],e),P.splice(n,1))})),Z.splice(t,1),O.splice(t,1))}}(this),t?t(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,t){N&&("object"==typeof process&&"function"==typeof process.emit&&T.nextTick.runAfter((function(){-1!==p(Z,e)&&(process.emit("unhandledRejection",t,e),P.push(e))})),Z.push(e),t&&void 0!==t.stack?O.push(t.stack):O.push("(no stack) "+t))}(t,e),t}function M(e){return A({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null==t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return m(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function B(e,t,n){return T(e).spread(t,n)}function U(e,t,n){return T(e).dispatch(t,n)}function $(e){return w(e,(function(e){var t=0,n=_();return u(e,(function(i,r,o){var s;C(r)&&"fulfilled"===(s=r.inspect()).state?e[o]=s.value:(++t,w(r,(function(i){e[o]=i,0==--t&&n.resolve(e)}),n.reject,(function(e){n.notify({index:o,value:e})})))}),void 0),0===t&&n.resolve(e),n.promise}))}function V(e){if(0===e.length)return T.resolve();var t=T.defer(),n=0;return u(e,(function(i,r,o){var s=e[o];n++,w(s,(function(e){t.resolve(e)}),(function(e){0==--n&&(e.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+e.message,t.reject(e))}),(function(e){t.notify({index:o,value:e})}))}),void 0),t.promise}function j(e){return w(e,(function(e){return e=l(e,T),w($(l(e,(function(e){return w(e,i,i)}))),(function(){return e}))}))}T.resetUnhandledRejections=D,T.getUnhandledReasons=function(){return O.slice()},T.stopUnhandledRejectionTracking=function(){D(),N=!1},D(),T.reject=F,T.fulfill=M,T.master=function(e){return A({isDef:function(){}},(function(t,n){return U(e,t,n)}),(function(){return T(e).inspect()}))},T.spread=B,A.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},T.async=function(e){return function(){function t(e,t){var o;if("undefined"==typeof StopIteration){try{o=n[e](t)}catch(e){return F(e)}return o.done?T(o.value):w(o.value,i,r)}try{o=n[e](t)}catch(e){return function(e){return"[object StopIteration]"===g(e)||e instanceof a}(e)?T(e.value):F(e)}return w(o,i,r)}var n=e.apply(this,arguments),i=t.bind(t,"next"),r=t.bind(t,"throw");return i()}},T.spawn=function(e){T.done(T.async(e)())},T.return=function(e){throw new a(e)},T.promised=function(e){return function(){return B([this,$(arguments)],(function(t,n){return e.apply(t,n)}))}},T.dispatch=U,A.prototype.dispatch=function(e,t){var n=this,i=_();return T.nextTick((function(){n.promiseDispatch(i.resolve,e,t)})),i.promise},T.get=function(e,t){return T(e).dispatch("get",[t])},A.prototype.get=function(e){return this.dispatch("get",[e])},T.set=function(e,t,n){return T(e).dispatch("set",[t,n])},A.prototype.set=function(e,t){return this.dispatch("set",[e,t])},T.del=T.delete=function(e,t){return T(e).dispatch("delete",[t])},A.prototype.del=A.prototype.delete=function(e){return this.dispatch("delete",[e])},T.mapply=T.post=function(e,t,n){return T(e).dispatch("post",[t,n])},A.prototype.mapply=A.prototype.post=function(e,t){return this.dispatch("post",[e,t])},T.send=T.mcall=T.invoke=function(e,t){return T(e).dispatch("post",[t,c(arguments,2)])},A.prototype.send=A.prototype.mcall=A.prototype.invoke=function(e){return this.dispatch("post",[e,c(arguments,1)])},T.fapply=function(e,t){return T(e).dispatch("apply",[void 0,t])},A.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},T.try=T.fcall=function(e){return T(e).dispatch("apply",[void 0,c(arguments,1)])},A.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},T.fbind=function(e){var t=T(e),n=c(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(c(arguments))])}},A.prototype.fbind=function(){var e=this,t=c(arguments);return function(){return e.dispatch("apply",[this,t.concat(c(arguments))])}},T.keys=function(e){return T(e).dispatch("keys",[])},A.prototype.keys=function(){return this.dispatch("keys",[])},T.all=$,A.prototype.all=function(){return $(this)},T.any=V,A.prototype.any=function(){return V(this)},T.allResolved=(L=j,function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("allResolved is deprecated, use allSettled instead.",new Error("").stack),L.apply(L,arguments)}),A.prototype.allResolved=function(){return j(this)},T.allSettled=function(e){return T(e).allSettled()},A.prototype.allSettled=function(){return this.then((function(e){return $(l(e,(function(e){function t(){return e.inspect()}return(e=T(e)).then(t,t)})))}))},T.fail=T.catch=function(e,t){return T(e).then(void 0,t)},A.prototype.fail=A.prototype.catch=function(e){return this.then(void 0,e)},T.progress=function(e,t){return T(e).then(void 0,void 0,t)},A.prototype.progress=function(e){return this.then(void 0,void 0,e)},T.fin=T.finally=function(e,t){return T(e).finally(t)},A.prototype.fin=A.prototype.finally=function(e){if(!e||"function"!=typeof e.apply)throw new Error("Q can't apply finally callback");return e=T(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},T.done=function(e,t,n,i){return T(e).done(t,n,i)},A.prototype.done=function(e,t,n){var i=function(e){T.nextTick((function(){if(b(e,r),!T.onerror)throw e;T.onerror(e)}))},r=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),r.then(void 0,i)},T.timeout=function(e,t,n){return T(e).timeout(t,n)},A.prototype.timeout=function(e,t){var n=_(),i=setTimeout((function(){t&&"string"!=typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),n.reject(t)}),e);return this.then((function(e){clearTimeout(i),n.resolve(e)}),(function(e){clearTimeout(i),n.reject(e)}),n.notify),n.promise},T.delay=function(e,t){return void 0===t&&(t=e,e=void 0),T(e).delay(t)},A.prototype.delay=function(e){return this.then((function(t){var n=_();return setTimeout((function(){n.resolve(t)}),e),n.promise}))},T.nfapply=function(e,t){return T(e).nfapply(t)},A.prototype.nfapply=function(e){var t=_(),n=c(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},T.nfcall=function(e){var t=c(arguments,1);return T(e).nfapply(t)},A.prototype.nfcall=function(){var e=c(arguments),t=_();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},T.nfbind=T.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=c(arguments,1);return function(){var n=t.concat(c(arguments)),i=_();return n.push(i.makeNodeResolver()),T(e).fapply(n).fail(i.reject),i.promise}},A.prototype.nfbind=A.prototype.denodeify=function(){var e=c(arguments);return e.unshift(this),T.denodeify.apply(void 0,e)},T.nbind=function(e,t){var n=c(arguments,2);return function(){var i=n.concat(c(arguments)),r=_();return i.push(r.makeNodeResolver()),T((function(){return e.apply(t,arguments)})).fapply(i).fail(r.reject),r.promise}},A.prototype.nbind=function(){var e=c(arguments,0);return e.unshift(this),T.nbind.apply(void 0,e)},T.nmapply=T.npost=function(e,t,n){return T(e).npost(t,n)},A.prototype.nmapply=A.prototype.npost=function(e,t){var n=c(t||[]),i=_();return n.push(i.makeNodeResolver()),this.dispatch("post",[e,n]).fail(i.reject),i.promise},T.nsend=T.nmcall=T.ninvoke=function(e,t){var n=c(arguments,2),i=_();return n.push(i.makeNodeResolver()),T(e).dispatch("post",[t,n]).fail(i.reject),i.promise},A.prototype.nsend=A.prototype.nmcall=A.prototype.ninvoke=function(e){var t=c(arguments,1),n=_();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},T.nodeify=function(e,t){return T(e).nodeify(t)},A.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){T.nextTick((function(){e(null,t)}))}),(function(t){T.nextTick((function(){e(t)}))}))},T.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var q=E();return T}))},7687:(e,t,n)=>{"use strict";const i=n(857),r=n(5884),o=process.env;let s;function a(e){const t=function(e){if(!1===s)return 0;if(r("color=16m")||r("color=full")||r("color=truecolor"))return 3;if(r("color=256"))return 2;if(e&&!e.isTTY&&!0!==s)return 0;const t=s?1:0;if("win32"===process.platform){const e=i.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((e=>e in o))||"codeship"===o.CI_NAME?1:t;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:(o.TERM,t)}(e);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(t)}r("no-color")||r("no-colors")||r("color=false")?s=!1:(r("color")||r("colors")||r("color=true")||r("color=always"))&&(s=!0),"FORCE_COLOR"in o&&(s=0===o.FORCE_COLOR.length||0!==parseInt(o.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},4265:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){return i(this,void 0,void 0,(function*(){const t={language:"mumps",scheme:"file"},n=r.languages.createDiagnosticCollection("mumps");let i="";if(void 0!==e.storageUri){i=e.storageUri.fsPath,E.existsSync(i)||E.mkdirSync(i);const n=i+"/labeldb.json";e.subscriptions.push(r.languages.registerCompletionItemProvider(t,new b.default(n)))}const c=e.workspaceState;e.subscriptions.push(r.commands.registerCommand("mumps.documentFunction",(()=>{(0,g.default)()})),r.commands.registerCommand("mumps.autoSpaceEnter",(()=>{(0,o.autoSpaceEnter)()})),r.commands.registerCommand("mumps.autoSpaceTab",(()=>{(0,o.autoSpaceTab)()})),r.commands.registerCommand("mumps.toggleExpandedCommands",(()=>{(0,v.default)(c)})),r.commands.registerCommand("mumps.getEntryRef",(()=>r.window.showInputBox({placeHolder:"Please enter the Entry-Reference to start Debugging",value:R}))),r.languages.registerHoverProvider(t,new d.default),r.languages.registerDefinitionProvider(t,new p.default),r.languages.registerEvaluatableExpressionProvider(t,new l.default),r.languages.registerSignatureHelpProvider(t,new m.default,"(",","),r.languages.registerDocumentSymbolProvider(t,new u.default),r.languages.registerDocumentSemanticTokensProvider(t,s.MumpsHighlighter,s.SemanticTokens),r.languages.registerDocumentFormattingEditProvider(t,new h.default),r.languages.registerDocumentRangeFormattingEditProvider(t,new h.default),r.languages.registerReferenceProvider(t,new f.default),r.debug.registerDebugConfigurationProvider("mumps",new a.default),r.debug.registerDebugAdapterDescriptorFactory("mumps",new _),r.window.onDidChangeActiveTextEditor((e=>{e&&x(e.document,n)})),r.workspace.onDidChangeTextDocument((e=>{e&&x(e.document,n)})),r.workspace.onDidOpenTextDocument((e=>{x(e,n)}))),r.workspace.getConfiguration("editor").update("formatOnSave",!1,r.ConfigurationTarget.Global)}))},t.deactivate=function(){};const r=n(1398),o=n(961),s=n(5309),a=n(7889),c=n(6025),u=n(4820),p=n(2439),l=n(2708),h=n(4681),d=n(1653),f=n(7598),m=n(7494),g=n(1658),b=n(2548),v=n(3908),y=n(8143),E=n(9896);let T;const R="";class _{createDebugAdapterDescriptor(){return new r.DebugAdapterInlineImplementation(new c.default)}}function x(e,t){T&&(clearTimeout(T),T=void 0),T=setTimeout((()=>new y.default(e,t)),500)}},419:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.definitionsArray=void 0,t.definitionsArray=[{name:"BREAK",type:"command",abbreviation:"B",description:"Suspend execution or exit a block"},{name:"CLOSE",type:"command",abbreviation:"C",description:"Release an I/O device"},{name:"DO",type:"command",abbreviation:"D",description:"Execute a program, section of code or block"},{name:"ELSE",type:"command",abbreviation:"E",description:"Conditional execution based on $test"},{name:"FOR",type:"command",abbreviation:"F",description:"Iterative execution of a line or block"},{name:"GOTO",type:"command",abbreviation:"G",description:"Transfer of control to a label or program"},{name:"HALT",type:"command",abbreviation:"H",description:"Terminate execution"},{name:"HANG",type:"command",abbreviation:"H",description:"Delay execution for a specified period of time"},{name:"IF",type:"command",abbreviation:"I",description:"Conditional execution of remainder of line"},{name:"JOB",type:"command",abbreviation:"J",description:"Start an independent process"},{name:"LOCK",type:"command",abbreviation:"L",description:"Exclusive access/release named resource"},{name:"KILL",type:"command",abbreviation:"K",description:"Deletes a local or global variable"},{name:"MERGE",type:"command",abbreviation:"M",description:"Copy arrays"},{name:"NEW",type:"command",abbreviation:"N",description:"Create new copies of local variables"},{name:"OPEN",type:"command",abbreviation:"O",description:"Obtain ownership of a device"},{name:"QUIT",type:"command",abbreviation:"Q",description:"End a for loop or exit a block"},{name:"READ",type:"command",abbreviation:"R",description:"Read from a device"},{name:"SET",type:"command",abbreviation:"S",description:"Assign a value to a global or local variable"},{name:"TCOMMIT",type:"command",abbreviation:"TC",description:"Commit a transaction"},{name:"TRESTART",type:"command",abbreviation:"TRE",description:"Roll back / restart a transaction"},{name:"TROLLBACK",type:"command",abbreviation:"TRO",description:"Roll back a transaction"},{name:"TSTART",type:"command",abbreviation:"TS",description:"Begin a transaction"},{name:"USE",type:"command",abbreviation:"U",description:"Select which device to read/write"},{name:"VIEW",type:"command",abbreviation:"V",description:"Implementation defined"},{name:"WRITE",type:"command",abbreviation:"W",description:"Write to device"},{name:"XECUTE",type:"command",abbreviation:"X",description:"Dynamically execute strings"},{name:"ZALLOCATE",type:"command",abbreviation:"ZA",description:"Reserves the specified name"},{name:"ZBREAK",type:"command",abbreviation:"ZB",description:"Sets or clears a routine breakpoint"},{name:"ZCOMPILE",type:"command",abbreviation:"ZCOM",description:"Compiles a routine"},{name:"ZCONTINUE",type:"command",abbreviation:"ZC",description:"Continues excutioen after a break"},{name:"ZDEALLOCATE",type:"command",abbreviation:"ZD",description:"Release the specified name"},{name:"ZEDIT",type:"command",abbreviation:"ZE",description:"Invokes editor for routine editing"},{name:"ZGOTO",type:"command",abbreviation:"ZG",description:"Moves to EntryRef on a given stacklevel"},{name:"ZHALT",type:"command",abbreviation:"ZHALT",description:"Stops program execution with a return code"},{name:"ZHELP",type:"command",abbreviation:"ZH",description:"Accessses M help library"},{name:"ZKILL",type:"command",abbreviation:"ZK",description:"Kills a data value but not the descendants"},{name:"ZLINK",type:"command",abbreviation:"ZL",description:"Compiles an links a routine to the current process"},{name:"ZMESSAGE",type:"command",abbreviation:"ZM",description:"Raises an exception specified by given code"},{name:"ZPRINT",type:"command",abbreviation:"ZP",description:"Displays source code lines"},{name:"ZRUPDATE",type:"command",abbreviation:"ZRUPDATE",description:"Publishes the new versions of routines to subscribers"},{name:"ZSHOW",type:"command",abbreviation:"ZSH",description:"Displays information about the current environment"},{name:"ZSTEP",type:"command",abbreviation:"ZST",description:"Controls routine execution"},{name:"ZSYSTEM",type:"command",abbreviation:"ZSY",description:"Creates a child of the current process"},{name:"ZTCOMMIT",type:"command",abbreviation:"ZTC",description:"Marks the end of a logical transaction"},{name:"ZTRIGGER",type:"command",abbreviation:"ZTR",description:"Invokes specified Global Triggers"},{name:"ZTSTART",type:"command",abbreviation:"ZTS",description:"Marks the beginning of a logical transaction"},{name:"ZWITHDRAW",type:"command",abbreviation:"ZWI",description:"Kills a data value but not the descendants"},{name:"ZWRITE",type:"command",abbreviation:"ZWR",description:"Displays a complete global or local variable"},{name:"$DEVICE",type:"variable",abbreviation:"$D",description:"Status of the current device"},{name:"$ECODE",type:"variable",abbreviation:"$EC",description:"List of unresolved error codes"},{name:"$ESTACK",type:"variable",abbreviation:"$ES",description:"Number of stack levels; NEWing $ESTACK resets it to 0"},{name:"$ETRAP",type:"variable",abbreviation:"$ET",description:"Code to execute on error"},{name:"$HOROLOG",type:"variable",abbreviation:"$H",description:"Days,seconds time stamp"},{name:"$IO",type:"variable",abbreviation:"$I",description:"Current IO unit"},{name:"$JOB",type:"variable",abbreviation:"$J",description:"Current process ID"},{name:"$KEY",type:"variable",abbreviation:"$K",description:"String that terminated the most recent READ command"},{name:"$PRINCIPAL",type:"variable",abbreviation:"$P",description:"Principal I/O device"},{name:"$QUIT",type:"variable",abbreviation:"$Q",description:"Whether the current block of code was called as an extrinsic function (e.g. via $$)"},{name:"$STACK",type:"variable",abbreviation:"$ST",description:"Current process stack level"},{name:"$STORAGE",type:"variable",abbreviation:"$S",description:"Amount of memory available, in bytes"},{name:"$SYSTEM",type:"variable",abbreviation:"$SY",description:"System ID"},{name:"$TEST",type:"variable",abbreviation:"$T",description:"Result of prior IF command or READ/OPEN/LOCK command if invoked with a timeout"},{name:"$TLEVEL",type:"variable",abbreviation:"$TL",description:"Number transactions in process"},{name:"$TRESTART",type:"variable",abbreviation:"$TR",description:"Number of restarts on current transaction"},{name:"$X",type:"variable",abbreviation:"$X",description:"Position of horizontal cursor in current I/O device"},{name:"$Y",type:"variable",abbreviation:"$Y",description:"Position of vertical cursor in current I/O device"},{name:"$ASCII",type:"function",abbreviation:"$A",description:"ASCII numeric code of a character",parameters:[{name:"VALUE",type:"string",description:"A string to get a code from"},{name:"POS",type:"number",optional:!0,description:"The 1-based position of the character in VALUE; defaults to 1"}],returns:{type:"number"}},{name:"$CHAR",type:"function",abbreviation:"$C",description:"ASCII character from numeric code",parameters:[{name:"CODE",type:"number",description:"Numeric code to convert to a character"},{name:"...",type:"number",optional:!0,description:"Additional codes to convert to characters"}],returns:{type:"string"}},{name:"$DATA",type:"function",abbreviation:"$D",description:"Returns data about a variable: 0: if undefined, 1: if valued but has no descendants, 10: if has descendants but no value; 11: if has both a value and descendants",parameters:[{name:"VAR",type:"reference",description:"The variable to get data about, e.g. ^X"}],returns:{type:"number"}},{name:"$EXTRACT",type:"function",abbreviation:"$E",description:"Extract a substring",parameters:[{name:"VALUE",type:"string",description:"The string to get a substring from"},{name:"START",type:"number",optional:!0,description:"The 1-based start index; defaults to 1"},{name:"END",type:"number",optional:!0,description:"The 1-based end index; defaults to 2"}],returns:{type:"string"}},{name:"$FIND",type:"function",abbreviation:"$F",description:"Find the 1-based index after the end of a substring or 0 if not found",parameters:[{name:"WITHIN",type:"string",description:"The string to search in"},{name:"SUBSTRING",type:"string",description:"The substring to search for"},{name:"START",type:"number",optional:!0,description:"The 1-based index to start searching from; defaults to 1"}],returns:{type:"number"}},{name:"$FNUMBER",type:"function",abbreviation:"$FN",description:"Format a number",parameters:[{name:"NUMBER",type:"number",description:"The number to format"},{name:"FORMAT",type:"string",description:'One or more of the following: +: forces "+" on positive numbers; -: omits the "-" on negative numbers; ,: comma-separates the number by thousands; T: puts the sign in the trailing position; P: wraps negative numbers in parentheses and wraps positive numbers in spaces and may only be combined with comma (,)'},{name:"DIGITS",type:"number",optional:!0,description:"The numer of digits after the decimal point"}],returns:{type:"any"}},{name:"$GET",type:"function",abbreviation:"$G",description:"Get default or actual value",parameters:[{name:"VAR",type:"reference",description:"The variable to query, e.g. ^X(THIS,THAT)"},{name:"DEFAULT",type:"any",optional:!0,description:'A value to use if VAR has no value; defaults to ""'}],returns:{type:"any"}},{name:"$JUSTIFY",type:"function",abbreviation:"$J",description:"Right-justify a number or string by prefixing with spaces",parameters:[{name:"VALUE",type:"string",description:"The string to justify"},{name:"MINLENGTH",type:"number",description:"The minimum length of the result"},{name:"DIGITS",type:"number",description:"The number of digits after the decimal point; providing this argument makes $JUSTIFY treat VALUE as a number"}],returns:{type:"string"}},{name:"$LENGTH",type:"function",abbreviation:"$L",description:"Determine string length",parameters:[{name:"VALUE",type:"string",description:"The string"},{name:"SUBSTRING",type:"string",optional:!0,description:"If present, $LENGTH returns one more than the number of occurences of SUBSTRING in VALUE"}],returns:{type:"number"}},{name:"$NAME",type:"function",abbreviation:"$NA",description:"Evaluate and describe a variable",parameters:[{name:"VAR",type:"reference",description:"The variable to evaluate, including naked references"},{name:"MAXSUBSCRIPT",type:"number",optional:!0,description:"The maximum number of subscripts to evaluate if VAR is an array"}],returns:{type:"string"}},{name:"$ORDER",type:"function",abbreviation:"$O",description:"Find the subscript of the next or previous node",parameters:[{name:"VAR",type:"reference",description:"The array to query, e.g. ^AR"},{name:"DIRECTION",type:"number",optional:!0,description:"1: forward, -1: reverse; defaults to 1"}],returns:{type:"string|number"}},{name:"$PIECE",type:"function",abbreviation:"$P",description:"Extract substring based on pattern",parameters:[{name:"VALUE",type:"string",description:"The string"},{name:"SUBSTRING",type:"string",description:"A delimiting string within VALUE"},{name:"PIECE",type:"number",optional:!0,description:"Which 1-based piece of the split string to return; defaults to 1"},{name:"LASTPIECE",type:"number",optional:!0,description:"The 1-based index of the last piece of the split string to return; defaults to PIECE"}],returns:{type:"any"}},{name:"$QLENGTH",type:"function",abbreviation:"$QL",description:"Number of subscripts in an array reference",parameters:[{name:"VAR",type:"reference",description:"The array to query, e.g. ^AR"}],returns:{type:"any"}},{name:"$QSUBSCRIPT",type:"function",abbreviation:"$QS",description:"Value of specified subscript",parameters:[{name:"VAR",type:"reference",description:"The array to query, e.g. ^AR"},{name:"SUBSCRIPT",type:"number",description:"The 1-based index of the subscript to find; special values include -1: environment and 0: unsubscripted name"}],returns:{type:"string|number"}},{name:"$QUERY",type:"function",abbreviation:"$Q",description:"Next item in an array; invoke multiple times to iterate the entire array",parameters:[{name:"VAR",type:"reference",description:"The array to query, e.g. ^AR"}],returns:{type:"any"}},{name:"$RANDOM",type:"function",abbreviation:"$R",description:"Random number",parameters:[{name:"LIMIT",type:"number",description:"The generated random number will be between 0 (inclusive) and this LIMIT (exclusive)"}],returns:{type:"number"}},{name:"$REVERSE",type:"function",abbreviation:"$RE",description:"String in reverse order",parameters:[{name:"VALUE",type:"string",description:"A string to reverse"}],returns:{type:"string"}},{name:"$SELECT",type:"function",abbreviation:"$S",description:"Value of first true argument",parameters:[{name:"TVEXPR",type:"expression",description:'An expression to test for truth, followed by a colon and a value, e.g. i=42:"Answered!"'},{name:"...",type:"expression",optional:!0,description:"Additional truth value expressions to test; the last expression often starts with 1: to avoid errors"}],returns:{type:"any"}},{name:"$STACK",type:"function",abbreviation:"$ST",description:"Returns information about the process stack",parameters:[{name:"LEVEL",type:"number",description:"-1: returns the highest stack level; 0: returns information about how the program was started; 1 to $STACK(-1): returns information about how the stack level was created"},{name:"FIELD",type:"string",optional:!0,description:'"MCODE": the line of code that was executed; "PLACE": location of the executed code; "ECODE": the error code(s) added at the stack level, if any'}],returns:{type:"string|number"}},{name:"$TEXT",type:"function",abbreviation:"$T",description:"Returns the text of a line of M[UMPS] code",parameters:[{name:"REFERENCE",type:"string",description:"A reference to a code location, e.g. 'LABEL' or '+4^PROGRAM' or 'LABEL^PROGRAM', etc."}],returns:{type:"string"}},{name:"$TRANSLATE",type:"function",abbreviation:"$TR",description:"Translate characters in a string",parameters:[{name:"VALUE",type:"string",description:"The value to translate"},{name:"OLD",type:"string",description:"Characters in VALUE to replace"},{name:"NEW",type:"string",optional:!0,description:"Characters to replace OLD characters with; if not provided then OLD characters will be removed"}],returns:{type:"string"}},{name:"$VIEW",type:"function",abbreviation:"$V",description:"Implementation defined"},{name:"$ZAHANDLE",type:"function",abbreviation:"$ZAH",description:"Returns unique identifier for a name or an alias container",parameters:[{name:"VAR",type:"reference",description:"The variable to find the handle for e.g"}],returns:{type:"string"}},{name:"$ZASCII",type:"function",abbreviation:"$ZA",description:"ASCII numeric code of a 8-bit character",parameters:[{name:"VALUE",type:"string",description:"A string to get a code from"},{name:"POS",type:"number",optional:!0,description:"The 1-based position of the byte in VALUE; defaults to 1"}],returns:{type:"number"}},{name:"$ZATRANSFORM",type:"function",abbreviation:"$ZATR",description:"Returns the transformed representation of the first argument expr in a normalized form using the alternative transform specified by the second argument intexpr; the return can be used as an operand to the follows (]) or sorts-after (]]) operator such that, if both operands are in the normalized form, the result is independent of alternative collation.",parameters:[{name:"VALUE",type:"string",description:"String to transform"},{name:"ID",type:"Number",optional:!1,description:"ID of the alternative transform to use"},{name:"NORMALIZE",type:"Number",optional:!0,description:"whether the transform is to normalized form, by default or if zero (0), or, if one (1), the reverse transform from the normalized to the native form"},{name:"MCOLLATION",type:"Number",optional:!0,description:"whether to use standard M collation of numbers before strings, the default or zero (0), or to sort all values as strings (1)"}],returns:{type:"string"}},{name:"$ZBITAND",type:"function",abbreviation:"$ZBITAND",description:"Performs a logical AND function on two bit strings and returns a bit string equal in length to the shorter of the two arguments (containing set bits in those positions where both of the input strings have set bits). Positions corresponding to positions where either of the input strings have a cleared bit, also have cleared bits in the resulting string",parameters:[{name:"FIRSTEXPR",type:"string",description:"first expression"},{name:"2NDEXPR",type:"string",optional:!1,description:"second expression"}],returns:{type:"string"}},{name:"$ZBITCOUNT",type:"function",abbreviation:"$ZBITCOUNT",description:"Returns the number of ON bits in a bit string.",parameters:[{name:"EXPR",type:"string",description:"The expression specifies the bit string to examine"}],returns:{type:"number"}},{name:"$ZBITFIND",type:"function",abbreviation:"$ZBITFIND",description:"Performs the analog of $FIND() on a bit string. It returns an integer that identifies the position after the first position equal to a truth-valued expression that occurs at, or after, the specified starting position",parameters:[{name:"VALUE",type:"string",description:"The expression specifies the bit string to examine"},{name:"TRUTHVALUE",type:"Number",optional:!0,description:"The truth-valued expression specifies the bit value for which $ZBITFIND() searches (1 or 0)"},{name:"POS",type:"Number",optional:!0,description:"The optional integer argument specifies the starting position at which to begin the search"}],returns:{type:"number"}},{name:"$ZBITGET",type:"function",abbreviation:"$ZBITGET",description:"",parameters:[{name:"VALUE",type:"string",description:"The expression specifies the bit string to examine"},{name:"POS",type:"Number",optional:!1,description:"The integer argument specifies the position in the string for which the value is requested"}],returns:{type:"number"}},{name:"$ZBITLEN",type:"function",abbreviation:"$ZBITLEN",description:"Returns the length of a bit string, in bits",parameters:[{name:"VALUE",type:"string",description:"The expression specifies the bit string to examine"}],returns:{type:"number"}},{name:"$ZBITNOT",type:"function",abbreviation:"$ZBITNOT",description:"Returns a copy of the bit string with each input bit position inverted",parameters:[{name:"VALUE",type:"string",description:"The expression specifies the bit string to invert"}],returns:{type:"string"}},{name:"$ZBITOR",type:"function",abbreviation:"$ZBITOR",description:"Performs a bitwise logical OR on two bit strings, and returns a bit string equal in length to the longer of the two arguments (containing set bits in those positions where either or both of the input strings have set bits). Positions that correspond to positions where neither input string has a set bit have cleared bits in the resulting string",parameters:[{name:"FIRSTEXPR",type:"string",description:"first expression"},{name:"2NDEXPR",type:"string",optional:!1,description:"second expression"}],returns:{type:"string"}},{name:"$ZBITSET",type:"function",abbreviation:"$ZBITSET",description:"Returns an edited copy of the input bit string with a specified bit set to the value of the truth-valued expression",parameters:[{name:"VALUE",type:"string",description:"The expression specifies the input bit string"},{name:"POS",type:"Number",optional:!1,description:"The integer expression specifies the position of the bit to manipulate. Arguments that are negative, zero, or exceed the length of the bit string produce a run-time error. $ZBIT functions count the first bit as position one (1)"},{name:"TRUTHVALUE",type:"Number",optional:!1,description:"The truth-valued expression specifies the value to which to set the specified bit (0 or 1)"}],returns:{type:"string"}},{name:"$ZBITSTR",type:"function",abbreviation:"$ZBITSTR",description:"Returns a bit string of a specified length with all bit positions initially set to either zero or one",parameters:[{name:"LENGTH",type:"Number",description:"The integer expression specifies the length of the bit string to return; arguments that exceed the maximum length of 253,952 produce a run-time error"},{name:"TRUTHVALUE",type:"Number",optional:!0,description:"The optional truth-valued expression specifies the value to which all bit positions should initially be set (0 or 1). If this argument is missing, the bits are set to zero"}],returns:{type:"number"}},{name:"$ZBITXOR",type:"function",abbreviation:"$ZBITXOR",description:"Performs a bitwise exclusive OR on two bit strings, and returns a bit string equal in length to the shorter of the two arguments (containing set bits in those positions where either (but not both) of the input strings have set bits). Positions that correspond to positions where neither or both input strings have a set bit have cleared bits in the resulting string",parameters:[{name:"FIRSTEXPR",type:"string",description:"first expression"},{name:"2NDEXPR",type:"string",optional:!1,description:"second expression"}],returns:{type:"string"}},{name:"$ZCHAR",type:"function",abbreviation:"$ZCH",description:"Returns a string composed of bytes represented by the integer octet values specified in its argument(s).",parameters:[{name:"Integer",type:"Number",description:"The integer expression(s) specify the numeric byte value of the byte(s) $ZCHAR() returns"},{name:"...",type:"number",optional:!0,description:"Additional codes to convert to characters"}],returns:{type:"string"}},{name:"$ZCOLLATE",type:"function",abbreviation:"$ZCO",description:"Returns the transformed representation of the first argument glvn in a normalized form using the alternative transform specified by the second argument intexpr; the return can be used as an operand to the follows (]) or sorts-after (]]) operator such that, if both operands are in the normalized form, the result is independent of alternative collation.",parameters:[{name:"var",type:"reference",description:"The subscripted or unsubscripted global or local variable name specifies the key to transform"},{name:"TransformId",type:"number",description:"Specifies the ID of the alternative transform to use"},{name:"NormForm",type:"number",optional:!0,description:"Specifies whether the transform is to normalized form, by default or if zero (0), or, if one (1), the reverse transform from the normalized to the native form."}],returns:{type:"string"}},{name:"$ZCONVERT",type:"function",description:"Returns its first argument as a string or value converted to a different encoding or numeric base. The two argument form changes the encoding for case within the ASCII character set. The three argument form changes the encoding scheme or base. Supported bases are decimal 'DEC' and 'HEX', case insensitive).",abbreviation:"$ZCO",parameters:[{name:"expr1",type:"any",description:"string or value to convert. $ZCONVERT() generates a run-time error if for Unicode conversion if the string contains a code-point value that is not in the character set, or for base conversion if the value to be converted is out of range"},{name:"expr2",type:"code",description:"Specifies a code that determines the form of the result."},{name:"expr3",type:"code",optional:!0,description:"Code that specifies the character set or base of the result"}],returns:{type:"string"}},{name:"$ZDATA",type:"function",abbreviation:"$ZDATA",description:"Extends $DATA() to reflect the current alias state of the lvn or name argument to identify alias and alias container variables. It treats variables joined through pass-by-reference as well as TP RESTART variables within a transaction as alias variables. However, it does not distinguish nodes having alias containers among their descendants.",parameters:[{name:"var",type:"reference",description:"Returns data about a variable: 0: if undefined, 1: if valued but has no descendants, 10: if has descendants but no value; 11: if has both a value and descendants; 100; 101; 111"}],returns:{type:"number"}},{name:"$ZDATE",type:"function",description:"Returns a date and/or time formatted as text based on an argument formatted in the manner of $HOROLOG",abbreviation:"$ZDATE",parameters:[{name:"expr1",type:"any",description:"$HOROLOG format of the date and/or time"},{name:"expr2",type:"string",optional:!0,description:"Pattern of desired output p.e. 'YEAR-MM-DD'"},{name:"expr3",type:"string",optional:!0,description:"Specifies a list of 12 month codes, separated by commas (,)"},{name:"expr4",type:"string",optional:!0,description:"Specifies a list of seven day codes, separated by commas (,)"}],returns:{type:"string"}},{name:"$ZEXTRACT",type:"function",abbreviation:"$ZE",description:"Returns a byte sequence from a given sequence of octets (8-bit bytes).",parameters:[{name:"expr1",type:"any",description:"Specifies a sequence of octets (8-bit bytes) from which $ZEXTRACT() derives a byte sequence"},{name:"intexpr1",type:"number",optional:!0,description:"Specifies the starting byte position in the byte string"},{name:"intexpr2",type:"number",optional:!0,description:"Specifies the ending byte position for the result"}],returns:{type:"string"}},{name:"$ZFIND",type:"function",abbreviation:"$ZF",description:"Returns an integer byte position that locates the occurrence of a byte sequence within a sequence of octets(8-bit bytes).",parameters:[{name:"expr1",type:"string",description:"Specifies the sequence of octets (8-bit bytes) in which $ZFIND() searches for the byte sequence"},{name:"expr2",type:"string",description:" specifies the byte sequence for which $ZFIND() searches"},{name:"expr3",type:"number",optional:!0,description:"Identifies the starting byte position for the $ZFIND() search"}],returns:{type:"number"}},{name:"$ZGETJPI",type:"function",description:"Returns job or process information of the specified process",abbreviation:"$ZGETJPI",parameters:[{name:"expr1",type:"any",description:"Identifies the PID of the target job. If expr1 is an empty string (), $ZGETJPI() returns information about the current process."},{name:"expr2",type:"string",description:"Specifies the item keyword identifying the type of information returned"}],returns:{type:"string"}},{name:"$ZJOBEXAM",type:"function",description:"Returns the full specification of the file specified by the optional expr1 argument into which the function places a ZSHOW output specified by expr2",abbreviation:"$ZJOBEXAM",parameters:[{name:"expr1",type:"any",description:"A template output device specification. It can be a device, a file directory, or a file name."},{name:"expr2",type:"",optional:!0,description:"Defaulting to '*', expr2 specifies the ZSHOW Information Codes of data to be included in the output"}],returns:{type:"string"}},{name:"$ZJUSTIFY",type:"function",abbreviation:"$ZJ",description:"",parameters:[{name:"expr1",type:"any",description:"The expression specifies the sequence of octets formatted by $ZJUSTIFY()."},{name:"expr2",type:"number",description:"Specifies the minimum size of the resulting byte sequence."},{name:"expr3",type:"",optional:!0,description:"The number of digits after the decimal point; providing this argument makes $ZJUSTIFY treat expr1 as a number"}],returns:{type:"string"}},{name:"$ZLENGTH",abbreviation:"$ZL",type:"function",description:"Returns the length of a sequence of octets measured in bytes, or in pieces separated by a delimiter specified by one of its arguments",parameters:[{name:"expr1",type:"any",description:"Specifies the sequence of octets that $ZLENGTH() measures."},{name:"expr2",type:"number",optional:!0,description:"specifies the delimiter that defines the measure; if this argument is missing, $ZLENGTH() returns the number of bytes in the sequence of octets."}],returns:{type:"string"}},{name:"$ZMESSAGE",type:"function",description:"Returns a message string associated with a specified status code .",abbreviation:"ZM",parameters:[{name:"expr1",type:"number",description:"The integer expression specifies the status code for which $ZMESSAGE() returns error message text ."}],returns:{type:"string"}},{name:"$ZPARSE",type:"function",description:"Expands a file name to a full pathname and then returns the full pathname or one of its fields (directory, name, or extension).",abbreviation:"$ZPARSE",parameters:[{name:"expr1",type:"any",description:"Specifies the file name; if the file name is not valid, $ZPARSE() returns a null string"},{name:"expr2",type:"string",optional:!0,description:"Specifies the field of the pathname that $ZPARSE() returns"},{name:"expr3",type:"",optional:!0,description:"Specify default values to use during file name expansion for missing fields (directory, name, or extension)"},{name:"expr4",type:"",optional:!0,description:"Specify default values to use during file name expansion for missing fields (directory, name, or extension)"},{name:"expr5",type:"",optional:!0,description:"Specifies the mode or type of parse that $ZPARSE() performs."}],returns:{type:"string"}},{name:"$ZPIECE",abbreviation:"$ZPI",type:"function",description:"Return a sequence of bytes delimited by a specified byte sequence made up of one or more bytes.",parameters:[{name:"expr1",type:"any",description:"specifies the sequence of octets from which $ZPIECE() takes its result."},{name:"expr2",type:"string",description:"Specifies the delimiting byte sequence that determines the piece 'boundaries'"},{name:"expr3",type:"",optional:!0,description:"Specifies the beginning piece to return"},{name:"expr4",type:"",optional:!0,description:"Specifies the last piece to return"}],returns:{type:"string"}},{name:"$ZPREVIOUS",abbreviation:"$ZP",type:"function",description:"Returns the subscript of the previous local or global variable name in collation sequence within the array level specified by its argument.",parameters:[{name:"glvn",type:"reference",description:"Specifies the node prior to which $ZPREVIOUS() searches backwards for a defined node with data and/or descendants."}],returns:{type:"string"}},{name:"$ZQGBLMOD",type:"function",description:"Enables an application to determine whether it can safely apply a lost transaction to the database.",abbreviation:"$ZQGBLMOD",parameters:[{name:"gvn",type:"reference",description:"The subscripted or non-subscripted global variable name (gvn) specifies the target node."}],returns:{type:"boolean"}},{name:"$ZSEARCH",type:"function",description:"Attempts to locate a file matching the specified file name. If the file exists, it returns the file name; if the file does not exist, it returns the null string.",abbreviation:"$ZSEARCH",parameters:[{name:"expr1",type:"any",description:"Contains a file name, with or without wildcards, for which $ZSEARCH() attempts to locate a matching file."},{name:"expr2",type:"number",optional:!0,description:"Specifies an integer expression that is a stream number. It can be any value from 0 to 255 for each search"}],returns:{type:"string"}},{name:"$ZSIGPROC",type:"function",description:"Sends a signal to a process. The format for the $ZSIGPROC function is",abbreviation:"$ZSIGPROC",parameters:[{name:"expr1",type:"number",description:"The pid of the process to which the signal is to be sent."},{name:"expr2",type:"string",description:"The system signal name (e.g., 'SIGUSR1' or just 'USR1')."}],returns:{type:"string"}},{name:"$ZSOCKET",type:"function",description:"Returns information about a SOCKET device and its attached sockets",abbreviation:"$ZSOCKET",parameters:[{name:"expr1",type:"any",description:"Specifies the SOCKET device name"},{name:"expr2",type:"string",description:"Specifies a keyword identifying the type of information returned"},{name:"expr3",type:"number",optional:!0,description:"Specifies the index (starting at zero) of a socket attached to the device"},{name:"expr4",type:"string",optional:!0,description:"Specifies an individual delimiter when the second expression specifies DELIMITER."}],returns:{type:"string"}}]},961:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.autoSpaceTab=function(){return i(this,void 0,void 0,(function*(){const e=r.window.activeTextEditor;if(e){const t=e.selection.active,n=e.document.lineAt(t.line).text,i=o.parse(n);(void 0===i[0].lineRoutines||0===i[0].lineRoutines.length)&&-1===n.indexOf(";")&&void 0!==i[0].lineIndentationArray&&i[0].lineIndentationArray.length>0?(i[0].lineIndentationArray.push(" "),e.edit((e=>{" "===n.charAt(t.character-1)?e.insert(t.with(t.line,t.character),". "):e.insert(t.with(t.line,t.character)," . ")}))):e.edit((e=>{e.insert(t,"\t")}))}}))},t.autoSpaceEnter=function(){return i(this,void 0,void 0,(function*(){const e=r.window.activeTextEditor;if(e){const t=e.selection.active,n=e.document.lineAt(t.line).text,i=o.parse(n);let s="";0!==t.character&&((void 0===i[0].lineRoutines||0===i[0].lineRoutines.length)&&-1===n.indexOf(";")&&void 0!==i[0].lineIndentationArray&&i[0].lineIndentationArray.length>0?(i[0].lineIndentationArray.splice(-1),e.edit((e=>{e.replace(new r.Range(t.with(t.line,0),t.with(t.line,n.length)),o.render(i))}))):(void 0===i[0].lineIndentationArray&&(i[0].lineIndentationArray=[]),function(e){const t=e.lineRoutines;if(t)for(let e=0;e<t.length;e++)if(t[e].mRoutine.match(/(d|do)/i)&&!t[e].mArguments)return!0;return!1}(i[0])&&i[0].lineIndentationArray.push(" "),i[0].lineRoutines=[],delete i[0].lineComment,delete i[0].lineLabel,s=o.render(i))),e.edit((e=>{e.insert(t,"\n"+s)}))}}))};const r=n(1398),o=n(1696)},3908:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=!0;const n=i.window.activeTextEditor;if(n){const o=n.document.fileName;!0===e.get(o+"_expandState")?(t=!1,e.update(o+"_expandState",!1)):e.update(o+"_expandState",!0);const s=n.document.getText().split("\n"),a=s.length;if(a){const e=s[a-1].length;for(let e=0;e<a;e++){const n=r.expandCompressLine(s[e],t);""===n.errorText&&(s[e]=n.lineText)}n.edit((t=>{t.replace(new i.Range(0,0,a,e),s.join("\n"))}))}}};const i=n(1398),r=new(n(889).MumpsLineParser)},2548:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398),r=new(n(889).MumpsLineParser),o=n(9896);t.default=class{constructor(e){this._labelsReady=!1,this._dbfile=e,this._refreshLabelDB()}provideCompletionItems(e,t){const n=function(e,t){let n="lineStart",i=0,r="",o="",s=!1;if(e)for(;i<t;){const t=e.substring(i,++i),a=" "===t||"\t"===t,c=t.match(/[A-Za-z%^]/),u=t.match(/[A-Za-z]/);if("string"!==n&&";"===t)return{lineStatus:"comment",startstring:""};switch(c||""!==o&&t.match(/[0-9]/)?o+=t:o="",n){case"argument":a?s?(s=!1,r.match(/[D|DO|G|GOTO|J|JOB]/i)&&(n="jumplabel")):(n="command",r=""):'"'===t?n="string":c?n="variable":"$"===t&&(n="function");break;case"command":if(":"===t)n="argument",s=!0;else{if(u){r+=t;break}if(!a)return n="error",{lineStatus:"error",startstring:""};n="argument",r.match(/[D|DO|G|GOTO|J|JOB]/i)&&(n="jumplabel")}break;case"function":a?s?s=!1:(n="command",r=""):"$"===t?n="jumplabel":c||(n="argument");break;case"jumplabel":a?(n="command",r=""):(":"===t||"("===t)&&(n="argument");break;case"label":a?n="command":"("===t&&(n="variable");break;case"lineStart":n=a?"command":"label";break;case"string":'"'===t&&(n="argument");break;case"variable":a?s?(s=!1,n="argument"):(n="command",r=""):c||(n="argument")}}return{lineStatus:n,startstring:o}}(e.getText(new i.Range(new i.Position(t.line,0),t)),t.character);this._document=e;let r=[];if(this._labelsReady&&"jumplabel"===n.lineStatus){const e=new i.Range(new i.Position(t.line,t.character-n.startstring.length),t);r=this._findLabel(n.startstring,r,e)}return r}_refreshLabelDB(){if(!o.existsSync(this._dbfile)){const e={labels:[{routine:"",label:""}],routines:{}};o.writeFileSync(this._dbfile,JSON.stringify(e))}o.readFile(this._dbfile,((e,t)=>{if(!e){this._labelDB=JSON.parse(t.toString());let e=!1;i.workspace.findFiles("*.m").then((t=>{this._filesToCheck=t.length;for(let n=0;n<t.length;n++){const i=t[n].fsPath;o.stat(i,((t,n)=>{if(t)this._checkReady(e);else{const t=this._labelDB.routines[i];void 0===t||n.mtimeMs>t?(this._labelDB.routines[i]=n.mtimeMs,e=!0,n.size<5e4?this._refreshFileLabels(i):this._checkReady(e)):this._checkReady(e)}}))}this._labelsReady=!0}))}}))}_checkReady(e){0==--this._filesToCheck&&e&&o.writeFile(this._dbfile,JSON.stringify(this._labelDB),(e=>{e&&i.window.showErrorMessage("Error writing Label DB")}))}_refreshFileLabels(e){var t;let n=e.replace(/\\\\/g,"/").split("/").pop();n=null!==(t=null==n?void 0:n.split(".")[0].replace("_","%"))&&void 0!==t?t:"",o.readFile(e,"utf8",((e,t)=>{if(!e){const e=t.split("\n");let i=null;this._labelDB.labels=this._labelDB.labels.filter((e=>e.routine!==n));for(let t=0;t<e.length;t++)n&&(0===t&&this._labelDB.labels.push({label:"*FL",routine:n,line:e[0]}),(i=e[t].match(/^[%A-Za-z0-9][A-Za-z0-9]{0,31}/))&&this._labelDB.labels.push({label:i[0],routine:n,line:e[t]}))}this._checkReady(!0)}))}_findLabel(e,t,n){let i=[];const o=r.getLabels(this._document.getText());let s="";if("^"===e.charAt(0)){const t=e.substring(1);i=this._labelDB.labels.filter((e=>e.routine.startsWith(t)))}else if(-1!==e.indexOf("^")){const t=e.split("^")[0],n=e.split("^")[1];i=this._labelDB.labels.filter((e=>e.label===t&&e.routine.startsWith(n)))}else{for(let t=0;t<o.length;t++)o[t].name.startsWith(e)&&i.push({routine:"",label:o[t].name,line:this._document.lineAt(o[t].line).text});i=i.concat(this._labelDB.labels.filter((t=>t.label.startsWith(e))))}for(let r=0;r<i.length&&r<100;r++){s="100";const o=i[r];let a=""!==o.routine?o.label+"^"+o.routine:o.label;if(a===e)continue;if("*FL"===o.label){if(!e.startsWith("^"))continue;a="^"+o.routine}let c="";"("===o.line.charAt(o.label.length)&&-1!==o.line.indexOf(")")&&(c=o.line.split(")")[0]+")"),-1!==o.line.indexOf(";")&&(c+=o.line.substring(o.line.indexOf(";")+1)),c.length>0&&(s="099"),""===o.routine&&(s="098"),t.push({label:a,detail:c,sortText:s,range:n})}return t}}},7889:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398);t.default=class{resolveDebugConfiguration(e,t){if(!t.type&&!t.request&&!t.name){const e=i.window.activeTextEditor;e&&"mumps"===e.document.languageId&&(t.type="mumps",t.name="Launch",t.request="launch",t.program="${file}",t.stopOnEntry=!0,t.hostname="192.168.0.1",t.localRoutinesPath="y:\\",t.port=9e3)}return t.program?t:i.window.showInformationMessage("Cannot find a program to debug").then((()=>{}))}}},8544:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MumpsConnect=void 0;const r=n(9278),o=n(4434),s=n(9896);var a;!function(e){e[e.disconnected=0]="disconnected",e[e.waitingforStart=1]="waitingforStart",e[e.waitingForVars=2]="waitingForVars",e[e.waitingForBreakpoints=3]="waitingForBreakpoints",e[e.waitingForSingleVar=4]="waitingForSingleVar",e[e.waitingForSingleVarContent=5]="waitingForSingleVarContent",e[e.waitingForErrorReport=6]="waitingForErrorReport",e[e.waitingForHints=7]="waitingForHints"}(a||(a={}));class c extends o.EventEmitter{constructor(){super(),this._socket=new r.Socket,this._event=new o.EventEmitter,this._currentLine=0,this._breakpointId=1,this._logging=!1,this._singleVar="",this._singleVarContent="",this._commandQueue=[],this._connectState=a.disconnected,this._readedData="",this._mVars={},this._mStack=[],this._activeBreakpoints=[],this._breakPoints=[],this._errorLines=[],this._singleVar="",this._singleVarContent="",this._hints=[],this._event.on("varsComplete",(()=>{if(void 0!==this._mVars.I){const e=this._mVars.I;this.checkEvents(e)}}))}init(e,t,n){return i(this,void 0,void 0,(function*(){return this._localRoutinesPath=n,this._hostname=e,this._port=t,new Promise(((e,t)=>{this._socket.connect(this._port,this._hostname,(()=>{this._log("Debug-Server connected\n"),this._connectState=a.waitingforStart,this._socket.on("data",(e=>{this._readedData+=e.toString();let t=this._readedData.indexOf("\n");for(;-1!==t;){const e=this._readedData.substring(0,t);this.processLine(e),this._readedData=this._readedData.substring(t+1),t=this._readedData.indexOf("\n")}})),e(this._socket)})),this._socket.on("error",(e=>{t(e)})),this._socket.on("end",(()=>{this._connectState=a.disconnected}))}))}))}_log(e){this._logging&&console.log(e)}processLine(e){let t,n,i;switch(this._log("Line:  "+e),this._connectState){case a.waitingforStart:if("***STARTVAR"===e){this._connectState=a.waitingForVars,this._mStack=[],this._mVars={};break}if("***STARTBP"===e){this._connectState=a.waitingForBreakpoints,this._activeBreakpoints=[],this._log(e);break}if("***SINGLEVAR"===e){this._connectState=a.waitingForSingleVar,this._singleVar="",this._singleVarContent="";break}if("***ENDPROGRAM"===e){this.sendEvent("end"),this._socket.end();break}if("***BEGINERRCHK"===e){this._connectState=a.waitingForErrorReport,this._errorLines=[];break}if("***STARTHINTS"===e){this._connectState=a.waitingForHints,this._hints=[];break}break;case a.waitingForVars:if("***ENDVAR"===e)this._connectState=a.waitingforStart,this._event.emit("varsComplete");else{for(i=e.substring(0,1),"S"===i&&this._mStack.push(e.substring(2)),t=e.substring(2,e.indexOf("="));(t.split('"').length-1)%2!=0;)t=e.substring(0,e.indexOf("=",t.length+1));n=e.substring(t.length+3).replace(/^"/,"").replace(/"$/,""),void 0===this._mVars[i]&&(this._mVars[i]={}),this._mVars[i][t]=n}break;case a.waitingForBreakpoints:"***ENDBP"===e?(this._log(e),this._connectState=a.waitingforStart,this.verifyBreakpoints()):(this._log(e),this._activeBreakpoints.push(e));break;case a.waitingForSingleVar:"***SINGLEEND"===e?(this._connectState=a.waitingforStart,this._event.emit("SingleVarReceived",this._event,this._singleVar,this._singleVarContent)):"***SINGLEVARCONTENT"===e?this._connectState=a.waitingForSingleVarContent:this._singleVar+=e;break;case a.waitingForSingleVarContent:"***SINGLEEND"===e?(this._connectState=a.waitingforStart,this._event.emit("SingleVarReceived",this._event,this._singleVar,this._singleVarContent)):this._singleVarContent+=e;break;case a.waitingForErrorReport:"***ENDERRCHK"===e?(this._connectState=a.waitingforStart,this._event.emit("ErrorreportReceived",this._event,this._errorLines)):this._errorLines.push(e);break;case a.waitingForHints:"***ENDHINTS"===e?(this._connectState=a.waitingforStart,this._event.emit("HintsReceived",this._event,this._hints)):this._hints.push(e);break;default:console.error("Unexpected Message: "+e)}}writeln(e){if(this._commandQueue.push(e),this._commandQueue.length>1e3)throw console.error("Too many Commands in Queue: Check Debugger Connection"),new Error;if(this._connectState!==a.disconnected)for(;this._commandQueue.length;){e=this._commandQueue.shift();try{this._socket.write(e+"\n")}catch(t){this._commandQueue.unshift(e);break}}}sendBreakpoint(e,t,n,i){void 0===i&&(i=""),n?this.writeln("SETBP;"+e+";"+t+";"+i):this.writeln("CLEARBP;"+e+";"+t)}start(e,t){t&&(e.indexOf("^")?this.sendBreakpoint(e,0,!0,""):this.sendBreakpoint(e,1,!0,"")),this.requestBreakpoints(),this.writeln("START;"+e)}step(e){this.writeln(e)}continue(){this.writeln("CONTINUE")}disconnect(){this.writeln("RESET"),this._socket.end()}requestBreakpoints(){this.writeln("REQUESTBP")}restart(e){this.writeln("RESTART;"+e)}checkEvents(e){const t=e.$ZPOSITION,n=e.$ZSTATUS,i=t.split("^"),r=i[0],o=i[1],s=this._localRoutinesPath+o+".m";this.loadSource(s);const a=r.split("+")[0];let c=0;void 0!==r.split("+")[1]&&(c=parseInt(r.split("+")[1]));let u=0;if(""!==a)for(let e=0;e<this._sourceLines.length;e++)if(this._sourceLines[e].substring(0,a.length)===a){u=e;break}this._currentLine=u+c,""!==n&&e.$ZTRAP===e.$ZSTEP?(this.sendEvent("stopOnException",n),this._log(n)):this._breakPoints.filter((e=>e.file===this._sourceFile&&e.line===this._currentLine)).length>0?this.sendEvent("stopOnBreakpoint"):this.sendEvent("stopOnStep")}stack(e,t){const n=new Array;for(let t=e;t<this._mStack.length;t++){const e=this._mStack[t];if(-1!==e.indexOf("^")){const i=this.convertMumpsPosition(e);n.push({index:t,name:`${e}(${t})`,file:i.file,line:i.line})}}return{frames:n,count:Math.min(n.length,t)}}setBreakPoint(e,t){const n=[];if(t)for(let i=0;i<t.length;i++){const r=t[i],o=r.line;n.push({id:this._breakpointId,verified:!1}),this._breakPoints.push({verified:!1,file:e,line:o,id:this._breakpointId++}),this.sendBreakpoint(e,o,!0,r.condition)}return n}clearBreakPoint(e,t){const n=this._breakPoints;if(n){const i=n.findIndex((n=>n.file===e&&n.line===t));if(i>=0){const t=n[i];return this.sendBreakpoint(e,t.line,!1),n.splice(i,1),t}}}clearBreakpoints(e){this.writeln("CLEARBP;"+e)}verifyBreakpoints(){const e=[];this._breakPoints.forEach((t=>{t.verified=!1;for(let n=0;n<this._activeBreakpoints.length;n++){const i=this.convertMumpsPosition(this._activeBreakpoints[n]);if(i.file=this.normalizeDrive(i.file.replace(/\\/g,"/")),t.file=this.normalizeDrive(t.file.replace(/\\/g,"/")),i.file===t.file&&t.line===i.line){t.verified=!0,this.sendEvent("breakpointValidated",t),e[n]=!0;break}}t.verified||this.sendEvent("breakpointValidated",t)}));for(let t=0;t<this._activeBreakpoints.length;t++)if(!e[t]){const e=this.convertMumpsPosition(this._activeBreakpoints[t]),n={verified:!0,file:e.file,line:e.line,id:this._breakpointId++};this.sendEvent("breakpointValidated",n)}}normalizeDrive(e){const t=e.split(":");return 2===t.length?t[0].toLowerCase()+":"+t[1]:e}getVariables(e){return"system"===e?this._mVars.I:"local"===e?this._mVars.V:void 0}checkRoutine(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>{this._event.on("ErrorreportReceived",(function e(n,i){n.removeListener("ErrorreportReceived",e),t(i)})),this.writeln("ERRCHK");for(let t=0;t<e.length;t++)this.writeln(e[t]);this.writeln("***ENDPROGRAM")}))}))}getSingleVar(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>{const n={name:e,indexCount:0,content:"undefined",bases:[]};let i="V";"$"===e.charAt(0)&&(i="I"),void 0!==this._mVars[i]?void 0!==this._mVars[i][e]?(n.content=this._mVars[i][e],t(n)):(this._event.on("SingleVarReceived",(function e(i,r,o){i.removeListener("SingleVarReceived",e),n.name=r,n.content=o,t(n)})),this.writeln("GETVAR;"+e)):t(n)}))}))}loadSource(e){if(e=e.replace(/%/g,"_"),this._sourceFile!==e){this._sourceFile=e;try{this._sourceLines=(0,s.readFileSync)(this._sourceFile).toString().split("\n")}catch(t){console.log("Could not read Sourcefile "+e)}}}convertMumpsPosition(e){const t=e.split("^"),n=t[0];if(void 0===t[1])return{file:"",line:1};{const e=t[1].split(" ",1)[0],i=(this._localRoutinesPath+e+".m").replace(/%/g,"_");try{const e=(0,s.readFileSync)(i).toString().split("\n"),t=n.split("+")[0],r=new RegExp("^"+t+"[(\\s;]");let o=0;void 0!==n.split("+")[1]&&(o=parseInt(n.split("+")[1]));let a=0;if(""!==t)for(let t=0;t<e.length;t++)if(e[t].match(r)){a=t;break}return{file:i,line:a+o}}catch(e){return console.log("Could not read Sourcefile "+i),{file:i,line:1}}}}sendEvent(e,...t){this.emit(e,...t)}}t.MumpsConnect=c},6025:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(8675),o=n(6928),s=n(1377),a=n(8544),c=n(1398),u=n(9896),p=n(3857),l=c.languages.createDiagnosticCollection("mumps");class h extends r.DebugSession{constructor(){super(),this._variableHandles=new r.Handles,this._variableBases={},this._configurationDone=new s.Subject,this._localScope=this._variableHandles.create("~local|0"),this._systemScope=this._variableHandles.create("~system"),this.setDebuggerLinesStartAt1(!1),this.setDebuggerColumnsStartAt1(!1),this._program="",this._mconnect=new a.MumpsConnect,this._mconnect.on("stopOnEntry",(()=>{this.sendEvent(new r.StoppedEvent("entry",h.THREAD_ID))})),this._mconnect.on("stopOnStep",(()=>{this.sendEvent(new r.StoppedEvent("step",h.THREAD_ID))})),this._mconnect.on("stopOnBreakpoint",(()=>{this.sendEvent(new r.StoppedEvent("breakpoint",h.THREAD_ID))})),this._mconnect.on("stopOnDataBreakpoint",(()=>{this.sendEvent(new r.StoppedEvent("data breakpoint",h.THREAD_ID))})),this._mconnect.on("stopOnException",(()=>{this.sendEvent(new r.StoppedEvent("exception",h.THREAD_ID))})),this._mconnect.on("breakpointValidated",(e=>{this.sendEvent(new r.BreakpointEvent("changed",{verified:e.verified,id:e.id}))})),this._mconnect.on("end",(()=>{this.sendEvent(new r.TerminatedEvent)}))}initializeRequest(e){e.body=e.body||{},e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!0,e.body.supportsDataBreakpoints=!1,e.body.supportsConditionalBreakpoints=!0,e.body.supportsCompletionsRequest=!1,e.body.completionTriggerCharacters=[".","["],e.body.supportsCancelRequest=!1,e.body.supportsBreakpointLocationsRequest=!0,e.body.supportsExceptionInfoRequest=!0,e.body.supportsRestartRequest=!0,this.sendResponse(e),this.sendEvent(new r.InitializedEvent)}configurationDoneRequest(e,t){super.configurationDoneRequest(e,t),this._configurationDone.notify()}launchRequest(e,t){return i(this,void 0,void 0,(function*(){var r=n(1323);r.setBasePort(3e3),r.setHighestPort(3333),this._mdebugPort=yield r.getPortPromise();const o=c.window.createTerminal({name:"Debug",color:new c.ThemeColor("terminal.ansiRed"),iconPath:{id:"bug"},location:1});o.sendText("GTM"),o.sendText("S emptPort="+this._mdebugPort),o.sendText('W "your port is"'),o.sendText("W emptPort"),(yield o).sendText("DO ^MDEBUG"),yield o.processId,this._debugTerminal=o,c.window.showInformationMessage("please wait till Debugging Server is Running"),yield new Promise((e=>{setTimeout((()=>{console.log("Waited 10 seconds"),e()}),7e3)})),c.window.setStatusBarMessage(""),o.hide(),yield this._configurationDone.wait(1e3),this._ipAddress=yield p().then((function(e){return e})),this._mconnect.init(this._ipAddress,this._mdebugPort,t.localRoutinesPath).then((()=>i(this,void 0,void 0,(function*(){var n;this.refreshDiagnostics(null===(n=c.window.activeTextEditor)||void 0===n?void 0:n.document,l),this._mconnect.start(t.program,!!t.stopOnEntry),this._program=t.program,this.sendResponse(e)})))).catch((()=>{c.window.showErrorMessage("Connection to MDEBUG failed. \nPlease start MDEBUG first.")}))}))}setBreakPointsRequest(e,t){const n=t.source.path;this._mconnect.clearBreakpoints(n);const i=this._mconnect.setBreakPoint(n,t.breakpoints);e.body={breakpoints:i},this.sendResponse(e),this._mconnect.requestBreakpoints()}threadsRequest(e){e.body={threads:[new r.Thread(h.THREAD_ID,"thread 1")]},this.sendResponse(e)}stackTraceRequest(e,t){const n="number"==typeof t.startFrame?t.startFrame:0,i=n+("number"==typeof t.levels?t.levels:1e3),o=this._mconnect.stack(n,i);e.body={stackFrames:o.frames.map((e=>new r.StackFrame(e.index,e.name,this.createSource(e.file),this.convertDebuggerLineToClient(e.line)))),totalFrames:o.count},0===o.count&&this.sendEvent(new r.TerminatedEvent),this.sendResponse(e)}scopesRequest(e){e.body={scopes:[new r.Scope("Local",this._localScope,!1),new r.Scope("System",this._systemScope,!1)]},this.sendResponse(e)}variablesRequest(e,t){return i(this,void 0,void 0,(function*(){const n=[];let i;const r=t.variablesReference,o=this._variableHandles.get(t.variablesReference);if(r===this._systemScope){const e=this._mconnect.getVariables("system");for(const t in e)n.push({name:t,type:"string",value:e[t],variablesReference:0})}else{const e=o.split("|"),t=parseInt(e.pop()||"0"),r=e.join("|"),s=this._mconnect.getVariables("local");let a,c="";for(const e in s){const o=this.varAnalyze(e,s[e]);void 0!==a?((i=this._checkVars(a,o,t,r,c))&&(0!==i.variablesReference&&(c=a.bases[t]),n.push(i)),a=o):a=o}if(void 0!==a){const e={name:"",indexCount:0,bases:[],content:""},i=this._checkVars(a,e,t,r,c);i&&n.push(i)}}e.body={variables:n},this.sendResponse(e)}))}_checkVars(e,t,n,i,r){let o,s=0;if(0===n||e.bases[n-1]===i&&e.indexCount>n)if(e.indexCount>n+1){if(r!==e.bases[n]){let t=e.bases[n];n>0&&(t+=")"),void 0===this._variableBases[e.bases[n]]&&(this._variableBases[e.bases[n]]=this._variableHandles.create(e.bases[n]+"|"+(n+1))),o={name:t,type:"string",value:"undefined",variablesReference:this._variableBases[e.bases[n]]}}}else e.bases[n]===t.bases[n]&&(void 0===this._variableBases[e.bases[n]]&&(this._variableBases[e.bases[n]]=this._variableHandles.create(e.bases[n]+"|"+(n+1))),s=this._variableBases[e.bases[n]]),o={name:e.name,type:"string",value:e.content,variablesReference:s};return o}continueRequest(e){this._mconnect.continue(),this.sendResponse(e)}nextRequest(e){this._mconnect.step("OVER"),this.sendResponse(e)}stepInRequest(e){this._mconnect.step("INTO"),this.sendResponse(e)}stepOutRequest(e){this._mconnect.step("OUTOF"),this.sendResponse(e)}evaluateRequest(e,t){return i(this,void 0,void 0,(function*(){"hover"!==t.context&&"repl"!==t.context||this._mconnect.getSingleVar(t.expression).then((n=>{e.body={result:n.name+" := "+n.content,variablesReference:0},t.expression.includes(")")||void 0===this._variableBases[t.expression]||(e.body.variablesReference=this._variableBases[t.expression]),this.sendResponse(e)}))}))}restartRequest(e){return i(this,void 0,void 0,(function*(){const t=(0,u.readFileSync)(this._program).toString().split("\n");this._mconnect.checkRoutine(t).then((e=>{e.length?c.window.showErrorMessage("File contains Problems - No Restart possible!"):this._mconnect.restart(this._program)})),this.sendResponse(e)}))}disconnectRequest(e){this._mconnect.disconnect();let t=c.window.createTerminal({name:"Debug",color:new c.ThemeColor("terminal.ansiRed"),iconPath:{id:"bug"},location:1});t.sendText("fuser -n tcp -k "+this._mdebugPort),this._debugTerminal.dispose(),t.dispose(),this._mconnect.disconnect(),this.sendResponse(e)}createSource(e){return new r.Source((0,o.basename)(e),this.convertDebuggerPathToClient(e),void 0,void 0,"mumps-adapter-data")}exceptionInfoRequest(e){return i(this,void 0,void 0,(function*(){const t=yield this._mconnect.getSingleVar("$ZSTATUS"),n=t.content.split(","),i=n[0].length+n[1].length+n[2].length+4,r=t.content.substr(i);e.body={exceptionId:n[2],description:r,breakMode:"always",details:{message:"Line :"+n[1],typeName:"ErrorException"}},this.sendResponse(e)}))}varAnalyze(e,t){let n=1;const i=[],r=e.length,o=e.indexOf("(");let s=!0;if(o>0){i.push(e.substring(0,o)),n++;for(let t=o;t<r;t++)","===e.substring(t,t+1)&&s&&(i.push(e.substring(0,t)),n++),'"'===e.substring(t,t+1)&&(s=!s);i.push(e.substring(0,e.length-1))}else i.push(e);return{name:e,indexCount:n,bases:i,content:t}}refreshDiagnostics(e,t){const n=[];if(e){const i=e.getText().split("\n");this._mconnect.checkRoutine(i).then((i=>{for(let t=0;t<i.length;t++){const r=i[t].split(";");let o=parseInt(r[0])-1;isNaN(o)&&(o=0);let s=parseInt(r[1])-1;isNaN(s)&&(s=0);let a=e.lineAt(s).text.length;0===s&&0===o&&(a=0);const u=r[2],p=new c.Range(s,o,s,a),l=new c.Diagnostic(p,u,c.DiagnosticSeverity.Error);l.code=u,n.push(l)}t.clear(),t.set(e.uri,n)}))}}}h.THREAD_ID=1,t.default=h},2439:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4491);t.default=class{provideDefinition(e,t){return new i.MumpsTokenHelper(e,t).getTokenRefLocation()}}},8143:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398),r=n(889),o=new r.MumpsLineParser,s=[];t.default=class{constructor(e,t){this._linetokens=[],this._diags=[],this._variablesToBeIgnored=[],this._enableVariableCheck=!0,this._subroutines=[],this._routine={startLine:-1,endLine:-1,parameters:[]},this._level=0,this._lineWithDo=-2,this._isBehindQuit=!1,this._startUnreachable=!1,this._activeSubroutine={name:"",startLine:-1,endLine:-1},this._document=e,this._diags=[],this._linetokens=[];const n=i.workspace.getConfiguration();if(void 0!==n.mumps.variablesToBeIgnoredAtNewCheck&&(this._variablesToBeIgnored=n.mumps.variablesToBeIgnoredAtNewCheck.split(",")),void 0!==n.mumps.enableVariableCheck&&(this._enableVariableCheck=n.mumps.enableVariableCheck),e&&"mumps"===e.languageId){t.clear();for(let t=0;t<e.lineCount;t++){const n=e.lineAt(t),r=o.analyzeLine(n.text);""!==r.error.text&&this._addWarning(r.error.text,t,r.error.position,-1,i.DiagnosticSeverity.Error),this._linetokens.push(r.tokens),this._checkLine(t,r.tokens)}this._activeSubroutine.startLine>-1&&this._addSymbol(this._activeSubroutine.name,this._activeSubroutine.startLine,this._linetokens.length);for(let e=0;e<this._subroutines.length;e++)this.analyzeSubroutine(this._subroutines[e]);this._diags&&t.set(e.uri,this._diags)}}analyzeSubroutine(e){if(this._enableVariableCheck){this._varStates={},this._levelExclusiveNew=[];let t=0;for(let t=0;t<e.parameters.length;t++)this._varStates[e.parameters[t].name]={isParameter:!0,parameterPosition:e.parameters[t].position};for(let n=e.startLine;n<=e.endLine;n++){let i=!1;for(let o=0;o<this._linetokens[n].length;o++){let s=this._linetokens[n][o];if(n===e.startLine&&0===o){for(;++o<this._linetokens[n].length&&this._linetokens[n][o].type===r.TokenType.local;);if(!(o<this._linetokens[n].length))continue;s=this._linetokens[n][o]}if(s.type===r.TokenType.intendation){i=!0;const e=s.name.length;e<t&&this._reduceIntendationLevel(t,e),t=e}else s.type===r.TokenType.comment&&!i&&t>0&&(this._reduceIntendationLevel(t,0),t=0);if(s.type===r.TokenType.keyword){if(!i&&t>0&&(this._reduceIntendationLevel(t,0),t=0),"NEW"===s.longName){let i=!1,a=!1;for(;++o<this._linetokens[n].length&&(this._linetokens[n][o].type===r.TokenType.local||this._linetokens[n][o].type===r.TokenType.sysvariable);)if(i=!0,s=this._linetokens[n][o],s.isExcludedVariable&&(a=!0),s.type===r.TokenType.local){const e=s.name;let i="";const r=this._varStates[e]?this._varStates[e]:{isExcluded:s.isExcludedVariable};r.isParameter?s.isExcludedVariable?r.isExcluded=!0:0===t&&(i="NEW hides formal parameter "+e):r.newedAtLevel?r.newedAtLevel.indexOf(t)>-1?i="Variable "+e+" already mentioned in NEW command":(r.newedAtLevel.push(t),r.newedAtLine.push(n),r.newedAtPostion.push(s.position)):(r.newedAtLevel=[t],r.newedAtLine=[n],r.newedAtPostion=[s.position]),""!==i&&this._addWarning(i,n,s.position,s.name.length),this._varStates[e]=r}if(!1===i&&(a=!0),a&&this._levelExclusiveNew.push(t),e.parameters.length>0&&a&&0===t)for(let t=0;t<e.parameters.length;t++)if(!this._varStates[e.parameters[t].name].isExcluded){this._addWarning("NEW hides formal parameters",n,s.position,s.name.length);break}}}else if(s.type===r.TokenType.local){const e=s.name;this._checkNewed(e,t,n,s.position)}}}this._checkVariableUsage(e)}}_checkVariableUsage(e){for(const t in this._varStates){const n=this._varStates[t];!n.isParameter||n.isUsed||this._isIgnoredVariable(t)?n.newedAtLine&&n.newedAtLine.length>0&&!n.isUsed&&!this._isIgnoredVariable(t)&&this._addWarning("Variable "+t+" is NEWed but not used",n.newedAtLine[0],n.newedAtPostion[0],t.length):this._addWarning("Variable "+t+" is a formal parameter but not used",e.startLine,n.parameterPosition,t.length)}}_checkNewed(e,t,n,i){let r=this._varStates[e];if(!this._isIgnoredVariable(e)){let o=!1;for(let e=0;e<this._levelExclusiveNew.length;e++)this._levelExclusiveNew[e]<=t&&(o=!0);if(!o&&r){if(r.isParameter)o=!0;else if(r.newedAtLevel)for(let e=0;e<r.newedAtLevel.length;e++)if(r.newedAtLevel[e]<=t){o=!0;break}r.isUsed=!0}o||this._addWarning("Variable "+e+" not NEWed",n,i,e.length)}r?r.isUsed=!0:r={isUsed:!0},this._varStates[e]=r}_addWarning(e,t,n,r,o){void 0===o&&(o=i.DiagnosticSeverity.Warning);let s=t,a=n+r;-1===r&&(s=t+1,a=0),this._diags.push({code:"",message:e,range:new i.Range(new i.Position(t,n),new i.Position(s,a)),severity:o,source:""})}_checkLine(e,t){let n=!1,o=!1;0===t.length&&(e===this._lineWithDo+1&&(this._addWarning("Expected intendation level: "+(this._level+1)+", found: 0",e,0,1),this._lineWithDo=-2),this._level=0);for(let s=0;s<t.length;s++){let a=t[s];if(a.type===r.TokenType.comment&&a.name.match(/ignoreVars:/)&&(this._variablesToBeIgnored=this._variablesToBeIgnored.concat(a.name.split("ignoreVars:")[1].split(","))),0===s&&a.type===r.TokenType.label&&(this._activeSubroutine.startLine>-1&&this._addSymbol(this._activeSubroutine.name,this._activeSubroutine.startLine,e),this._activeSubroutine.startLine=e,this._activeSubroutine.name=a.name,this._isBehindQuit=!1,this._startUnreachable&&(this._diags.push({code:"",message:"Unreachable Code",range:new i.Range(this._startUnreachable,new i.Position(e,0)),severity:i.DiagnosticSeverity.Warning,source:""}),this._startUnreachable=!1),void 0!==t[1]&&t[1].type===r.TokenType.local)){for(this._routine.startLine=e;++s<t.length&&t[s].type===r.TokenType.local;)this._routine.parameters.push({name:t[s].name,position:t[s].position});if(s>=t.length)continue;a=t[s]}if(a.type!==r.TokenType.keyword&&a.type!==r.TokenType.comment||!1===o&&(e===this._lineWithDo+1&&(this._addWarning("Expected intendation level: "+(this._level+1)+", found: "+this._level,e,0,a.position),this._lineWithDo=-2),this._level=0),a.type===r.TokenType.keyword){this._isBehindQuit&&!1===this._startUnreachable&&(this._startUnreachable=new i.Position(e,a.position));const o=a.longName;if("IF"!==o&&"ELSE"!==o||(n=!0),"DO"===o&&!1===a.hasArguments&&(this._lineWithDo=e),!(n||"QUIT"!==o&&"GOTO"!==o&&"HALT"!==o||a.isPostconditioned||0!==this._level)){let n=!1;if("GOTO"===o)for(let e=s+1;e<t.length;e++){if(t[e].type===r.TokenType.argPostcondition){n=!0;break}if(t[e].type===r.TokenType.keyword)break}if(!n){this._routine.endLine=e,-1!==this._routine.startLine&&(this._subroutines.push(this._routine),this._routine={startLine:-1,endLine:-1,parameters:[]}),this._isBehindQuit=!0;break}}}if(a.type===r.TokenType.intendation){const t=e===this._lineWithDo+1?this._level+1:this._level;this._level=a.name.length,o=!0,this._level>t&&this._addWarning("Intendation Level wrong, found: "+this._level+", expected: "+t,e,0,a.position),e===this._lineWithDo+1&&this._level<t&&this._addWarning("Higher intendation expected after argumentless Do",e,0,a.position),this._lineWithDo=-2}}}_isIgnoredVariable(e){let t=!1;for(let n=0;n<this._variablesToBeIgnored.length;n++)if(new RegExp("^"+this._variablesToBeIgnored[n]+"$").test(e)){t=!0;break}return t}_reduceIntendationLevel(e,t){var n;for(let n=t+1;n<=e;n++){const e=this._levelExclusiveNew.indexOf(n);e>-1&&this._levelExclusiveNew.splice(e,1)}for(const i in this._varStates){const r=this._varStates[i];let o=!1,s=0,a=0;if(r.newedAtLevel){for(let c=t+1;c<=e;c++){const e=null===(n=r.newedAtLevel)||void 0===n?void 0:n.indexOf(c);e>-1&&(s=r.newedAtLine[e],a=r.newedAtPostion[e],r.newedAtLevel.splice(e,1),r.newedAtLine.splice(e,1),r.newedAtPostion.splice(e,1),o=!0,this._varStates[i]=r)}o&&!r.isUsed&&this._addWarning("Variable "+i+" is NEWed but not used",s,a,i.length)}}}_addSymbol(e,t,n){const r=new i.Position(t,0),o=new i.Position(n,0),a=new i.Location(this._document.uri,new i.Range(r,o));s.push(new i.SymbolInformation(e,i.SymbolKind.Function,"",a))}}},4820:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398),r=new(n(889).MumpsLineParser);t.default=class{provideDocumentSymbols(e){return new Promise((t=>{const n=r.getLabels(e.getText()),o=[];for(let t=0;t<n.length;t++){const r=new i.Position(n[t].line,0);let s=e.lineCount-1;void 0!==n[t+1]&&(s=n[t+1].line);const a=new i.Position(s,0),c=new i.Location(e.uri,new i.Range(r,a));o.push(new i.SymbolInformation(n[t].name,i.SymbolKind.Function,"",c))}t(o)}))}}},1658:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=i.window.activeTextEditor;if(e){const t=e.document;let n=e.selection.start.with(e.selection.start.line,0);for(;n.line<t.lineCount&&""===e.document.lineAt(n.line).text.replace(/\t| /gi,"");)n=n.translate(1,0);for(n.line===t.lineCount&&(n=n.translate(-1,0));n.line>=0;){const t=e.document.lineAt(n.line).text;if(0!==t.length&&" "!==t.charAt(0)&&"\t"!==t.charAt(0)&&";"!==t.charAt(0)){e.edit((e=>{e.insert(n,o(t))}));break}n=n.translate(-1,0)}}};const i=n(1398),r="\t;****************\n";function o(e){let t="",n=[];t+=r,t+="\t; DESCRIPTION: \n";const i=e.match(/\(.*\)/);return null!==i&&i.length>0&&(n=i[0].toString().substring(1,i[0].toString().length-1).split(","),n.length>0&&(t+="\t; PARAMETERS: \n",n.forEach((function(e){t+="\t;    "+e+": \n"})))),t+="\t; RETURNS: \n",t+="\t; REVISIONS: \n",t+=r,t}},2708:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398);t.default=class{provideEvaluatableExpression(e,t){const n=e.lineAt(t.line).text;if(")"===n.charAt(t.character))return this.getExpression(t.line,n.substring(0,t.character));let r=null;const o=/([ (.,+\-*_:=])([\^$]?%?[a-zA-Z][a-zA-Z\d]*)/g;for(;r=o.exec(n);){let e=r.index;e+=r[0].length-r[2].length;const n=e+r[2].length-1;if(e<=t.character&&n>=t.character)return new i.EvaluatableExpression(new i.Range(t.line,e,t.line,n),r[2])}}getExpression(e,t){let n=!1;for(let e=0;e<t.length;e++)'"'===t.charAt(e)&&(n=!n);if(n)return;let r=1,o=0;for(let e=t.length-1;e>-1;e--){const i=t.charAt(e);if('"'===i&&(n=!n),"("===i&&!n&&(r--,0===r)){o=e;break}")"!==i||n||r++}if(0===r){const n=/([ (,+\-*_:=])([\^$]?%?[a-zA-Z][a-zA-Z\d]*)$/,r=t.substring(0,o).match(n);if(r)return new i.EvaluatableExpression(new i.Range(e,o-r[2].length,e,t.length+1))}}}},4681:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398);function r(e,t,n){if(0===e.replace(/( |\t)/gi,"").length&&n.push(i.TextEdit.insert(new i.Position(t,0),"\t;")),(e.endsWith(". ")||e.endsWith("."))&&n.push(i.TextEdit.insert(new i.Position(t,e.length),";")),e.startsWith(" ")){let r;for(r=0;r<e.length&&" "===e.charAt(r);r++);n.push(i.TextEdit.replace(new i.Range(new i.Position(t,0),new i.Position(t,r)),"\t"))}if(e.match(/^([A-Za-z%][A-Za-z0-9]*(\([A-Za-z%][A-Za-z0-9]*(,[A-Za-z%][A-Za-z0-9]*)*\))?)?[\t ]+\./)){let r=". ";const o=e.indexOf(".");let s=1,a=0,c="";do{c=e.charAt(s+a+o)," "===c?a++:"."===c&&(s++,r+=". ")}while("."===c||" "===c);s!==a&&n.push(i.TextEdit.replace(new i.Range(new i.Position(t,o),new i.Position(t,o+s+a)),r))}}t.default=class{provideDocumentFormattingEdits(e){const t=[];for(let n=0;n<e.lineCount;n++)r(e.lineAt(n).text,n,t);return t}provideDocumentRangeFormattingEdits(e,t){const n=[];for(let i=t.start.line;i<=t.end.line;i++)r(e.lineAt(i).text,i,n);return n}}},5309:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokens=t.MumpsHighlighter=void 0;const i=n(1398),r=n(889),o=Object.keys(r.TokenType).map((e=>r.TokenType[e])),s=new i.SemanticTokensLegend(o,["standard"]);t.SemanticTokens=s;const a=new r.MumpsLineParser,c={provideDocumentSemanticTokens(e){const t=e.getText(),n=a.analyzeLines(t),o=new i.SemanticTokensBuilder(s);for(let e=0;e<n.length;e++){const t=n[e];for(let n=0;n<t.length;n++){const s=t[n],a=s.type;a===r.TokenType.exfunction&&(s.position-=2,s.name="$$"+s.name),s.position<0&&console.log(t),o.push(new i.Range(new i.Position(e,s.position),new i.Position(e,s.position+s.name.length)),r.TokenType[a],["standard"])}}return o.build()}};t.MumpsHighlighter=c},1653:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4491);t.default=class{provideHover(e,t){return new i.MumpsTokenHelper(e,t).getTokenHoverInfo()}}},889:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MumpsLineParser=t.isv=t.ifunction=t.TokenType=void 0;const i=n(9896);var r;!function(e){e[e.global=0]="global",e[e.local=1]="local",e[e.exfunction=2]="exfunction",e[e.nonMfunction=3]="nonMfunction",e[e.entryref=4]="entryref",e[e.operator=5]="operator",e[e.keyword=6]="keyword",e[e.ifunction=7]="ifunction",e[e.label=8]="label",e[e.comment=9]="comment",e[e.sysvariable=10]="sysvariable",e[e.string=11]="string",e[e.number=12]="number",e[e.intendation=13]="intendation",e[e.argPostcondition=14]="argPostcondition"}(r||(t.TokenType=r={}));const o=/^[A-Za-z%][A-Za-z0-9]*(\([A-Za-z%][A-Za-z0-9]*(,[A-Za-z%][A-Za-z0-9]*)*\))?/,s=/^[A-Za-z%][A-Za-z0-9]*/,a=/^\^[A-Za-z%][A-Za-z0-9]*/,c=/^\$(DEVICE|ECODE|EC|ESTACK|ES|ETRAP|ET|HALT|HOROLOG|H|IO|I|JOB|J|KEY|K|NAMESPACE|PRINCIPAL|P|QUIT|Q|REFERENCE|R|STACK|ST|STORAGE|S|SYSTEM|TEST|THIS|TLEVEL|TL|T|USERNAME|X|Y|ZALLOCSTOR|ZA|ZB|ZCHSET|ZCLOSE|ZCMDLINE|ZCM|ZCOMPILE|ZCO|ZCSTATUS|ZCH[A-Z]*|ZC|ZDATEFORM|ZDA|ZDIRECTORY|ZD|ZEDITOR|ZED|ZEOF|ZEO|ZE[A-Z]*|ZGBLDIR|ZG|ZHRORLOG|ZH|ZININTERRUPT|ZINI|ZINTERRUPT|ZINT|ZIO|ZJOB|ZJ|ZKEY|ZLEVEL|ZL|ZMAXTPTIME|ZMAXTPTI|ZMODE|ZMO|ZONLNRLBK|ZPATNUMERIC|ZPATN|ZPIN|ZPOSITION|ZPOS|ZPOUT|ZPROMPT|ZQUIT|ZREALSTOR|ZRELDATE|ZRO[A-Z]*|ZSOURCE|ZSO|ZSTA[A-Z]*|ZSTEP|ZSTRP|ZSTRPLLIM|ZST|ZSYSTEM|ZSY|ZS|ZTEXIT|ZTE|ZTIMEOUT|ZTIM|ZTRAP|ZT|ZUSEDSTOR|ZUT|ZVERSION|ZV[A-Z]*|ZYERROR|ZYRELEASE|ZTDATA|ZTDELIM|ZTLEVEL|ZTNAME|ZTOLDVAL|ZTRIGGEROP|ZTSLATE|ZTUPDATE|ZTVALUE|ZTWORMHOLE)/i;t.isv=c;const u=/^\$(ASCII|A|CHAR|C|DATA|D|EXTRACT|E|FIND|F|FNUMBER|FN|GET|G|INCREMENT|INCR|I|JUSTIFY|J|LENGTH|L|NAME|NA|NEXT|N|ORDER|O|PIECE|P|QLENGTH|QL|QSUBSCRIPT|QS|QUERY|Q|RANDOM|R|REVERSE|RE|SELECT|S|STACK|ST|TEXT|T|TRANSLATE|TR|VIEW|V|ZAHANDLE|ZAH|ZASCII|ZATRANSFORM|ZAT|ZBITAND|ZBITCOUNT|ZBITFIND|ZBITGET|ZBITLEN|ZBITNOT|ZBITOR|ZBITSET|ZBITSTR|ZBITXOR|ZCHAR|ZCH|ZCOLLATE|ZCONVERT|ZCO|ZDATE|ZDATA|ZD|ZEXTRACT|ZE|ZFIND|ZF|ZGETJPI|ZG|ZINCREMENT|ZINCR|ZJOBEXAM|ZJUSTIFY|ZJ|ZLENGTH|ZL|ZMESSAGE|ZPARSE|ZPEEK|ZPIECE|ZPI|ZPREVIOUS|ZP|ZQGBLMOD|ZSEARCH|ZSIGPROC|ZSOCKET|ZSUBSTR|ZSUB|ZSYSLOG|ZTRANSLATE|ZTRIGGER|ZTRI|ZTRNLNM|ZTR|ZWIDTH|ZWRITE|ZW)(?=\()/i;t.ifunction=u;const p=/^\$&([A-Za-z%0-9][A-Za-z0-9]*\.)?([A-Za-z%0-9][A-Za-z0-9]*)(\^[A-Za-z%][A-Za-z0-9]*)?/,l=/^(&[A-Za-z0-9]*\.?)?@?([A-Za-z%0-9][A-Za-z0-9]*)?(\^@?[A-Za-z%][A-Za-z0-9]*)?/,h=/^\^@?[A-Za-z%][A-Za-z0-9]*/,d=/^(\d*\.?\d*(E-?\d+)?)/,f=/^"(""|[^"])*"/,m=/^[B|BREAK|C|CLOSE|D|DO|E|ELSE|F|FOR|G|GOTO|H|HALT|HANG|I|IF|J|JOB|K|KILL|L|LOCK|M|MERGE|N|NEW|O|OPEN|Q|QUIT|R|READ|S|SET|U|USE|V|VIEW|W|WRITE|X|XECUTE|ZA|ZALLOCATE|ZBR|ZBREAK|ZC|ZCONTINUE|ZD|ZDEALLOCATE|ZE|ZEDIT|ZG|ZGOTO|ZHALT|ZH|ZHELP|ZK|ZKILL|ZL|ZLINK|ZM|ZMESSAGE|ZP|ZPRINT|ZRUPDATE|ZSH|ZSHOW|ZST|ZSTEP|ZSY|ZSYSTEM|ZTC|ZTCOMMIT|ZTR|ZTRIGGER|ZTS|ZTSTART|ZWI|ZWITHDRAW|ZWR|ZWRITE]/i,g=/^('=|'>|'<|<=|>=|'&|'!|'\?|'\[|'\]|\*\*|\+|-|\*|\/|\\|#|'|&|!|_|<|>|=|\[|\]\]|\]|\?|@)/,b=/(-|'|\+|@)/,v=/^([A|C|E|L|N|P|U]|^("([^"]("")*)*"))+/i,y=/^\d*\.?\d*/,E=/^APPEND|ATTACH=|BLOCK(SIZE)?=|COMMAND=|CONNECT=|(NO)?DELIM(ITER)?=?|EXC(EPTION)?=|FIFO|(NO)?FIXED|GROUP=|[IO]?CHSET=|KEY|IKEY|INDEPENDANT|IOERROR=|NEW[A-Z]*|MOREREADTIME=|OKEY|OWNER=|(NO)?RCHK|(NO)?READ(ONLY)?|RECORD(SIZE)?=|(NO)?RETRY|REWIND|SEEK=|SHELL=|STDERR=|(NO)?STREAM|SYSTEM=|(NO)?TRUNCATE|UIC=|VARIABLE|WORLD=|Z?(NO)?WRAP|WRITE(ONLY)?|ZBFSIZE=|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE=|Z?LISTEN=/i,T=/^ATTACH|(NO)?CENABLE|[IO]?CHSET=|CLEAR(SCREEN)?|CONNECT|(NO)?CONVERT|CTRAP=|(NO)?DELIM(ITER)?=?|DETACH|DOWNSCROLL|(NO)?ECHO|(NO)?EDITING|ERASELINE|(NO)?ESC(APE)?|EXC(EPTION)?=|(NO)?FILTER=?|FLUSH|GROUP=|KEY|IKEY|IOERROR=|OKEY|OWNER=|(NO)?PASTHRU|(NO)?RCHK|(NO)?RETRY|REWIND|SEEK=|SKIPFILE=|SOCKET=|SPACE=|TERM(INATOR)?=|(NO)?TRUNCATE|(NO)?TTSNYC|(NO)?TYPEAHEAD|UPSCROLL|Z?LENGTH=|Z?WIDTH=|Z?(NO)?WRAP|WRITELB=|X=|Y=|ZBFSIZE|Z(NO)?DELAY|Z(NO)?FF|ZIBFSIZE|LISTEN=/i,R=/^DELETE|(NO)?DESTROY|EXCEPTION=|GROUP=|OWNER=|RENAME=|SOCKET=|TIMEOUT=|UIC=|WORLD=/i,_=/^CMD=|CMDLINE=|DEF=|DEFAULT=|ERR=|ERROR=|GBL=|GBLDIR=|IN=|INPUT=|OUT=|OUTPUT=|PASS|PASSCURLVN|STA=|STARTUP=/i,x=/^SERIAL|S|T=|TRANSACTIONID=/i,S={B:"BREAK",C:"CLOSE",D:"DO",E:"ELSE",F:"FOR",G:"GOTO",H:"HALT",I:"IF",J:"JOB",K:"KILL",L:"LOCK",M:"MERGE",N:"NEW",O:"OPEN",Q:"QUIT",R:"READ",S:"SET",U:"USE",V:"VIEW",W:"WRITE",X:"XECUTE",ZA:"ZALLOCATE",ZB:"ZBREAK",ZC:"ZCONTINUE",ZD:"ZDEALLOCATE",ZED:"ZEDIT",ZG:"ZGOTO",ZH:"ZHELP",ZK:"ZKILL",ZL:"ZLINK",ZM:"ZMESSAGE",ZP:"ZPRINT",ZSH:"ZSHOW",ZST:"ZSTEP",ZSY:"ZSYSTEM",ZTC:"ZTCOMMIT",ZTR:"ZTRIGGER",ZTS:"ZTSTART",ZWI:"ZWITHDRAW",ZWR:"ZWRITE"},A={A:"ASCII",C:"CHAR",D:"DATA",E:"EXTRACT",F:"FIND",FN:"FNUMBER",G:"GET",I:"INCREMENT",J:"JUSTIFY",L:"LENGTH",NA:"NAME",N:"NEXT",O:"ORDER",P:"PIECE",QL:"QLENGTH",QS:"QSUBSCRIPT",Q:"QUERY",R:"RANDOM",RE:"REVERSE",S:"SELECT",ST:"STACK",T:"TEXT",TR:"TRANSLATE",V:"VIEW",ZA:"ZASCII",ZAH:"ZAHANDLE",ZCO:"ZCONVERT",ZD:"ZDATE",ZE:"ZEXTRACT",ZF:"ZFIND",ZG:"ZGETJPI",ZJ:"ZJUSTIFY",ZL:"ZLENGTH",ZM:"ZMESSAGE",ZPI:"ZPIECE",ZP:"ZPREVIOUS",ZSUB:"ZSUBSTR",ZTR:"ZTRANSLATE",ZTRI:"ZTRIGGER",ZW:"ZWIDTH"},w={D:"DEVICE",EC:"ECODE",ES:"ESTACK",ET:"ETRAP",H:"HOROLOG",I:"IO",J:"JOB",K:"KEY",P:"PRINCIPAL",Q:"QUIT",R:"REFERENCE",ST:"STACK",S:"STORAGE",SY:"SYSTEM",T:"TEST",TL:"TLEVEL",TR:"TRESTART",ZC:"ZCSTATUS",ZDA:"ZDATEFORM",ZD:"ZDIRECTORY",ZED:"ZEDITOR",ZEO:"ZEOF",ZE:"ZERROR",ZG:"ZGBLDIR",ZH:"ZHRORLOG",ZINI:"ZININTERRUPT",ZINT:"ZINTERRUPT",ZJ:"ZJOB",ZL:"ZLEVEL",ZMAXPTI:"ZMAXTPTIME",ZMO:"ZMODE",ZPOS:"ZPOSITION",ZPROM:"ZPROMPT",ZRO:"ZROUTINES",ZSO:"ZSOURCE",ZS:"ZSTATUS",ZST:"ZSTEP",ZSTRP:"ZSTRPLLIM",ZSY:"ZSYSTEM",ZTE:"ZTEXIT",ZTIM:"ZTIMEOUT",ZT:"ZTRAP",ZV:"ZVERSION",ZYER:"ZYERROR",ZYRE:"ZYRELEASE",ZTDE:"ZTDELIM"},k={BREAK:{abbreviation:"B",postcondition:!0,parameter:"[expr[:tvexpr][,...]]"},CLOSE:{abbreviation:"C",postcondition:!0,parameter:"expr[:(keyword[=expr][:...])][,...]"},DO:{abbreviation:"D",postcondition:!0,parameter:"[entryref[(expr:.lvn[,...])][:tvexpr][,...]]"},ELSE:{abbreviation:"E",postcondition:!1,parameter:""},FOR:{abbreviation:"F",postcondition:!1,parameter:"[lvn=expr[:numexpr1[:numexpr2]][,...]]]"},GOTO:{abbreviation:"G",postcondition:!0,parameter:"entryref[:tvexpr][,...]"},HALT:{abbreviation:"H",postcondition:!0,parameter:""},HANG:{abbreviation:"H",postcondition:!0,parameter:"numexpr[,...]"},IF:{abbreviation:"I",postcondition:!1,parameter:"[tvexpr[,...]]"},JOB:{abbreviation:"J",postcondition:!0,parameter:"entryref[(expr[,...])][:[(keyword[=value][:...])][:numexpr]][,...]"},KILL:{abbreviation:"K",postcondition:!0,parameter:"[glvn | (lvn[,...]) | *lname | *lvn ]"},LOCK:{abbreviation:"L",postcondition:!0,parameter:"[[-|+]nref|(nref[,...])[:numexpr] [,...]]"},MERGE:{abbreviation:"M",postcondition:!0,parameter:"glvn=glvn[,...]"},NEW:{abbreviation:"N",postcondition:!0,parameter:"[[(]lvn[,...][)][,...]]"},OPEN:{abbreviation:"O",postcondition:!0,parameter:"expr[:[(keyword[=expr][:...])] [:numexpr]][,...]"},QUIT:{abbreviation:"Q",postcondition:!0,parameter:"[expr | *lname | *lvn]"},READ:{abbreviation:"R",postcondition:!0,parameter:"(glvn|*glvn|glvn#intexpr)[:numexpr]|strlit|fcc[,...]"},SET:{abbreviation:"S",postcondition:!0,parameter:"setleft=expr | (setleft[,...])=expr | *lvn=lname | aliascontainer[,...]"},TCOMMIT:{abbreviation:"TC",postcondition:!0,parameter:""},TRESTART:{abbreviation:"TRE",postcondition:!0,parameter:""},TROLLBACK:{abbreviation:"TRO",postcondition:!0,parameter:"[intexpr]"},TSTART:{abbreviation:"TS",postcondition:!0,parameter:"[([lvn...])|lvn|*|][:keyword|(keyword...)]"},USE:{abbreviation:"U",postcondition:!0,parameter:"expr[:(keyword[=expr][:...])][,...]"},VIEW:{abbreviation:"V",postcondition:!0,parameter:"keyword[:expr[:...]][,...]"},WRITE:{abbreviation:"W",postcondition:!0,parameter:"expr|*intexpr|fcc[,...]"},XECUTE:{abbreviation:"X",postcondition:!0,parameter:"expr[:tvexpr][,...]"},ZALLOCATE:{abbreviation:"ZA",postcondition:!0,parameter:"[(]nref[,...][)][:intexpr][,...]"},ZBREAK:{abbreviation:"ZB",postcondition:!0,parameter:"[-]entryref[:[expr][:intexpr]][,...]"},ZCOMPILE:{abbreviation:"ZCOM",postcondition:!0,parameter:"expr[,...]"},ZCONTINUE:{abbreviation:"ZC",postcondition:!0,parameter:""},ZDEALLOCATE:{abbreviation:"ZD",postcondition:!0,parameter:"[nref[,...]]"},ZEDIT:{abbreviation:"ZED",postcondition:!0,parameter:"[expr[,...]]"},ZGOTO:{abbreviation:"ZG",postcondition:!0,parameter:"[[intexpr][:entryref[:tvexpr]],...]"},ZHALT:{abbreviation:"ZHALT",postcondition:!0,parameter:"[intexpr]"},ZHELP:{abbreviation:"ZH",postcondition:!0,parameter:"[expr1[:expr2],...]"},ZKILL:{abbreviation:"ZK",postcondition:!0,parameter:"glvn"},ZLINK:{abbreviation:"ZL",postcondition:!0,parameter:"[expr1[:expr2][,...]]"},ZMESSAGE:{abbreviation:"ZM",postcondition:!0,parameter:"intexpr[:expr2][:...]"},ZPRINT:{abbreviation:"ZP",postcondition:!0,parameter:"[entryref[:label[+intexpr]][,...]"},ZRUPDATE:{abbreviation:"ZRUP",postcondition:!0,parameter:"expr[,...]"},ZSHOW:{abbreviation:"ZSH",postcondition:!0,parameter:"[expr[:glvn][,...]]"},ZSTEP:{abbreviation:"ZST",postcondition:!0,parameter:"[keyword[:expr]][,...]"},ZSYSTEM:{abbreviation:"ZSY",postcondition:!0,parameter:"[expr][,...]]"},ZTCOMMIT:{abbreviation:"ZTC",postcondition:!0,parameter:"[intexpr]"},ZTRIGGER:{abbreviation:"ZTR",postcondition:!0,parameter:"gvn"},ZTSTART:{abbreviation:"ZTS",postcondition:!0,parameter:""},ZWITHDRAW:{abbreviation:"ZWI",postcondition:!0,parameter:"glvn"},ZWRITE:{abbreviation:"ZWR",postcondition:!0,parameter:"[zwrglvn[,...]]"}},C={ASCII:{maxparams:2},CHAR:{maxparams:99},DATA:{maxparams:1,format:"glvn"},EXTRACT:{maxparams:3},FIND:{maxparams:3},FNUMBER:{minparams:2,maxparams:3},GET:{maxparams:2,format:"glvn,expr"},INCREMENT:{maxparams:2,format:"glvn,expr"},JUSTIFY:{maxparams:3},LENGTH:{maxparams:2},NAME:{maxparams:2,format:"glvn,expr"},NEXT:{maxparams:1,format:"glvn("},ORDER:{maxparams:2,format:"glvn,expr"},PIECE:{maxparams:4},QLENGTH:{maxparams:1,format:"expr"},QSUBSCRIPT:{maxparams:2,format:"expr,expr"},QUERY:{maxparams:1,format:"glvn"},RANDOM:{maxparams:1},REVERSE:{maxparams:1},SELECT:{maxparams:99,format:"special"},STACK:{maxparams:2},TEXT:{maxparams:1,format:"entryref"},TRANSLATE:{maxparams:3},VIEW:{maxparams:2},ZASCII:{maxparams:2},ZATRANSFORM:{minparams:2,maxparams:4,format:"expr,expr,bool,bool"},ZBITAND:{minparams:2,maxparams:2},ZBITCOUNT:{maxparams:1},ZBITFIND:{maxparams:3},ZBITGET:{minparams:2,maxparams:2},ZBITLEN:{maxparams:1},ZBITNOT:{maxparams:1},ZBITOR:{minparams:2,maxparams:2},ZBITSET:{minparams:3,maxparams:3},ZBITSTR:{maxparams:2},ZBITXOR:{minparams:2,maxparams:2},ZCHAR:{maxparams:99},ZCOLLATE:{maxparams:3,format:"glvn,expr,bool"},ZCONVERT:{maxparams:3},ZDATA:{maxparams:1,format:"lvn"},ZDATE:{maxparams:4},ZEXTRACT:{maxparams:3},ZFIND:{maxparams:3},ZGETJPI:{minparams:2,maxparams:2},ZJOBEXAM:{minparams:0,maxparams:1},ZJUSTIFY:{minparams:2,maxparams:3},ZLENGTH:{maxparams:2},ZMESSAGE:{maxparams:1},ZPARSE:{maxparams:5},ZPEEK:{maxparams:4},ZPIECE:{maxparams:4},ZPREVIOUS:{maxparams:1,format:"glvn"},ZQGBLMOD:{maxparams:1,format:"gvn"},ZSEARCH:{maxparams:2},ZSIGPROC:{maxparams:2},ZSOCKET:{minparams:2,maxparams:4},ZSUBSTR:{minparams:2,maxparams:3},ZSYSLOG:{maxparams:1},ZTRANSLATE:{maxparams:3},ZTRIGGER:{maxparams:2},ZTRNLNM:{maxparams:6},ZWIDTH:{maxparams:1},ZWRITE:{maxparams:2}};t.MumpsLineParser=class{constructor(){this._tokens=[],this.linePosition=0}checkFile(e){const t=[];let n;try{n=i.readFileSync(e,"utf8")}catch(n){return t.push({text:"File read error: "+e,position:0,line:0}),t}const r=n.split("\n");for(let e=0;e<r.length;e++){r[e]=r[e].replace(/\r/g,"");const n=this.checkLine(r[e]);""!==n.text&&(n.line=e+1,t.push(n))}return t}checkLine(e){this._tokens=[],this.linePosition=0;const t=this._parseLine(e);if(t.lineLabel&&this._splitLabelAndParameters(t.lineLabel),t.lineIndentationArray){let e=0;t.lineLeadSpace&&(e+=t.lineLeadSpace.length),t.lineLabel&&(e+=t.lineLabel.length),this._tokens.push({name:".".repeat(t.lineIndentationArray.length),type:r.intendation,position:e})}t.lineComment&&this._tokens.push({name:t.lineComment.comment,position:t.lineComment.position,type:r.comment});let n={text:"",position:0};if(t.lineRoutines)for(let i=0;i<t.lineRoutines.length;i++){const o=t.lineRoutines[i];if(o.mCommand.length>0){let t=o.mCommand.toUpperCase();if("H"===t&&(t=""===o.mArguments?"HALT":"HANG"),!t.match(m))return{text:"Invalid Command",position:o.cmdPosition};{let i=t;if(void 0===k[t]&&(i=S[t]),this._tokens.push({name:o.mCommand,type:r.keyword,position:o.cmdPosition,longName:i,isPostconditioned:""!==o.mPostCondition,hasArguments:""!==o.mArguments}),void 0===i)return n.text="Unknown Command",n.position=o.cmdPosition,n;try{n=this._checkCommand(e,i,o)}catch(n){return n}}}}return n}analyzeLine(e){return this._tokens=[],e=e.replace(/\r/g,""),{error:this.checkLine(e),tokens:this._tokens}}analyzeLines(e){const t=e.split("\n"),n=[];for(let e=0;e<t.length;e++)t[e]=t[e].replace(/\r/g,""),this.checkLine(t[e]),n[e]=this._tokens;return n}expandCompressFile(e,t){let n;void 0===t&&(t=!1);let r=[];try{n=i.readFileSync(e,"utf8")}catch(e){return r[0]="File read error: ",r[0]}r=n.split("\n");for(let e=0;e<r.length;e++){const n=this.expandCompressLine(r[e],t);if(""!==n.errorText){r=[],r[0]="Error in Line "+e+" : "+n.errorText;break}r[e]=n.lineText}return r.join("\n")}expandCompressLine(e,t){e=e.replace(/\r/g,""),!1===t&&void 0===this.cmdCompressions&&(this.cmdCompressions={},Object.keys(S).forEach((e=>{this.cmdCompressions[S[e]]=e})),this.funcCompressions={},Object.keys(A).forEach((e=>{this.funcCompressions[A[e]]=e})),this.isvCompressions={},Object.keys(w).forEach((e=>{this.isvCompressions[w[e]]=e})));const n={lineText:e,errorText:""},i=this.checkLine(e);let o=e;if(""!==i.text)n.errorText=i.text;else{let e=0;for(let n=0;n<this._tokens.length;n++){const i=this._tokens[n];if(i.hasOwnProperty("longName")){const n=i.name;let s=n;const a=i.position;if(t)s=i.longName.toLowerCase(),s="$"===s[0]?"$"+s[1].toUpperCase()+s.substring(2):s[0].toUpperCase()+s.substring(1);else{let e=n.toUpperCase();"$"===n[0]&&(e=n.substring(1)),i.type===r.keyword?void 0!==this.cmdCompressions[e]&&(s=this.cmdCompressions[e]):i.type===r.ifunction?void 0!==this.funcCompressions[e]&&(s="$"+this.funcCompressions[e]):i.type===r.sysvariable&&void 0!==this.isvCompressions[e]&&(s="$"+this.isvCompressions[e])}n.length!==s.length&&(o=o.substring(0,e+a)+s+o.substring(e+a+n.length),e+=s.length-n.length)}}}return n.lineText=o,n}getLabels(e){const t=[],n=e.split("\n");for(let e=0;e<n.length;e++){const i=this._parseLine(n[e]);i.lineLabel&&t.push({name:i.lineLabel,line:e})}return t}getTokenAt(e,t){this.checkLine(e);let n=0,i=-1;for(let e=0;e<this._tokens.length;e++){const r=this._tokens[e];r.position>=n&&r.position<t&&(n=r.position,i=e)}if(-1!==i)return this._tokens[i]}_checkEntryRefAndPostcondition(e,t,n){let i={text:"",position:t};return i=this._checkEntryRef(e,i.position,n),":"===e[i.position]&&(this._tokens.push({type:r.argPostcondition,name:":",position:t}),i=this._evaluateExpression(0,e,++i.position)),i}_checkEntryRef(e,t,n,i){void 0===i&&(i=!1);let o=r.entryref;i&&(o=r.exfunction);let s={text:"",position:t};if("@"===e[s.position]){if(s=this._evaluateExpression(4,e,++s.position),"+"===e[s.position]&&(s=this._evaluateExpression(0,e,++s.position)),"^"===e[s.position])if("@"===e[s.position+1])s=this._evaluateExpression(4,e,++s.position);else{if(!e.substring(s.position).match(l))throw s.text="Invalid EntryRef",s;{const t=e.substring(s.position).match(l)[0];s.position+=t.length}}"@("===e.substring(s.position,s.position+2)&&s.position++}else{if(!e.substring(s.position).match(l))throw s.text="Invalid Entryref",s;{let t=e.substring(s.position).match(l)[0];const n=s.position;s.position+=t.length;const i=e[s.position];if(s.position>=e.length){if(t.length>0)return"&"===t[0]&&(o=r.nonMfunction),this._tokens.push({type:o,name:t,position:n+this.linePosition}),s;throw s.text="Missing Entryref",s}if(-1===t.indexOf("^")&&"+"===i){if(s=this._evaluateExpression(0,e,++s.position),s.position>=e.length)return this._tokens.push({type:o,name:t,position:n+this.linePosition}),s;if(e.substring(s.position).match(h)){const n=e.substring(s.position).match(h)[0];t+=n,s.position+=n.length}}this._tokens.push({type:o,name:t,position:n+this.linePosition})}}return"("===e[s.position]&&n&&(s=this._evaluateExpression(2,e,++s.position,1)),s}_checkVar(e,t,n,i,o){let c={text:"",position:t,indexFound:!1,globalFound:!1,indirectionFound:!1},u=!1;if(void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===o&&(o=!1),"@"===e[c.position])c=this._evaluateExpression(4,e,++c.position),c.indirectionFound=!0,u=!0,"@("===e.substring(c.position,c.position+2)&&c.position++;else if(e.substring(c.position).match(a)||"^|"===e.substring(c.position,c.position+2)){if(!n)throw c.text="Global not allowed here",c;if(c.globalFound=!0,"^|"===e.substring(c.position,c.position+2)){if(c.position+=2,c=this._evaluateExpression(0,e,c.position),c.globalFound=!0,","===e[c.position]&&(c=this._evaluateExpression(0,e,++c.position),c.globalFound=!0),"|"!==e[c.position])throw c.text='Missing "|"',c;if(c.position++,e.substring(c.position).match(s)){const t=e.substring(c.position).match(s)[0];this._tokens.push({name:t,type:r.global,position:c.position+this.linePosition}),u=!0,c.position+=t.length}}else{const t=e.substring(c.position).match(a)[0];this._tokens.push({name:t,type:r.global,position:c.position+this.linePosition}),u=!0,c.position+=t.length}}else if(e.substring(c.position).match(s)){const t=e.substring(c.position).match(s)[0];this._tokens.push({name:t,type:r.local,position:c.position+this.linePosition,isExcludedVariable:o}),u=!0,c.position+=t.length}else if("^("===e.substring(c.position,c.position+2)){if(c.globalFound=!0,!n)throw c.text="Global not allowed here",u=!1,c;u=!0,c.position++}if(u&&"("===e[c.position]){if(!i)throw c.text="Index not allowed here",c;const t=this._evaluateExpression(1,e,++c.position,1);c.position=t.position,c.indexFound=!0}if(!u)throw c.text="Name missing",c;return c}_checkBreak(e,t){let n=this._evaluateExpression(0,e,t);return":"===e[n.position]&&(n=this._evaluateExpression(0,e,++n.position)),n}_checkKeyword(e,t,n){let i={text:"",position:n};if(!t.substring(i.position).match(e))throw i.text="No valid Keyword for command found",i;{const n=t.substring(i.position).match(e)[0];i.position+=n.length,"="===n.slice(-1)&&(i=this._evaluateExpression(0,t,i.position))}return i}_checkOUC(e,t,n){let i={text:"",position:n};if(i=this._evaluateExpression(0,t,i.position),":"===t[i.position])if(i.position++,"("===t[i.position]){i.position++;let n=!1;do{if(i=this._checkKeyword(e,t,i.position),n=!0,")"===t[i.position]){i.position++;break}if(":"!==t[i.position])throw i.text="Unecpected Character",i;i.position++,n=!1}while(!this._isEndOfArgument(t,i.position));if(!n)throw i.text='Missing ")" or Keyword',i}else":"!==t[i.position]&&(i=this._checkKeyword(e,t,i.position));return e===E&&":"===t[i.position]&&(i.position++,":"!==t[i.position]&&(i=this._evaluateExpression(0,t,i.position))),e===E&&":"===t[i.position]&&(i=this._evaluateExpression(0,t,++i.position)),i}_checkFor(e,t,n){let i={text:"",position:t};if(n>1)try{const t=this._checkVar(e,i.position,!1);'"'===e[t.position]&&(i.position=t.position+1)}catch(e){if("Name missing"!==e.text)throw i}else{if(i=this._checkVar(e,i.position,!1),"="!==e[i.position])throw i.text="Missing equal-sign",i;i.position++}return i=this._evaluateExpression(0,e,i.position),":"!==e[i.position]||(i=this._evaluateExpression(0,e,++i.position),":"!==e[i.position]||(i=this._evaluateExpression(0,e,++i.position))),i}_checkJobKeyword(e,t){const n={text:"",position:t};if(!e.substring(n.position).match(_))throw n.text="No valid Keyword for JOB Command",n;{const t=e.substring(n.position).match(_)[0];if(n.position+=t.length,"="===t[t.length-1]){if(!e.substring(n.position).match(f))throw n.text="String literal expected",n;{const t=e.substring(n.position).match(f)[0];if(n.position+=t.length,0===t.length)throw n.text="String literal expected",n}}}return n}_checkJob(e,t){let n=this._checkEntryRef(e,t,!0);if(":"===e[n.position])if(n.position++,"("===e[n.position]){n.position++;let t=!1;do{if(n=this._checkJobKeyword(e,n.position),t=!0,")"===e[n.position]){n.position++;break}if(":"!==e[n.position])throw n.text="Unecpected Character",n;n.position++,t=!1}while(!this._isEndOfArgument(e,n.position));if(!t)throw n.text='Missing ")" or Keyword',n}else":"!==e[n.position]&&(n=this._checkJobKeyword(e,n.position));return":"===e[n.position]&&(n=this._evaluateExpression(0,e,++n.position)),n}_checkKill(e,t){let n={text:"",position:t};if("("===e[n.position]){n.position++;let t=!1;do{if(n=this._checkVar(e,n.position),t=!0,")"===e[n.position]){n.position++;break}if(","!==e[n.position])throw n.text="Unecpected Character",n;n.position++,t=!1}while(!this._isEndOfArgument(e,n.position));if(!t)throw n.text='Missing ")" or Name',n}else n=this._checkVar(e,n.position);return n}_checkLock(e,t,n){let i={text:"",position:t};if("+"!==e[i.position]&&"-"!==e[i.position]||!n||i.position++,"("===e[i.position]){i.position++;let t=!1;do{if(i=this._checkVar(e,i.position),t=!0,")"===e[i.position]){i.position++;break}if(","!==e[i.position])throw i.text="Unecpected Character",i;i.position++,t=!1}while(!this._isEndOfArgument(e,i.position));if(!t)throw i.text='Missing ")" or Name',i}else i=this._checkVar(e,i.position);return":"===e[i.position]&&(i=this._evaluateExpression(0,e,++i.position)),i}_checkMerge(e,t){let n={text:"",position:t};if(n=this._checkVar(e,n.position),"="!==e[n.position])throw n.text="Equal-Sign expected",n;return n=this._checkVar(e,++n.position),n}_checkNew(e,t){let n={text:"",position:t};if("("===e[n.position]){n.position++;let i=!1;do{if(e.substring(n.position).match(c)){const i=e.substring(n.position).match(c)[0];let o=i.toUpperCase();void 0!==w[o.substring(1)]&&(o="$"+w[o.substring(1)]),this._tokens.push({name:i,position:t+this.linePosition,type:r.sysvariable,longName:o,isExcludedVariable:!0}),n.position+=i.length}else n=this._checkVar(e,n.position,!1,!1,!0);if(i=!0,")"===e[n.position]){n.position++;break}if(","!==e[n.position])throw n.text="Unecpected Character",n;n.position++,i=!1}while(!this._isEndOfArgument(e,n.position));if(!i)throw n.text='Missing ")" or Name',n}else if(e.substring(n.position).match(c)){const i=e.substring(n.position).match(c)[0];let o=i.toUpperCase();void 0!==w[o.substring(1)]&&(o="$"+w[o.substring(1)]),this._tokens.push({name:i,position:t+this.linePosition,type:r.sysvariable,longName:o,isExcludedVariable:!1}),n.position+=i.length}else n=this._checkVar(e,n.position,!1);return n}_checkRead(e,t){let n,i={text:"",position:t},r=!1;"*"===e[i.position]&&(i.position++,r=!0);try{const t=this._checkVar(e,i.position);return i.position=t.position,"#"===e[i.position]&&(i=this._evaluateExpression(0,e,++i.position),""!==i.text)||":"===e[i.position]&&(i=this._evaluateExpression(0,e,++i.position)),i}catch(t){if(r)throw i.text="Variable expected",i;if(n=e.substring(i.position).match(f))return i.position+=n[0].length,i;if((n=e.substring(i.position).match(/^(#|!)+/))&&(i.position+=n[0].length),"?"===e[i.position])return i=this._evaluateExpression(0,e,++i.position),i}return i}_checkSet(e,t){let n,i={text:"",position:t},o=!1;if("*"===e[i.position]){if(i=this._checkVar(e,++i.position,!1),"="!==e[i.position])throw i.text="Equal-Sign expected",i;return i=this._checkVar(e,++i.position,!1),i}"("===e[i.position]&&(o=!0,i.position++);do{if("@"===e[i.position])try{const t=this._checkVar(e,i.position);if(i.position=t.position,this._isEndOfArgument(e,i.position)||","===e[i.position])return i}catch(t){if(i=this._evaluateExpression(4,e,++i.position),this._isEndOfArgument(e,i.position)||","===e[i.position])return i}else if(n=e.substring(i.position).match(/^\$Z?(PIECE|P|EXTRACT|E)\(/i)){let t=n[0].substring(1,n[0].length-1).toUpperCase();i.position+=t.length+2,void 0!==A[t]&&(this._tokens.push({name:"$"+t,position:i.position-t.length-2,type:r.ifunction,longName:"$"+A[t]}),t=A[t]),i=this._checkFunction(t,e,i.position)}else(n=e.substring(i.position).match(c))?i.position+=n[0].length:i=this._checkVar(e,i.position,!0);","===e[i.position]&&o?i.position++:")"===e[i.position]&&o&&(o=!1,i.position++)}while(!this._isEndOfArgument(e,i.position)&&o);if("="!==e[i.position])throw i.text="Equal-Sign expected",i;return i=this._evaluateExpression(0,e,++i.position),i}_checkTstart(e,t){let n={text:"",position:t};if("("===e[n.position]){if(n.position++,")"!==e[n.position]){let t=!1;do{if(t=!0,n=this._checkVar(e,n.position,!1,!1),")"===e[n.position]){n.position++;break}if(","!==e[n.position])throw n.text="Unecpected Character",n;n.position++,t=!1}while(!this._isEndOfArgument(e,n.position));if(!t)throw n.text='Missing ")" or Name',n}}else"*"===e[n.position]?n.position++:n=this._checkVar(e,n.position,!1,!1);if(":"===e[n.position])if(n.position++,"("===e[n.position]){n.position++;let t=!1;do{if(n=this._checkKeyword(x,e,n.position),t=!0,")"===e[n.position]){n.position++;break}if(":"!==e[n.position])throw n.text="Unecpected Character",n;n.position++,t=!1}while(n.position<e.length);if(!t)throw n.text='Missing ")" or Keyword',n}else n=this._checkKeyword(x,e,n.position);return n}_checkView(e,t){let n={text:"",position:t};for(n=this._evaluateExpression(0,e,n.position);":"===e[n.position];)n=this._evaluateExpression(0,e,++n.position);return n}_checkWrite(e,t){let n,i={text:"",position:t};return"*"===e[i.position]?(i=this._evaluateExpression(0,e,++i.position),i):e.substring(i.position).match(/^\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)?(i=this._checkWriteSocket(e,i.position),i):(n=e.substring(i.position).match(/^(#|!)+/))?(i.position+=n[0].length,"?"===e[i.position]&&(i=this._evaluateExpression(0,e,++i.position)),i):"?"===e[i.position]?(i=this._evaluateExpression(0,e,++i.position),i):(i=this._evaluateExpression(0,e,i.position),i)}_checkWriteSocket(e,t){let n,i={text:"",position:t};if(n=e.substring(i.position).match(/^\/(EOF|PASS|ACCEPT|LISTEN|L|TLS|WAIT|W)/i)){i.position+=n[0].length;const t=n[0].toUpperCase();if("/EOF"===t)return i;if("("!==e[i.position]){if(!t.match(/^\/(LISTEN|L|WAIT|W)/))throw i.text=t+" needs Parameter(s)",i;return i}i.position++;let r=99;"/LISTEN"===t||"/L"===t||"/WAIT"===t||"/W"===t?r=1:"/TLS"===t&&(r=4);let o=0,s=!1;do{if(o++,o>r)throw i.text="More Parameters than expected",i;if("/ACCEPT"===t&&1===o){if("."!==e[i.position])throw i.text="Local Variablereference expected (.lvn)",i;i=this._checkVar(e,++i.position,!1,!1)}else i=this._evaluateExpression(0,e,i.position);if(s=!0,","!==e[i.position]){if(")"===e[i.position]){i.position++;break}}else s=!1}while(!this._isEndOfArgument(e,i.position));if(!s)throw i.text='Missing Parameter or ")"',i}return i}_checkXecute(e,t){let n={text:"",position:t};return n=this._evaluateExpression(0,e,n.position),":"===e[n.position]&&(n=this._evaluateExpression(0,e,++n.position)),n}_checkZbreak(e,t){let n={text:"",position:t};return"-"===e[n.position]&&(n.position++,"*"===e[n.position])?(n.position++,n):(n=this._checkEntryRef(e,n.position,!1),":"===e[n.position]&&(n.position++,":"===e[n.position]?n=this._evaluateExpression(0,e,++n.position):(n=this._evaluateExpression(0,e,++n.position),":"===e[n.position]&&(n=this._evaluateExpression(0,e,++n.position)))),n)}_checkZprint(e,t){let n={text:"",position:t};return n=this._checkEntryRef(e,n.position,!1),":"===e[n.position]&&(n=this._checkEntryRef(e,++n.position,!1)),n}_checkZstep(e,t){let n,i={text:"",position:t};if(!(n=e.substring(i.position).match(/^(INTO|OUTOF|OU|OVER|OV)/i)))throw i.text="Invalid ZSTEP Qualifier",i;return i.position+=n[0].length,":"===e[i.position]&&(i=this._evaluateExpression(0,e,++i.position)),i}_checkCommand(e,t,n){const i=k[t];let r=n.pcPosition;const o=i.postcondition,s=i.parameter;let a={text:"",position:0};if(!o&&""!==n.mPostCondition)throw{text:"Poscondition not allowed",position:r};if(""!==n.mPostCondition&&(a=this._evaluateExpression(0,e,r)),r=n.argPosition,""===n.mArguments){if(""===s||"["===s[0])return{text:"",position:r};throw{text:"Argument for command "+n.mCommand+" required",position:r}}a.position=r;let c=0;do{switch(c++,t){case"BREAK":a=this._checkBreak(e,a.position);break;case"CLOSE":a=this._checkOUC(R,e,a.position);break;case"DO":a=this._checkEntryRefAndPostcondition(e,a.position,!0);break;case"ELSE":if(""!==e)throw{text:"No Argument expected",position:r};break;case"FOR":a=this._checkFor(e,a.position,c);break;case"GOTO":a=this._checkEntryRefAndPostcondition(e,a.position,!1);break;case"HANG":case"IF":case"ZCOMPILE":case"ZEDIT":case"ZHALT":case"ZRUPDATE":case"ZSYSTEM":case"ZTCOMMIT":a=this._evaluateExpression(0,e,a.position);break;case"JOB":a=this._checkJob(e,a.position);break;case"KILL":a=this._checkKill(e,a.position);break;case"LOCK":a=this._checkLock(e,a.position,!0);break;case"MERGE":a=this._checkMerge(e,a.position);break;case"NEW":a=this._checkNew(e,a.position);break;case"OPEN":a=this._checkOUC(E,e,a.position);break;case"QUIT":if(c>1)throw a.text="Quit allows only one Argument",a;a="*"===e[a.position]?this._checkVar(e,++a.position,!1):this._evaluateExpression(0,e,a.position);break;case"READ":a=this._checkRead(e,a.position);break;case"SET":a=this._checkSet(e,a.position);break;case"TROLLBACK":c>1?a.text="TROLLBACK allows only one Argument":a=this._evaluateExpression(0,e,a.position);break;case"TSTART":a=this._checkTstart(e,a.position);break;case"USE":a=this._checkOUC(T,e,a.position);break;case"VIEW":a=this._checkView(e,a.position);break;case"WRITE":a=this._checkWrite(e,a.position);break;case"XECUTE":a=this._checkXecute(e,a.position);break;case"ZALLOCATE":a=this._checkLock(e,a.position,!1);break;case"ZBREAK":a=this._checkZbreak(e,a.position);break;case"ZDEALLOCATE":case"ZKILL":case"ZWITHDRAW":a=this._checkVar(e,a.position);break;case"ZGOTO":a=this._evaluateExpression(0,e,a.position),":"===e[a.position]&&(a=this._checkEntryRefAndPostcondition(e,++a.position,!1));break;case"ZHELP":case"ZLINK":a=this._evaluateExpression(0,e,a.position),":"===e[a.position]&&(a=this._evaluateExpression(0,e,++a.position));break;case"ZMESSAGE":for(a=this._evaluateExpression(0,e,a.position);":"===e[a.position];)a=this._evaluateExpression(0,e,++a.position);break;case"ZPRINT":a=this._checkZprint(e,a.position);break;case"ZSHOW":a=this._evaluateExpression(0,e,a.position),":"===e[a.position]&&(a=this._checkVar(e,++a.position));break;case"ZSTEP":a=this._checkZstep(e,a.position);break;case"ZTRIGGER":if(a=this._checkVar(e,a.position,!0,!1),!a.globalFound)throw a.text="Global Variable expected",a;break;case"ZWRITE":a.position+=e.length;break;default:a.position=e.length}if(","!==e[a.position]){if(void 0!==e[a.position]){const t=e[a.position];if(" "===t||"\t"===t||";"===t)break;throw a.text='Unexpected Character "'+e[a.position]+'"',a}}else if(a.position++,a.position===e.length&&""!==s&&"["!==s[0])throw{text:"Argument for command "+n.mCommand+" required",position:a.position}}while(a.position<e.length);return a}_checkFunction(e,t,n){let i={text:"",position:n};const r=C[e];if(void 0===r)throw i.text="Unknown Function "+e,i;const o=void 0!==r.minparams?r.minparams:1,s=void 0!==r.format?r.format.split(","):void 0;let a=0;if(e="$"+e,0===o&&")"===t[i.position])return i.position++,i;do{let n=void 0!==s&&void 0!==s[a]?s[a]:"expr";if("$SELECT"===e&&(n="special"),"glvn"===n||"gvn"===n||"glvn("===n||"lvn"===n){if(i=this._checkVar(t,i.position),"glvn("===n&&!i.indexFound&&!i.indirectionFound)throw i.text="Variable with Index expected for "+e,i;if("lvn"===n&&i.globalFound)throw i.text="Local variable expected",i}else if("entryref"===n)i=this._checkEntryRef(t,i.position,!1);else if("expr"===n)i=this._evaluateExpression(0,t,i.position);else if("bool"===n){if("0"!==t[i.position]&&"1"!==t[i.position])throw i.text="0/1 expected",i;i.position++}else if("special"===n&&"$SELECT"===e){if(i=this._evaluateExpression(0,t,i.position),":"!==t[i.position])throw i.text="Missing Expression",i;i.position++,i=this._evaluateExpression(0,t,i.position)}a++;const c=t[i.position];if(","!==c){if(")"===c){if(a<o)throw i.text="Less Arguments for "+e+" than expected",i;i.position++;break}throw i.text="Unxepected character ",i}if(a>r.maxparams)throw i.text="More Arguments for "+e+" than expected",i;i.position++}while(!this._isEndOfArgument(t,i.position));return i}_evaluateExpression(e,t,n,i){let o=!1,a=n;void 0===i&&(i=0);let l="";for(;n<t.length;){let h=t.charAt(n);if("("===h){let r=0;switch(l){case"ifunction":r=3;break;case"exfunction":r=2;break;case"pattern":throw{text:'Unecpected "("',position:n}}const s=this._evaluateExpression(r,t,++n,i+1);if(4===e)return s;o=!0,n=s.position;continue}if(l="",")"===h){if(!o){if(n===a&&2===e)return{text:"",position:++n};throw{text:"Incomplete Expression",position:n}}return i>0&&n++,{text:"",position:n}}if("."===h&&2===e){n++;const e=t.substring(n);if(e.match(s)){const i=e.match(s)[0];if(this._tokens.push({type:r.local,name:i,position:n+this.linePosition}),n+=i.length,h=t.charAt(n),","!==h&&")"!==h)throw{text:"Variablereference must stand alone",position:n};o=!0;continue}}if(","===h){if(!o){if(n===a&&2===e){if(0===i)return{text:"",position:++n};o=!1,a=++n;continue}throw{text:"Incomplete Expression",position:n}}if(0===e||4===e)return{text:"",position:n};o=!1,a=++n;continue}if(o){if(4===e)return{text:"",position:n};if(t.substring(n).match(g)){const e=t.substring(n).match(g)[0];this._tokens.push({name:e,position:n+this.linePosition,type:r.operator}),n+=e.length,o=!1,("?"===e||"'?"===e)&&(n=this._evaluatePattern(t,n).position,o=!0,l="pattern");continue}return{text:"",position:n}}const m=t.substring(n);try{const e=this._checkVar(t,n);o=!0,n=e.position}catch(e){if("$$"===m.substring(0,2))n+=2,o=!0,n=(e=this._checkEntryRef(t,n,!0,!0)).position,o=!0;else if(m.match(p)){const e=m.match(p)[0];this._tokens.push({type:r.nonMfunction,name:e,position:n}),n+=e.length,l="exfunction",o=!0}else if(m.match(u)){const e=m.match(u)[0].substring(1).toUpperCase();n+=e.length+2;let i=e;void 0!==A[e]&&(i=A[e]),this._tokens.push({name:"$"+e,position:n-e.length-2,type:r.ifunction,longName:"$"+i}),n=this._checkFunction(i,t,n).position,l="",o=!0}else if(m.match(c)){const e=m.match(c)[0];let t=e.toUpperCase();void 0!==w[t.substring(1)]&&(t="$"+w[t.substring(1)]),this._tokens.push({name:e,position:n+this.linePosition,type:r.sysvariable,longName:t}),n+=e.length,o=!0}else if(m.match(d)&&""!==m.match(d)[0]){const e=m.match(d)[0];this._tokens.push({name:e,type:r.number,position:n+this.linePosition}),n+=e.length,o=!0}else if(m.match(f)){const e=m.match(f)[0];this._tokens.push({name:e,type:r.string,position:n+this.linePosition}),n+=e.length,o=!0}else{if(!h.match(b))throw{text:"Unexpected Character "+h,position:n};this._tokens.push({name:h,type:r.operator,position:n+this.linePosition}),n++}}}if(o){if(i>0)throw{text:'Missing ")"',position:n};return{text:"",position:n}}throw{text:"Incomplete Expression",position:n}}_evaluatePattern(e,t,n){let i={text:"",position:t},r=!1;void 0===n&&(n=0);do{if("@"===e[t]){i=this._evaluateExpression(0,e,++t),r=!0;break}if(!e.substring(i.position).match(y)){if(")"===e[i.position]){if(!r)throw i.text="Incomplete pattern",i;return i.position++,i}if(","===e[i.position]&&n>0){if(!r)throw i.text="Incomplete pattern",i;i.position++;continue}break}{const t=e.substring(i.position).match(y)[0];if(""===t){if(")"===e[i.position]){if(!r)throw i.text="Incomplete pattern",i;return n>0&&i.position++,i}if(","===e[i.position]&&n>0){i.position++;continue}break}if(r=!1,i.position+=t.length,e.substring(i.position).match(v)){r=!0,i.position+=e.substring(i.position).match(v)[0].length;continue}if("("===e[i.position]){i=this._evaluatePattern(e,++i.position,n+1),r=!0;continue}}}while(t<e.length);if(!r)throw i.text="Incomplete pattern",i;if(n>0)throw i.text='Missing ")"',i;return i}_extractCommands(e){let t;const n=[],i=this._splitCommandsAndArguments(e);let r=0;for(t={mCommand:"",mPostCondition:"",mArguments:"",cmdPosition:0,argPosition:0,pcPosition:0};r<i.length;){if(r%2==0)t.mCommand=i[r].command,t.cmdPosition=i[r].position;else{t.mArguments=i[r].command,t.argPosition=i[r].position;const e=r+1;for(;e<i.length&&""===i[e].command;)i.splice(e,1);n.push(t),t={mCommand:"",mPostCondition:"",mArguments:"",cmdPosition:0,argPosition:0,pcPosition:0}}r++}i.length%2!=0&&(t.mCommand=i[i.length-1].command,t.cmdPosition=i[i.length-1].position,t.mArguments="",t.argPosition=e.lineExpression.length,n.push(t));const o=this._extractPostConditional(n);return o.length>0&&(e.lineRoutines=o),e}_extractComment(e){const t=e.lineExpression;if(t.search(";")>=0){let n=!1;for(let i=0;i<t.length;i++){if(";"===t[i]&&!n)return e.lineExpression=t.substring(0,i),e.lineComment={comment:t.substring(i).substring(1),position:i+e.expressionPosition},e;'"'===t[i]&&(n=!n)}}return e}_extractIndentation(e){const t=[];let n=0;const i=e.lineExpression;let r="",o=0;for(o=0;o<=i.length;o++){const e=i[o];if("."!==e){if(" "!==e&&"\t"!==e)break;r+=e}else n>0&&t.push(r),n++,r=""}return n>0&&(t.push(r),e.lineExpression=i.substring(o),e.expressionPosition+=o,e.lineIndentationArray=t),e}_extractLabel(e){e.lineLabel="";const t=e.lineExpression;e.lineExpression="",t.match(o)&&(e.lineLabel=t.match(o)[0]);const n=e.lineLabel.length;if(n===t.length)return e;if(!t.charAt(n).match(/[\s|;]/))return e.errorText="Unexpected Character"+t.charAt(n),e.errorPosition=n,e;let i=0;for(i=n;i<=t.length&&(" "===t[i]||"\t"===t[i]);i++);return e.lineLeadSpace=t.substring(n,i),i!==t.length&&(e.lineExpression=t.substring(i),e.expressionPosition=i),e}_extractPostConditional(e){const t=e;for(let e=0;e<t.length;e++){const n=t[e].mCommand.indexOf(":");n>-1&&(t[e].mPostCondition=t[e].mCommand.substring(n+1),t[e].mCommand=t[e].mCommand.substring(0,n),t[e].pcPosition=t[e].cmdPosition+n+1)}return t}_isEndOfArgument(e,t){let n=!1;const i=e[t];return void 0!==i&&" "!==i&&"\t"!==i&&";"!==i||(n=!0),n}_parseLine(e){let t={lineExpression:e,expressionPosition:0};return t=this._extractLabel(t),t.errorText||(t=this._extractComment(t),t=this._extractIndentation(t),t=this._extractCommands(t),t.lineExpression=""),t}_splitCommandsAndArguments(e){const t=[];let n=0,i=!1;const r=e.lineExpression,o=e.expressionPosition;for(let e=0;e<r.length;e++)'"'===r[e]&&(i=!i)," "!==r[e]&&"\t"!==r[e]||i||(r.substring(n,e).length>0?t.push({command:r.substring(n,e),position:o+n}):0!==r.substring(n,e).length||" "!==r.substring(n-1,n)&&"\t"!==r.substring(n-1,n)||t.push({command:r.substring(n,e),position:o+n}),n=e+1);const s=r.length;return r.substring(n,s).length>0?t.push({command:r.substring(n,s),position:o+n}):s!==n||" "!==r.substring(s-1,s)&&"/t"!==r.substring(s-1,s)||t.push({command:"",position:o+n}),t}_splitLabelAndParameters(e){if(-1===e.indexOf("("))this._tokens.push({name:e,position:0,type:r.label});else{const t=e.split("("),n=t[0];this._tokens.push({name:n,position:0,type:r.label});const i=t[1].split(")")[0].split(",");let o=n.length+1;for(let e=0;e<i.length;e++)this._tokens.push({name:i[e],position:o,type:r.local}),o+=i[e].length+1}}}},7598:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1398),r=n(889),o=n(9896),s=new r.MumpsLineParser;t.default=class{provideReferences(e,t){const n=s.getTokenAt(e.lineAt(t).text,t.character),o=[];if(void 0!==n){let t=n.type;const a=null==n?void 0:n.name;if(t===r.TokenType.label){let n=e.fileName.replace(/\\/g,"/").split("/").pop();n=null==n?void 0:n.split(".")[0].replace("_","%"),t=r.TokenType.entryref;const c=a+"^"+n,u=e.getText().split("\n");for(let t=0;t<u.length;t++)if(u[t].includes(c)||u[t].includes(a)){let n=-1;for(;;){const p=u[t].indexOf(c,n+1);if(-1===p){if(n=u[t].indexOf(a,n+1),-1===n)break}else n=p;const l=s.getTokenAt(u[t],n+1);void 0===l||l.name!==c&&l.name!==a||l.type!==r.TokenType.entryref&&l.type!==r.TokenType.exfunction||o.push(new i.Location(e.uri,new i.Range(t,n,t,n+l.name.length)))}}return this.getallLabelReferences(o,c,t)}return t===r.TokenType.local||t===r.TokenType.global?this.getallLabelReferences(o,a,t):Promise.resolve(o)}return Promise.resolve(o)}getallLabelReferences(e,t,n){return new Promise((a=>{i.workspace.findFiles("*.m").then((c=>{const u=c.length;for(let p=0;p<u;p++){const l=c[p].fsPath;o.readFile(l,"utf8",((o,c)=>{if(!o&&c.includes(t)){const o=c.split("\n");for(let a=0;a<o.length;a++)if(o[a].includes(t)){const c=o[a].indexOf(t),u=s.getTokenAt(o[a],c+1);void 0!==u&&u.name===t&&(u.type===n||u.type===r.TokenType.exfunction&&n===r.TokenType.entryref)&&e.push(new i.Location(i.Uri.file(l),new i.Range(a,c,a,c+u.name.length)))}}p===u-1&&a(e)}))}}))}))}}},7494:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4491);t.default=class{provideSignatureHelp(e,t){return new i.MumpsTokenHelper(e,t).getTokenSignature()}}},4491:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MumpsTokenHelper=void 0;const i=n(1398),r=n(889),o=new r.MumpsLineParser,s=n(419),a={},c=n(9896),u=n(6928),p=i.Uri,l=[".m",".int",".zwr",".M",".INT",".ZWR"],h={fsPath:"",text:""};function d(e,t){a[e]?a[e].push(t):a[e]=[t]}if(0===Object.keys(a).length)for(const e of s.definitionsArray)d(e.name,e),e.abbreviation&&d(e.abbreviation,e);t.MumpsTokenHelper=class{constructor(e,t){this._document=e,this._position=t}_getText(e){if(e===this._document.uri)return this._document.getText();if(e.fsPath===h.fsPath)return h.text;try{return h.text=c.readFileSync(e.fsPath,"utf8"),h.fsPath=e.fsPath,h.text}catch(e){return""}}getTokenSignature(){const e=this._document.lineAt(this._position);if(!e)return;const t=e.text,n=this._getFunctionToken(t);if(void 0===n||n.type!==r.TokenType.ifunction&&n.type!==r.TokenType.exfunction)return;const o=this.getTokenData(n.name,n.type);if(!o)return;const s=new i.SignatureHelp;return s.signatures=[this.convertDefinition(o)],s.activeSignature=0,s.activeParameter=this._calculateActiveParameter(e.text,n.position+n.name.length,this._position.character),s}getTokenHoverInfo(){const e=o.getTokenAt(this._document.lineAt(this._position).text,this._position.character);if(void 0!==e&&(e.type===r.TokenType.exfunction||e.type===r.TokenType.ifunction||e.type===r.TokenType.entryref||e.type===r.TokenType.keyword)){const t=this.getTokenData(e.name,e.type);if(!t)return;if(t.parameters){t.name+="(";for(let e=0;e<t.parameters.length;e++)0!==e&&(t.name+=","),t.name+=t.parameters[e].name;t.name+=")"}const n={language:"mumps",value:t.name};return new i.Hover([n,t.commentText||t.description])}}_calculateActiveParameter(e,t,n){let i=0,r=0,o=!1;for(let s=t+1;s<n;s++){const t=e.charAt(s);"("!==t||o?")"!==t||o?'"'===t?o=!o:","!==t||0!==r||o||i++:r--:r++}return i}getTokenRefLocation(){const e=o.getTokenAt(this._document.lineAt(this._position).text,this._position.character);if(void 0!==e&&(e.type===r.TokenType.entryref||e.type===r.TokenType.exfunction)){const t=this.getTokenData(e.name,e.type);if(t)return t.location}}getTokenData(e,t){if(t===r.TokenType.ifunction||t===r.TokenType.keyword){const t=a[e.toUpperCase()];if(!t)return;for(const e of t)if("function"===e.type||"command"===e.type)return Object.assign({},e)}else{if(t!==r.TokenType.exfunction&&t!==r.TokenType.entryref)return;{const t=this.getPositionForLabel(e);if(t)return this._extractDefinition(t)}}}convertDefinition(e){const t={name:"",description:"",parameters:[]};if(t.description=e.description,e.parameters){t.name=e.name+"(";for(let n=0;n<e.parameters.length;n++){const r=e.parameters[n];let o=r.optional?"(optional) ":"";o+=r.description||r.name,t.parameters.push(new i.ParameterInformation(r.name,o)),r.optional&&(t.name+="["),t.name+=0===n?"":",",t.name+=r.name+":"+r.type,r.optional&&(t.name+="]")}t.name+=")",e.returns&&(t.name+=":"+e.returns)}const n=new i.SignatureInformation(t.name,t.description);return n.parameters=t.parameters,n}getPositionForLabel(e){let t=this._document.uri,n=e.split("^")[0],r=0,o="";if(void 0!==n.split("+")[1]&&(r=parseInt(e.split("+")[1]),n=n.split("+")[0]),-1!==e.indexOf("^")){let n=e.split("^")[1];"%"===n.charAt(0)&&(n="_"+n.substring(1));let i=u.resolve(this._document.uri.fsPath,"../"+n);for(const e of l){const t=i+e;if(c.existsSync(t)){i=t;break}}t=p.file(i)}const s=this._getText(t).split("\n");let a="",h=0;const d=n.length;for(h=0;h<s.length;h++)if(s[h].substr(0,d)===n&&null!==s[h].substr(d,1).match(/(;|\s|\()/)){o=s[h],a+=s[h]+"\n";for(let e=h-1;e>0&&(0===s[e].length||s[e].match(/^\s*;/));e--)a+=s[e]+"\n";break}if(a.length>0)return a=a.split("\n").reverse().join("\n"),{commentText:a,location:new i.Location(t,new i.Position(h+r,0)),labelLine:o}}_extractDefinition(e){const t={name:"",type:"function",commentText:"",description:"",returns:{type:""},location:e.location},n=e.commentText;t.commentText=n;const i=/^([%A-Z][A-Z0-9]*)(\((,?[%A-Z][A-Z0-9]*)+\))?/i.exec(e.labelLine);if(!i)return;t.name=i[1],n.indexOf(";")&&(t.commentText=n.substring(n.indexOf(";")+1));let r=[];const o={};if(void 0!==i[2]){r=i[2].substring(1,i[2].length-1).split(","),t.parameters=[];for(let e=0;e<r.length;e++)t.parameters.push({name:r[e],type:"any"}),o[r[e]]=t.parameters.length-1}if(""!==n){const e=n.match(/DESCRIPTION:.*/i);null!==e&&(t.description=e[0]);for(const e in o){const i=n.match(new RegExp("\\s"+e+"(\\(.*\\))?:.*","i"));null!==i&&(t.parameters[o[e]].description=i[0])}}return t}_getFunctionToken(e){let t,n=1;for(t=this._position.character-1;t>0&&n>0;t--){const i=e.charAt(t);")"===i?n++:"("===i&&n--}if(!(n>0||t<=0))return o.getTokenAt(e,t)}}},1398:e=>{"use strict";e.exports=require("vscode")},5317:e=>{"use strict";e.exports=require("child_process")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2018:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.c=t,n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var i=n(n.s=4265);module.exports=i})();
//# sourceMappingURL=extension.js.map